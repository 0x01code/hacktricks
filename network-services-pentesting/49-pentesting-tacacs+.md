# 49 - Pentesting TACACS+

<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) no github.

</details>

## Informa√ß√µes B√°sicas

**Terminal Access Controller Access Control System (TACACS)** √© um protocolo de seguran√ßa que fornece valida√ß√£o centralizada de usu√°rios que est√£o tentando obter **acesso a um roteador ou NAS**. TACACS+, uma vers√£o mais recente do protocolo TACACS original, fornece servi√ßos separados de autentica√ß√£o, autoriza√ß√£o e contabilidade (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Porta padr√£o:** 49

## Intercepta√ß√£o da Chave de Autentica√ß√£o

Se um atacante conseguir se posicionar entre o cliente e o servidor TACACS, **ele pode interceptar a chave de autentica√ß√£o** em forma criptografada e, em seguida, realizar um bruteforce local contra ela. Assim, voc√™ realiza o bruteforce da chave e n√£o aparece nos logs. E se voc√™ conseguir realizar o bruteforce da chave, **ter√° acesso ao equipamento de rede e poder√° descriptografar o tr√°fego** no **Wireshark**.

### MitM

Para realizar um ataque MitM, voc√™ pode usar um [**ataque de ARP spoofing**](../generic-methodologies-and-resources/pentesting-network/#arp-spoofing).

### Brute-force da Chave

Agora voc√™ precisa executar o [Loki](https://c0decafe.de/svn/codename_loki/trunk/). Esta √© uma ferramenta especial projetada para analisar a seguran√ßa dos protocolos L2/L3. Suas capacidades s√£o t√£o boas quanto as do popular **Yersinia** e √© um s√©rio concorrente dele. O Loki tamb√©m pode realizar bruteforce em chaves TACACS. Se a chave for **bruteforced com sucesso** (**geralmente em formato criptografado MD5)**, **poderemos acessar o equipamento e descriptografar o tr√°fego criptografado pelo TACACS.**
```
sudo loki_gtk.py
```
```markdown
Voc√™ tamb√©m precisa especificar o caminho para o dicion√°rio para fazer bruteforce na chave criptografada. Certifique-se de desmarcar a op√ß√£o **Use Bruteforce**, caso contr√°rio, o Loki far√° bruteforce na senha sem usar o dicion√°rio.

Agora temos que esperar que um administrador fa√ßa login no dispositivo atrav√©s do servidor TACACS. Presume-se que o administrador da rede j√° tenha feito login, e n√≥s, **interceptando o tr√°fego via ARP spoofing**, interceptamos o tr√°fego. E ao fazer isso, os hosts leg√≠timos n√£o percebem que algu√©m interferiu em sua conex√£o.

Agora clique no bot√£o **CRACK** e espere o **Loki** quebrar a senha.

### Descriptografar Tr√°fego

√ìtimo, conseguimos desbloquear a chave, agora precisamos descriptografar o tr√°fego TACACS. Como eu disse, o Wireshark pode lidar com tr√°fego TACACS criptografado se a chave estiver presente.

Vemos qual banner foi usado.

Encontramos o nome de usu√°rio do usu√°rio `admin`

Como resultado, **temos as credenciais `admin:secret1234`,** que podem ser usadas para acessar o pr√≥prio hardware. **Acho que vou verificar a validade delas.**

√â assim que voc√™ pode atacar TACACS+ e **ganhar acesso** ao painel de controle do equipamento de rede.

## Refer√™ncias

* A se√ß√£o de intercepta√ß√£o de chave foi copiada de [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<details>

<summary><strong>Aprenda AWS hacking do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quiser ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**merchandising oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga**-me no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas dicas de hacking enviando PRs para os reposit√≥rios github do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
```
