# 49 - TACACS+のペンテスト

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* **サイバーセキュリティ企業**で働いていますか？ **HackTricksで会社を宣伝**したいですか？または、**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけてください。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。
* [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter**で**フォロー**してください[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**。**
* **ハッキングのトリックを共有するには、PRを** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **と** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **に提出してください。**

</details>

## 基本情報

**Terminal Access Controller Access Control System (TACACS)**は、**ルーターやNASにアクセスしようとするユーザーの集中的な認証**を提供するセキュリティプロトコルです。TACACSのより新しいバージョンであるTACACS+は、認証、認可、およびアカウンティング（AAA）のサービスを分離して提供します。
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**デフォルトポート:** 49

## 認証キーの傍受

攻撃者がクライアントとTACACSサーバーの間に入ることに成功した場合、**彼は暗号化された認証キーを傍受**し、それをローカルでブルートフォース攻撃することができます。したがって、キーをブルートフォース攻撃することができ、ログには表示されません。そして、キーをブルートフォース攻撃することに成功した場合、**ネットワーク機器にアクセスし、Wiresharkでトラフィックを復号化**することができます。

### MitM

MitM攻撃を実行するためには、[**ARPスプーフィング攻撃**](../generic-methodologies-and-resources/pentesting-network/#arp-spoofing)を使用することができます。

### ブルートフォース攻撃

今、[Loki](https://c0decafe.de/svn/codename\_loki/trunk/)を実行する必要があります。これはL2/L3プロトコルのセキュリティを分析するために特別に設計されたツールです。その機能は人気のある**Yersinia**と同等であり、真剣な競争相手です。Lokiはまた、TACACSキーをブルートフォース攻撃することもできます。キーが**通常はMD5で暗号化された形式で**成功した場合、**機器にアクセスし、TACACSで暗号化されたトラフィックを復号化**することができます。
```
sudo loki_gtk.py
```
<figure><img src="../.gitbook/assets/image (31) (2).png" alt=""><figcaption></figcaption></figure>

暗号化されたキーをブルートフォース攻撃するために、辞書へのパスを指定する必要があります。**ブルートフォースを使用する**オプションのチェックを外すことを忘れないでください。そうしないと、Lokiは辞書を使用せずにパスワードをブルートフォース攻撃します。

<figure><img src="../.gitbook/assets/image (11) (2).png" alt=""><figcaption></figcaption></figure>

今、管理者がTACACSサーバーを介してデバイスにログインするのを待つ必要があります。ネットワーク管理者がすでにログインしていると仮定し、私たちは**ARPスプーフィングを介して中間に立って**トラフィックを傍受します。そして、合法的なホストは自分たちの接続に他の誰かが干渉したことに気づきません。

<figure><img src="../.gitbook/assets/image (8) (2) (3).png" alt=""><figcaption></figcaption></figure>

今、**CRACK**ボタンをクリックして、**Loki**がパスワードを解読するのを待ちます。

<figure><img src="../.gitbook/assets/image (17) (2).png" alt=""><figcaption></figcaption></figure>

### トラフィックの解読

素晴らしい、キーを解除することに成功しました。これで、キーが存在する場合、Wiresharkは暗号化されたTACACSトラフィックを処理できます。

<figure><img src="../.gitbook/assets/image (28) (1).png" alt=""><figcaption></figcaption></figure>

使用されたバナーがわかります。

<figure><img src="../.gitbook/assets/image (24) (1) (2).png" alt=""><figcaption></figcaption></figure>

ユーザー`admin`のユーザー名を見つけます。

<figure><img src="../.gitbook/assets/image (7) (1) (1).png" alt=""><figcaption></figcaption></figure>

結果として、**`admin:secret1234`の資格情報**を取得しました。これはハードウェア自体にアクセスするために使用できます。**有効性を確認してみましょう。**

<figure><img src="../.gitbook/assets/image (19) (2).png" alt=""><figcaption></figcaption></figure>

これがTACACS+を攻撃し、ネットワーク機器の制御パネルに**アクセスする方法**です。

## 参考文献

* インターセプトキーのセクションは、[https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)からコピーされました。

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* **サイバーセキュリティ企業**で働いていますか？ HackTricksであなたの会社を宣伝したいですか？または、**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見しましょう。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。
* [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**Telegramグループ**](https://t.me/peass)に参加するか、**Twitter** [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**をフォローしてください。**
* **ハッキングのトリックを共有するには、**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **および** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **にPRを提出してください。**

</details>
