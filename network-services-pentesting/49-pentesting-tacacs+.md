# 49 - Ελεγχος ασφαλείας TACACS+

<details>

<summary><strong>Μάθετε το χάκινγκ στο AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

## Βασικές Πληροφορίες

Το πρωτόκολλο **Terminal Access Controller Access Control System (TACACS)** χρησιμοποιείται για την κεντρική επαλήθευση των χρηστών που προσπαθούν να αποκτήσουν πρόσβαση σε δρομολογητές ή διακομιστές πρόσβασης στο δίκτυο (NAS). Η αναβαθμισμένη έκδοσή του, **TACACS+**, διαχωρίζει τις υπηρεσίες σε επαλήθευση, εξουσιοδότηση και καταγραφή (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Προεπιλεγμένη θύρα:** 49

## Παρεμβολή του Κλειδιού Πιστοποίησης

Εάν η επικοινωνία μεταξύ του πελάτη και του διακομιστή TACACS παρεμβληθεί από έναν επιτιθέμενο, το **κρυπτογραφημένο κλειδί πιστοποίησης μπορεί να παρακολουθηθεί**. Ο επιτιθέμενος μπορεί στη συνέχεια να προσπαθήσει μια **τοπική επίθεση με βίαιη δοκιμή κατά του κλειδιού χωρίς να ανιχνεύεται στα αρχεία καταγραφής**. Εάν επιτύχει στη βίαιη δοκιμή του κλειδιού, ο επιτιθέμενος αποκτά πρόσβαση στον εξοπλισμό δικτύου και μπορεί να αποκρυπτογραφήσει την κίνηση χρησιμοποιώντας εργαλεία όπως το Wireshark.

### Εκτέλεση επίθεσης MitM

Μια επίθεση ARP spoofing μπορεί να χρησιμοποιηθεί για να εκτελεστεί μια επίθεση Man-in-the-Middle (MitM).

### Βίαιη δοκιμή του Κλειδιού

Το [Loki](https://c0decafe.de/svn/codename\_loki/trunk/) μπορεί να χρησιμοποιηθεί για τη βίαιη δοκιμή του κλειδιού:
```
sudo loki_gtk.py
```
Εάν το κλειδί **αποκρυπτογραφηθεί με επιτυχία** (**συνήθως σε κρυπτογραφημένη μορφή MD5)**, **μπορούμε να έχουμε πρόσβαση στον εξοπλισμό και να αποκρυπτογραφήσουμε την κίνηση που έχει κρυπτογραφηθεί με TACACS**.

### Αποκρυπτογράφηση της Κίνησης
Μόλις το κλειδί αποκρυπτογραφηθεί με επιτυχία, το επόμενο βήμα είναι να **αποκρυπτογραφήσουμε την κίνηση που έχει κρυπτογραφηθεί με TACACS**. Το Wireshark μπορεί να χειριστεί την αποκρυπτογραφημένη κίνηση TACACS αν παρέχεται το κλειδί. Αναλύοντας την αποκρυπτογραφημένη κίνηση, μπορούμε να αντλήσουμε πληροφορίες όπως το **μπάνερ που χρησιμοποιείται και το όνομα χρήστη του διαχειριστή**.

Αποκτώντας πρόσβαση στον πίνακα ελέγχου του δικτυακού εξοπλισμού χρησιμοποιώντας τα αποκτηθέντα διαπιστευτήρια, ο επιτιθέμενος μπορεί να ασκήσει έλεγχο στο δίκτυο. Είναι σημαντικό να σημειωθεί ότι αυτές οι ενέργειες πραγματοποιούνται αυστηρά για εκπαιδευτικούς σκοπούς και δεν πρέπει να χρησιμοποιούνται χωρίς την κατάλληλη εξουσιοδότηση.

## Αναφορές

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)


<details>

<summary><strong>Μάθετε το hacking στο AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Συμμετάσχετε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα κόλπα σας στο hacking υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
