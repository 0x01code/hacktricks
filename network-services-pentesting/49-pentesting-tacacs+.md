# 49 - TACACS+ Pentesting

<details>

<summary><strong>htARTE (HackTricks AWS Red Team 전문가)</strong>를 통해 제로부터 영웅이 될 때까지 AWS 해킹을 배우세요!</summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하고 싶다면 [**구독 요금제**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스왜그**](https://peass.creator-spring.com)를 구매하세요
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요, 당사의 독점 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **가입**하거나 **트위터** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)를 **팔로우**하세요.
* **HackTricks** 및 **HackTricks Cloud** github 저장소에 PR을 제출하여 **해킹 트릭을 공유**하세요.

</details>

**Try Hard Security Group**

<figure><img src="../.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

***

## 기본 정보

**Terminal Access Controller Access Control System (TACACS)** 프로토콜은 라우터나 네트워크 액세스 서버(NAS)에 액세스하려는 사용자를 중앙에서 인증하는 데 사용됩니다. **TACACS+**는 인증, 권한 부여 및 회계(AAA) 서비스를 분리하는 업그레이드된 버전입니다.
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**기본 포트:** 49

## 인증 키 가로채기

클라이언트와 TACACS 서버 간 통신이 공격자에의해 가로채지면 **암호화된 인증 키가 가로채질 수 있습니다**. 공격자는 그런 다음 **로그에 감지되지 않고 키에 대한 로컬 브루트 포스 공격을 시도**할 수 있습니다. 키를 성공적으로 브루트 포스하는 경우, 공격자는 네트워크 장비에 액세스하고 Wireshark와 같은 도구를 사용하여 트래픽을 해독할 수 있습니다.

### MitM 공격 수행

**ARP 스푸핑 공격을 사용하여 중간자 공격을 수행**할 수 있습니다.

### 키 브루트 포스

[Loki](https://c0decafe.de/svn/codename\_loki/trunk/)를 사용하여 키를 브루트 포스할 수 있습니다:
```
sudo loki_gtk.py
```
만약 키가 성공적으로 **무차별 대입 공격** (**일반적으로 MD5로 암호화된 형식으로**), **장비에 액세스하고 TACACS로 암호화된 트래픽을 해독할 수 있습니다.**

### 트래픽 해독
키가 성공적으로 크랙되면, 다음 단계는 **TACACS로 암호화된 트래픽을 해독하는 것**입니다. Wireshark는 키가 제공된 경우 암호화된 TACACS 트래픽을 처리할 수 있습니다. 해독된 트래픽을 분석하여 **사용된 배너와 관리자의 사용자 이름**과 같은 정보를 얻을 수 있습니다.

얻은 자격 증명을 사용하여 네트워크 장비의 제어판에 액세스하면, 공격자는 네트워크를 통제할 수 있습니다. 이러한 조치는 엄격히 교육 목적으로만 사용되어야 하며 적절한 승인 없이 사용해서는 안 됩니다.

## 참고 자료

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

**Try Hard Security Group**

<figure><img src="../.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 제로부터 영웅이 될 때까지 AWS 해킹을 배우세요!</summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 PDF로 다운로드하려면** [**구독 요금제**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스왜그**](https://peass.creator-spring.com)를 구입하세요
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요, 당사의 독점 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션
* **💬 [**디스코드 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 가입하거나**트위터** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**를 팔로우하세요.**
* **HackTricks** 및 **HackTricks Cloud** 깃허브 저장소에 PR을 제출하여 해킹 트릭을 공유하세요.

</details>
