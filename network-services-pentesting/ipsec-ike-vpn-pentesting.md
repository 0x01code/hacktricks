# 500/udp - –í–µ–Ω—Ç–µ—Å—Ç—ñ–Ω–≥ IPsec/IKE VPN

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub**.

</details>

**–ì—Ä—É–ø–∞ –∑ –±–µ–∑–ø–µ–∫–∏ Try Hard**

<figure><img src="/.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

***

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

**IPsec** —à–∏—Ä–æ–∫–æ –≤–∏–∑–Ω–∞–Ω–∏–π —è–∫ –æ—Å–Ω–æ–≤–Ω–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—è –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –∑–≤'—è–∑–∫—ñ–≤ –º—ñ–∂ –º–µ—Ä–µ–∂–∞–º–∏ (LAN-to-LAN) —Ç–∞ –≤—ñ–¥ –≤—ñ–¥–¥–∞–ª–µ–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –¥–æ –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ —à–ª—é–∑—É (–≤—ñ–¥–¥–∞–ª–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø), —â–æ —Å–ª—É–∂–∏—Ç—å –æ—Å–Ω–æ–≤–æ—é –¥–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∏—Ö —Ä—ñ—à–µ–Ω—å —â–æ–¥–æ VPN.

–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è **–∞—Å–æ—Ü—ñ–∞—Ü—ñ—ó –∑ –±–µ–∑–ø–µ–∫–æ—é (SA)** –º—ñ–∂ –¥–≤–æ–º–∞ —Ç–æ—á–∫–∞–º–∏ –∫–µ—Ä—É—î—Ç—å—Å—è **IKE**, —è–∫–∏–π –ø—Ä–∞—Ü—é—î –≤ —Ä–∞–º–∫–∞—Ö ISAKMP, –ø—Ä–æ—Ç–æ–∫–æ–ª—É, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–æ–≥–æ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ –æ–±–º—ñ–Ω—É –∫–ª—é—á–∞–º–∏. –¶–µ–π –ø—Ä–æ—Ü–µ—Å —Ä–æ–∑–≥–æ—Ä—Ç–∞—î—Ç—å—Å—è —É –∫—ñ–ª—å–∫–∞ —Ñ–∞–∑:

- **–§–∞–∑–∞ 1:** –ú—ñ–∂ –¥–≤–æ–º–∞ –∫—ñ–Ω—Ü–µ–≤–∏–º–∏ —Ç–æ—á–∫–∞–º–∏ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –±–µ–∑–ø–µ—á–Ω–∏–π –∫–∞–Ω–∞–ª. –¶–µ –¥–æ—Å—è–≥–∞—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ü–æ–ø–µ—Ä–µ–¥–Ω—å–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ–≥–æ –∫–ª—é—á–∞ (PSK) –∞–±–æ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—ñ–≤, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∞–±–æ –≥–æ–ª–æ–≤–Ω–∏–π —Ä–µ–∂–∏–º, —è–∫–∏–π –≤–∫–ª—é—á–∞—î —Ç—Ä–∏ –ø–∞—Ä–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å, –∞–±–æ **–∞–≥—Ä–µ—Å–∏–≤–Ω–∏–π —Ä–µ–∂–∏–º**.
- **–§–∞–∑–∞ 1.5:** –•–æ—á–∞ —Ü—è —Ñ–∞–∑–∞, –≤—ñ–¥–æ–º–∞ —è–∫ –†–æ–∑—à–∏—Ä–µ–Ω–∞ —Ñ–∞–∑–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, –Ω–µ —î –æ–±–æ–≤'—è–∑–∫–æ–≤–æ—é, –≤–æ–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—î —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–∏–π –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è, –≤–∏–º–∞–≥–∞—é—á–∏ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –ø–∞—Ä–æ–ª—å.
- **–§–∞–∑–∞ 2:** –¶—è —Ñ–∞–∑–∞ –ø—Ä–∏—Å–≤—è—á–µ–Ω–∞ —É–∑–≥–æ–¥–∂–µ–Ω–Ω—é –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –¥–∞–Ω–∏—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **ESP** —Ç–∞ **AH**. –í–æ–Ω–∞ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∏, –≤—ñ–¥–º—ñ–Ω–Ω—ñ –≤—ñ–¥ —Ç–∏—Ö, —â–æ –≤ –§–∞–∑—ñ 1, –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è **–ü–µ—Ä–µ–¥–∞—á—ñ –∫–ª—é—á—ñ–≤ –∑ –ø–µ—Ä—Ñ–µ–∫—Ç–Ω–æ—é —Ç–∞—î–º–Ω–∏—Ü–µ—é –≤–ø–µ—Ä–µ–¥ (PFS)**, –ø—ñ–¥–≤–∏—â—É—é—á–∏ –±–µ–∑–ø–µ–∫—É.


**–ü–æ—Ä—Ç –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º:** 500/udp

## **–í–∏—è–≤–ª–µ–Ω–Ω—è** —Å–µ—Ä–≤—ñ—Å—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é nmap
```
root@bt:~# nmap -sU -p 500 172.16.21.200
Starting Nmap 5.51 (http://nmap.org) at 2011-11-26 10:56 IST
Nmap scan report for 172.16.21.200
Host is up (0.00036s latency).
PORT    STATE SERVICE
500/udp open  isakmp
MAC Address: 00:1B:D5:54:4D:E4 (Cisco Systems)
```
## **–ó–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –¥—ñ–π—Å–Ω–æ–≥–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è**

–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é IPSec –º–æ–∂–Ω–∞ –ø—ñ–¥–≥–æ—Ç—É–≤–∞—Ç–∏ –ª–∏—à–µ –¥–ª—è –ø—Ä–∏–π–Ω—è—Ç—Ç—è –æ–¥–Ω–æ–≥–æ –∞–±–æ –∫—ñ–ª—å–∫–æ—Ö –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω—å. –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è - —Ü–µ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—è –∑–Ω–∞—á–µ–Ω—å. **–ö–æ–∂–Ω–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è** –º—ñ—Å—Ç–∏—Ç—å –∫—ñ–ª—å–∫–∞ –∞—Ç—Ä–∏–±—É—Ç—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ DES –∞–±–æ 3DES —è–∫ **–∞–ª–≥–æ—Ä–∏—Ç–º —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è**, SHA –∞–±–æ MD5 —è–∫ **–∞–ª–≥–æ—Ä–∏—Ç–º —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ**, –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π –∫–ª—é—á —è–∫ **—Ç–∏–ø –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó**, –î—ñ—Ñ—Ñ—ñ-–ì–µ–ª–ª–º–∞–Ω 1 –∞–±–æ 2 —è–∫ –∞–ª–≥–æ—Ä–∏—Ç–º **—Ä–æ–∑–ø–æ–¥—ñ–ª—É –∫–ª—é—á–∞** —Ç–∞ 28800 —Å–µ–∫—É–Ω–¥ —è–∫ **—Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –∂–∏—Ç—Ç—è**.

–û—Ç–∂–µ, –ø–µ—Ä—à –∑–∞ –≤—Å–µ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ **–∑–Ω–∞–π—Ç–∏ –¥—ñ–π—Å–Ω–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è**, —â–æ–± —Å–µ—Ä–≤–µ—Ä –ø–æ—á–∞–≤ –∑ –≤–∞–º–∏ —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è. –î–ª—è —Ü—å–æ–≥–æ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç **ike-scan**. –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º Ike-scan –ø—Ä–∞—Ü—é—î –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –ø–∞–∫–µ—Ç –Ω–∞ —à–ª—é–∑ –∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º ISAKMP —Ç–∞ –æ–¥–Ω–∏–º –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—î—é –∑ **–≤–æ—Å—å–º–∏ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è–º–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ**.

–ó–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–µ—è–∫—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫—ñ–Ω—Ü–µ–≤—É —Ç–æ—á–∫—É:
```
root@bt:~# ike-scan -M 172.16.21.200
Starting ike-scan 1.9 with 1 hosts (http://www.nta-monitor.com/tools/ike-scan/)
172.16.21.200    Main Mode Handshake returned
HDR=(CKY-R=d90bf054d6b76401)
SA=(Enc=3DES Hash=SHA1 Group=2:modp1024 Auth=PSK LifeType=Seconds LifeDuration=28800)
VID=4048b7d56ebce88525e7de7f00d6c2d3c0000000 (IKE Fragmentation)

Ending ike-scan 1.9: 1 hosts scanned in 0.015 seconds (65.58 hosts/sec). 1 returned handshake; 0 returned notify
```
–Ø–∫ –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, —î –ø–æ–ª–µ –ø—ñ–¥ –Ω–∞–∑–≤–æ—é **AUTH** –∑—ñ –∑–Ω–∞—á–µ–Ω–Ω—è–º **PSK**. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ VPN –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ–≥–æ –∫–ª—é—á–∞ (—ñ —Ü–µ –¥—ñ–π—Å–Ω–æ –¥–æ–±—Ä–µ –¥–ª—è –ø–µ–Ω—Ç–µ—Å—Ç–µ—Ä–∞).\
**–ó–Ω–∞—á–µ–Ω–Ω—è –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ —Ä—è–¥–∫–∞ —Ç–∞–∫–æ–∂ –¥—É–∂–µ –≤–∞–∂–ª–∏–≤–µ:**

* _0 –ø–æ–≤–µ—Ä–Ω—É—Ç–∏–π handshake; 0 –ø–æ–≤–µ—Ä–Ω—É—Ç–∏–π notify:_ –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —Ü—ñ–ª—å **–Ω–µ —î IPsec —à–ª—é–∑–æ–º**.
* _**1 –ø–æ–≤–µ—Ä–Ω—É—Ç–∏–π handshake; 0 –ø–æ–≤–µ—Ä–Ω—É—Ç–∏–π notify:**_ –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ **—Ü—ñ–ª—å –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞ –¥–ª—è IPsec —ñ –≥–æ—Ç–æ–≤–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–∏ IKE, —ñ –æ–¥–∏–Ω –∞–±–æ –¥–µ–∫—ñ–ª—å–∫–∞ –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–∏—Ö —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ–π –ø—Ä–∏–π–Ω—è—Ç–Ω—ñ** (–¥—ñ–π—Å–Ω–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—è –±—É–¥–µ –ø–æ–∫–∞–∑–∞–Ω–∞ –≤ –≤–∏–≤–æ–¥—ñ).
* _0 –ø–æ–≤–µ—Ä–Ω—É—Ç–∏–π handshake; 1 –ø–æ–≤–µ—Ä–Ω—É—Ç–∏–π notify:_ –®–ª—é–∑–∏ VPN –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º notify, –∫–æ–ª–∏ **–∂–æ–¥–Ω–∞ –∑ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ–π –Ω–µ —î –ø—Ä–∏–π–Ω—è—Ç–Ω–æ—é** (—Ö–æ—á–∞ –¥–µ—è–∫—ñ —à–ª—é–∑–∏ —Ü—å–æ–≥–æ –Ω–µ —Ä–æ–±–ª—è—Ç—å, —É —Ç–∞–∫–æ–º—É –≤–∏–ø–∞–¥–∫—É —Å–ª—ñ–¥ –ø—Ä–æ–≤–µ—Å—Ç–∏ –ø–æ–¥–∞–ª—å—à–∏–π –∞–Ω–∞–ª—ñ–∑ —ñ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—é).

–¢–æ–¥—ñ, –≤ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É —É –Ω–∞—Å –≤–∂–µ —î –¥—ñ–π—Å–Ω–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—è, –∞–ª–µ —è–∫—â–æ –≤–∏ –æ–ø–∏–Ω–∏–ª–∏—Å—è –≤ 3-–º—É –≤–∏–ø–∞–¥–∫—É, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ **—Ç—Ä–æ—Ö–∏ –ø—ñ–¥–±–∏—Ä–∞—Ç–∏ –¥—ñ–π—Å–Ω—É —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—é:**

–°–ø–æ—á–∞—Ç–∫—É –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –≤—Å—ñ –º–æ–∂–ª–∏–≤—ñ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó:
```bash
for ENC in 1 2 3 4 5 6 7/128 7/192 7/256 8; do for HASH in 1 2 3 4 5 6; do for AUTH in 1 2 3 4 5 6 7 8 64221 64222 64223 64224 65001 65002 65003 65004 65005 65006 65007 65008 65009 65010; do for GROUP in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18; do echo "--trans=$ENC,$HASH,$AUTH,$GROUP" >> ike-dict.txt ;done ;done ;done ;done
```
–Ü –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–±—Ä–∞—Ç–∏ –∫–æ–∂–µ–Ω –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é ike-scan (—Ü–µ –º–æ–∂–µ –∑–∞–π–Ω—è—Ç–∏ –∫—ñ–ª—å–∫–∞ —Ö–≤–∏–ª–∏–Ω):
```bash
while read line; do (echo "Valid trans found: $line" && sudo ike-scan -M $line <IP>) | grep -B14 "1 returned handshake" | grep "Valid trans found" ; done < ike-dict.txt
```
–Ø–∫—â–æ –ø–µ—Ä–µ–±—ñ—Ä –ø–∞—Ä–æ–ª—ñ–≤ –Ω–µ –ø—Ä–∞—Ü—é—î, –º–æ–∂–ª–∏–≤–æ, —Å–µ—Ä–≤–µ—Ä –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –±–µ–∑ —Ä—É–∫–æ—Å—Ç–∏—Å–∫–∞–Ω—å –Ω–∞–≤—ñ—Ç—å –Ω–∞ –¥—ñ–π—Å–Ω—ñ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó. –¢–æ–¥—ñ –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ —Ç–æ–π —Å–∞–º–∏–π –ø–µ—Ä–µ–±—ñ—Ä –ø–∞—Ä–æ–ª—ñ–≤, –∞–ª–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∞–≥—Ä–µ—Å–∏–≤–Ω–∏–π —Ä–µ–∂–∏–º:
```bash
while read line; do (echo "Valid trans found: $line" && ike-scan -M --aggressive -P handshake.txt $line <IP>) | grep -B7 "SA=" | grep "Valid trans found" ; done < ike-dict.txt
```
–ù–∞–¥—ñ—é—Å—å, **–¥—ñ–π—Å–Ω–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è**.\
–í–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **—Ç–æ–π —Å–∞–º–∏–π –∞—Ç–∞–∫—É** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é [**iker.py**](https://github.com/isaudits/scripts/blob/master/iker.py).\
–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–±—Ä–∞—Ç–∏ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é [**ikeforce**](https://github.com/SpiderLabs/ikeforce):
```bash
./ikeforce.py <IP> # No parameters are required for scan -h for additional help
```
![](<../.gitbook/assets/image (109).png>)

–£ **–ì—Ä—É–ø—ñ DH: 14 = 2048-–±—ñ—Ç–Ω–∏–π MODP** —ñ **15 = 3072-–±—ñ—Ç–Ω–∏–π**\
**2 = HMAC-SHA = SHA1 (—É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É). –§–æ—Ä–º–∞—Ç `--trans` - $Enc,$Hash,$Auth,$DH**

Cisco –≤–∫–∞–∑—É—î —É–Ω–∏–∫–∞—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≥—Ä—É–ø DH 1 —Ç–∞ 2, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –º—ñ—Ü–Ω—ñ. –ï–∫—Å–ø–µ—Ä—Ç–∏ –≤–≤–∞–∂–∞—é—Ç—å, —â–æ **–∫—Ä–∞—ó–Ω–∏ –∑ –≤–µ–ª–∏–∫–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –º–æ–∂—É—Ç—å –ª–µ–≥–∫–æ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞—Ç–∏** –¥–∞–Ω—ñ, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ü—ñ —Å–ª–∞–±–∫—ñ –≥—Ä—É–ø–∏. –¶–µ —Ä–æ–±–∏—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ–≥–æ –º–µ—Ç–æ–¥—É, —è–∫–∏–π –≥–æ—Ç—É—î —ó—Ö –¥–æ —à–≤–∏–¥–∫–æ–≥–æ —Ä–æ–∑–∫—Ä–∏—Ç—Ç—è –∫–æ–¥—ñ–≤. –ù–∞–≤—ñ—Ç—å —è–∫—â–æ —Ü–µ –∫–æ—à—Ç—É—î –±–∞–≥–∞—Ç–æ –≥—Ä–æ—à–µ–π –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ü—å–æ–≥–æ –º–µ—Ç–æ–¥—É, —Ü–µ –¥–æ–∑–≤–æ–ª—è—î —Ü–∏–º –ø–æ—Ç—É–∂–Ω–∏–º –∫—Ä–∞—ó–Ω–∞–º —á–∏—Ç–∞—Ç–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ, —è–∫—â–æ –≤–æ–Ω–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –≥—Ä—É–ø—É, —è–∫–∞ –Ω–µ —î –º—ñ—Ü–Ω–æ—é (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 1,024-–±—ñ—Ç–Ω–∞ –∞–±–æ –º–µ–Ω—à–∞).

### –í—ñ–¥–±–∏—Ç–æ–∫ —Å–µ—Ä–≤–µ—Ä–∞

–ü–æ—Ç—ñ–º –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ ike-scan, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **–≤–∏—è–≤–∏—Ç–∏ –≤–∏—Ä–æ–±–Ω–∏–∫–∞** –ø—Ä–∏—Å—Ç—Ä–æ—é. –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –Ω–∞–¥—Å–∏–ª–∞—î –ø–æ—á–∞—Ç–∫–æ–≤—É –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—é —Ç–∞ –ø—Ä–∏–ø–∏–Ω—è—î –ø–æ–≤—Ç–æ—Ä–Ω–µ –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è. –ü–æ—Ç—ñ–º –≤—ñ–Ω **–∞–Ω–∞–ª—ñ–∑—É—î** —Ä—ñ–∑–Ω–∏—Ü—é **—á–∞—Å—É** –º—ñ–∂ –æ—Ç—Ä–∏–º–∞–Ω–∏–º–∏ **–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏** –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞ —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–º —à–∞–±–ª–æ–Ω–æ–º –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, –ø–µ–Ω—Ç–µ—Å—Ç–µ—Ä –º–æ–∂–µ —É—Å–ø—ñ—à–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –≤—ñ–¥–±–∏—Ç–æ–∫ –≤–∏—Ä–æ–±–Ω–∏–∫–∞ VPN-—à–ª—é–∑–∞. –ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, –¥–µ—è–∫—ñ VPN-—Å–µ—Ä–≤–µ—Ä–∏ –±—É–¥—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π **–ø–æ–ª–µ–∑–Ω–∏–π –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞ –≤–∏—Ä–æ–±–Ω–∏–∫–∞ (VID)** –∑ IKE.

**–í–∫–∞–∂—ñ—Ç—å –¥—ñ–π—Å–Ω–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ** (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ --trans)

–Ø–∫—â–æ IKE –≤–∏—è–≤–∏—Ç—å, —è–∫–∏–π –≤–∏—Ä–æ–±–Ω–∏–∫, –≤—ñ–Ω –≤–∏–≤–µ–¥–µ –π–æ–≥–æ:
```
root@bt:~# ike-scan -M --showbackoff 172.16.21.200
Starting ike-scan 1.9 with 1 hosts (http://www.nta-monitor.com/tools/ike-scan/)
172.16.21.200    Main Mode Handshake returned
HDR=(CKY-R=4f3ec84731e2214a)
SA=(Enc=3DES Hash=SHA1 Group=2:modp1024 Auth=PSK LifeType=Seconds LifeDuration=28800)
VID=4048b7d56ebce88525e7de7f00d6c2d3c0000000 (IKE Fragmentation)

IKE Backoff Patterns:

IP Address       No.  Recv time            Delta Time
172.16.21.200    1    1322286031.744904    0.000000
172.16.21.200    2    1322286039.745081    8.000177
172.16.21.200    3    1322286047.745989    8.000908
172.16.21.200    4    1322286055.746972    8.000983
172.16.21.200    Implementation guess: Cisco VPN Concentrator

Ending ike-scan 1.9: 1 hosts scanned in 84.080 seconds (0.01 hosts/sec). 1 returned handshake; 0 returned notify
```
–¶–µ —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –¥–æ—Å—è–≥—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å—Ü–µ–Ω–∞—Ä—ñ—é nmap _**ike-version**_

## –ü–æ—à—É–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞ (–Ω–∞–∑–≤–∏ –≥—Ä—É–ø–∏)

–î–ª—è —Ç–æ–≥–æ, —â–æ–± –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–∞—Ö–æ–ø–∏—Ç–∏ —Ö–µ—à, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –º–∞—Ç–∏ –¥—ñ–π—Å–Ω–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è, —è–∫–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î –∞–≥—Ä–µ—Å–∏–≤–Ω–∏–π —Ä–µ–∂–∏–º —Ç–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä (–Ω–∞–∑–≤—É –≥—Ä—É–ø–∏). –ô–º–æ–≤—ñ—Ä–Ω–æ, –≤–∏ –Ω–µ –±—É–¥–µ—Ç–µ –∑–Ω–∞—Ç–∏ –¥—ñ–π—Å–Ω—É –Ω–∞–∑–≤—É –≥—Ä—É–ø–∏, —Ç–æ–º—É –≤–∞–º –¥–æ–≤–µ–¥–µ—Ç—å—Å—è –≤–∏–∫–æ–Ω–∞—Ç–∏ –ø–µ—Ä–µ–±—ñ—Ä.\
–î–ª—è —Ü—å–æ–≥–æ —è —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –≤–∞–º 2 –º–µ—Ç–æ–¥–∏:

### –ü–µ—Ä–µ–±—ñ—Ä ID –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é ike-scan

–°–ø–æ—á–∞—Ç–∫—É —Å–ø—Ä–æ–±—É–π—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞–ø–∏—Ç –∑—ñ —à—Ç—É—á–Ω–∏–º —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–æ–º, –Ω–∞–º–∞–≥–∞—é—á–∏—Å—å –∑—ñ–±—Ä–∞—Ç–∏ —Ö–µ—à ("-P"):
```bash
ike-scan -P -M -A -n fakeID <IP>
```
–Ø–∫—â–æ **—Ö–µ—à –Ω–µ –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è**, —Ç–æ, –π–º–æ–≤—ñ—Ä–Ω–æ, —Ü–µ–π –º–µ—Ç–æ–¥ –±—Ä—É—Ç—Ñ–æ—Ä—Å—É –±—É–¥–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏. **–Ø–∫—â–æ –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è —è–∫–∏–π—Å—å —Ö–µ—à, —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –¥–ª—è —Ñ–∞–ª—å—à–∏–≤–æ–≥–æ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞ –±—É–¥–µ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ —Ñ–∞–ª—å—à–∏–≤–∏–π —Ö–µ—à, —Ç–æ–º—É —Ü–µ–π –º–µ—Ç–æ–¥ –Ω–µ –±—É–¥–µ –Ω–∞–¥—ñ–π–Ω–∏–º** –¥–ª—è –±—Ä—É—Ç—Ñ–æ—Ä—Å—É —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–≤–µ—Ä–Ω–µ–Ω–∏–π —Ñ–∞–ª—å—à–∏–≤–∏–π —Ö–µ—à (—Ü–µ —Å—Ç–∞—î—Ç—å—Å—è –≤ —Å—É—á–∞—Å–Ω–∏—Ö –≤–µ—Ä—Å—ñ—è—Ö):

![](<../.gitbook/assets/image (110).png>)

–ê–ª–µ, —è–∫ —è –≤–∂–µ —Å–∫–∞–∑–∞–≤, —è–∫—â–æ —Ö–µ—à –Ω–µ –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è, —Ç–æ –≤–∞–º —Å–ª—ñ–¥ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –±—Ä—É—Ç—Ñ–æ—Ä—Å–∏—Ç–∏ –∑–∞–≥–∞–ª—å–Ω—ñ –Ω–∞–∑–≤–∏ –≥—Ä—É–ø –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é ike-scan.

–¶–µ–π —Å–∫—Ä–∏–ø—Ç **—Å–ø—Ä–æ–±—É—î –±—Ä—É—Ç—Ñ–æ—Ä—Å–∏—Ç–∏ –º–æ–∂–ª–∏–≤—ñ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏** —ñ –ø–æ–≤–µ—Ä–Ω–µ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏, –¥–µ –ø–æ–≤–µ—Ä–Ω–µ—Ç—å—Å—è –¥—ñ–π—Å–Ω–∏–π "handshake" (—Ü–µ –±—É–¥–µ –¥—ñ–π—Å–Ω–∞ –Ω–∞–∑–≤–∞ –≥—Ä—É–ø–∏).

–Ø–∫—â–æ –≤–∏ –≤–∏—è–≤–∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è, –¥–æ–¥–∞–π—Ç–µ –π–æ–≥–æ —É –∫–æ–º–∞–Ω–¥—É ike-scan. –Ü —è–∫—â–æ –≤–∏ –≤–∏—è–≤–∏–ª–∏ –∫—ñ–ª—å–∫–∞ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω—å, –Ω–µ —Å–æ—Ä–æ–º—Ç–µ—Å—è –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–π —Ü–∏–∫–ª, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ —ó—Ö –≤—Å—ñ (–≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ —ó—Ö –≤—Å—ñ, –ø–æ–∫–∏ –æ–¥–Ω–µ –∑ –Ω–∏—Ö –Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ –Ω–∞–ª–µ–∂–Ω–∏–º —á–∏–Ω–æ–º).

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ [—Å–ª–æ–≤–Ω–∏–∫ ikeforce](https://github.com/SpiderLabs/ikeforce/blob/master/wordlists/groupnames.dic) –∞–±–æ [—Ç–æ–π, —â–æ –≤ seclists](https://github.com/danielmiessler/SecLists/blob/master/Miscellaneous/ike-groupid.txt) –∑—ñ –∑–∞–≥–∞–ª—å–Ω–∏–º–∏ –Ω–∞–∑–≤–∞–º–∏ –≥—Ä—É–ø –¥–ª—è –±—Ä—É—Ç—Ñ–æ—Ä—Å—É —ó—Ö:
```bash
while read line; do (echo "Found ID: $line" && sudo ike-scan -M -A -n $line <IP>) | grep -B14 "1 returned handshake" | grep "Found ID:"; done < /usr/share/wordlists/external/SecLists/Miscellaneous/ike-groupid.txt
```
### –í—ñ–¥–∫—Ä–∏—Ç—Ç—è ID –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Iker

[**iker.py**](https://github.com/isaudits/scripts/blob/master/iker.py) —Ç–∞–∫–æ–∂ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **ike-scan** –¥–ª—è –ø–µ—Ä–µ–±–æ—Ä—É –º–æ–∂–ª–∏–≤–∏—Ö –Ω–∞–∑–≤ –≥—Ä—É–ø. –í—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤–ª–∞—Å–Ω–∏–π –º–µ—Ç–æ–¥ –¥–ª—è **–∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –¥—ñ–π—Å–Ω–æ–≥–æ ID –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–∏–≤–æ–¥—É ike-scan**.

### –í—ñ–¥–∫—Ä–∏—Ç—Ç—è ID –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é ikeforce

[**ikeforce.py**](https://github.com/SpiderLabs/ikeforce) - —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —è–∫–∏–π –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è **–ø–µ—Ä–µ–±–æ—Ä—É ID —Ç–∞–∫–æ–∂**. –¶–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –±—É–¥–µ **–Ω–∞–º–∞–≥–∞—Ç–∏—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ**, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è **–≤—ñ–¥—Ä—ñ–∑–Ω–µ–Ω–Ω—è –º—ñ–∂ –¥—ñ–π—Å–Ω–∏–º —Ç–∞ –Ω–µ–¥—ñ–π—Å–Ω–∏–º ID** (–º–æ–∂–µ –±—É—Ç–∏ –ø–æ–º–∏–ª–∫–æ–≤—ñ –ø–æ–∑–∏—Ç–∏–≤–∏ —Ç–∞ –ø–æ–º–∏–ª–∫–æ–≤—ñ –Ω–µ–≥–∞—Ç–∏–≤–∏, —Ç–æ–º—É —è –≤—ñ–¥–¥–∞—é –ø–µ—Ä–µ–≤–∞–≥—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—é –º–µ—Ç–æ–¥—É ike-scan, —è–∫—â–æ —Ü–µ –º–æ–∂–ª–∏–≤–æ).

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º **ikeforce** –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç—å —Å–ø–æ—á–∞—Ç–∫—É –¥–µ—è–∫—ñ –≤–∏–ø–∞–¥–∫–æ–≤—ñ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø–æ–≤–µ–¥—ñ–Ω–∫—É —Å–µ—Ä–≤–µ—Ä–∞ —Ç–∞ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ —Ç–∞–∫—Ç–∏–∫—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è.

* –ü–µ—Ä—à–∏–π –º–µ—Ç–æ–¥ –ø–æ–ª—è–≥–∞—î –≤ –ø–µ—Ä–µ–±–æ—Ä—ñ –Ω–∞–∑–≤ –≥—Ä—É–ø —à–ª—è—Ö–æ–º **–ø–æ—à—É–∫—É** —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó **Dead Peer Detection DPD** —Å–∏—Å—Ç–µ–º Cisco (—Ü—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –≤—ñ–¥—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –ª–∏—à–µ —Å–µ—Ä–≤–µ—Ä–æ–º, —è–∫—â–æ –Ω–∞–∑–≤–∞ –≥—Ä—É–ø–∏ –≤—ñ—Ä–Ω–∞).
* –î—Ä—É–≥–∏–π –¥–æ—Å—Ç—É–ø–Ω–∏–π –º–µ—Ç–æ–¥ - **–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π –Ω–∞ –∫–æ–∂–Ω—É —Å–ø—Ä–æ–±—É**, –æ—Å–∫—ñ–ª—å–∫–∏ —ñ–Ω–æ–¥—ñ –±—ñ–ª—å—à–µ –ø–∞–∫–µ—Ç—ñ–≤ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—Ç—å—Å—è, –∫–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä.
* –¢—Ä–µ—Ç—ñ–π –º–µ—Ç–æ–¥ –ø–æ–ª—è–≥–∞—î –≤ **–ø–æ—à—É–∫—É "INVALID-ID-INFORMATION" —É –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π ID**.
* –ù–∞—Ä–µ—à—Ç—ñ, —è–∫—â–æ —Å–µ—Ä–≤–µ—Ä –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, **ikeforce** —Å–ø—Ä–æ–±—É—î –ø–µ—Ä–µ–±–æ—Ä–æ—Ç–∏ —Å–µ—Ä–≤–µ—Ä —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —Å–µ—Ä–≤–µ—Ä –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä —è–∫–∏–º–æ—Å—å –ø–∞–∫–µ—Ç–æ–º.\
–û—á–µ–≤–∏–¥–Ω–æ, –º–µ—Ç–æ—é –ø–µ—Ä–µ–±–æ—Ä—É —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞ —î –æ—Ç—Ä–∏–º–∞–Ω–Ω—è **PSK**, –∫–æ–ª–∏ —É –≤–∞—Å —î –¥—ñ–π—Å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä. –ü–æ—Ç—ñ–º, –∑ **—ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–æ–º** —Ç–∞ **PSK** –≤–∞–º –¥–æ–≤–µ–¥–µ—Ç—å—Å—è –ø–µ—Ä–µ–±—Ä–∞—Ç–∏ XAUTH (—è–∫—â–æ –≤—ñ–Ω —É–≤—ñ–º–∫–Ω–µ–Ω–∏–π).

–Ø–∫—â–æ –≤–∏ –≤–∏—è–≤–∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è, –¥–æ–¥–∞–π—Ç–µ –π–æ–≥–æ —É –∫–æ–º–∞–Ω–¥—É ikeforce. –Ü —è–∫—â–æ –≤–∏ –≤–∏—è–≤–∏–ª–∏ –∫—ñ–ª—å–∫–∞ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω—å, –Ω–µ —Å–æ—Ä–æ–º—Ç–µ—Å—è –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–π —Ü–∏–∫–ª –¥–ª—è —Å–ø—Ä–æ–±–∏ –≤—Å—ñ—Ö –Ω–∏—Ö (–≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤—Å—ñ –¥–æ —Ç–∏—Ö –ø—ñ—Ä, –ø–æ–∫–∏ –æ–¥–Ω–µ –∑ –Ω–∏—Ö –Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ –Ω–∞–ª–µ–∂–Ω–∏–º —á–∏–Ω–æ–º).
```bash
git clone https://github.com/SpiderLabs/ikeforce.git
pip install 'pyopenssl==17.2.0' #It is old and need this version of the library
```

```bash
./ikeforce.py <IP> -e -w ./wordlists/groupnames.dic
```
### –ü—ñ–¥—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è ID

(–ó –∫–Ω–∏–≥–∏ **–û—Ü—ñ–Ω–∫–∞ –º–µ—Ä–µ–∂–µ–≤–æ—ó –±–µ–∑–ø–µ–∫–∏: –ó–Ω–∞–π–æ–º—Ç–µ—Å—å –∑ –≤–∞—à–æ—é –º–µ—Ä–µ–∂–µ—é**): –¢–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥—ñ–π—Å–Ω—ñ —ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –ø—ñ–¥—Å–ª—É—Ö–æ–≤—É—é—á–∏ –∑'—î–¥–Ω–∞–Ω–Ω—è –º—ñ–∂ –∫–ª—ñ—î–Ω—Ç–æ–º VPN —Ç–∞ —Å–µ—Ä–≤–µ—Ä–æ–º, –æ—Å–∫—ñ–ª—å–∫–∏ –ø–µ—Ä—à–∏–π –ø–∞–∫–µ—Ç —Ä–µ–∂–∏–º—É –∞–≥—Ä–µ—Å–∏–≤–Ω–æ–≥–æ —Ä–µ–∂–∏–º—É, —â–æ –º—ñ—Å—Ç–∏—Ç—å —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –∫–ª—ñ—î–Ω—Ç–∞, –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –≤—ñ–¥–∫—Ä–∏—Ç–æ

![](<../.gitbook/assets/image (111).png>)

## –ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ö–µ—à—É

–ù–∞—Ä–µ—à—Ç—ñ, —è–∫—â–æ –≤–∏ –∑–Ω–∞–π—à–ª–∏ **–¥—ñ–π—Å–Ω–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è** —Ç–∞ **–Ω–∞–∑–≤—É –≥—Ä—É–ø–∏** —ñ —è–∫—â–æ **—Ä–µ–∂–∏–º –∞–≥—Ä–µ—Å–∏–≤–Ω–æ–≥–æ —Ä–µ–∂–∏–º—É –¥–æ–∑–≤–æ–ª–µ–Ω–∏–π**, —Ç–æ –≤–∏ –º–æ–∂–µ—Ç–µ –¥—É–∂–µ –ª–µ–≥–∫–æ –∑–∞—Ö–æ–ø–∏—Ç–∏ —Ä–æ–∑–∫—Ä–∏–≤–Ω–∏–π —Ö–µ—à:
```bash
ike-scan -M -A -n <ID> --pskcrack=hash.txt <IP> #If aggressive mode is supported and you know the id, you can get the hash of the passwor
```
–•–µ—à –±—É–¥–µ –∑–±–µ—Ä–µ–∂–µ–Ω–æ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ _hash.txt_.

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **psk-crack**, **john** (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ [**ikescan2john.py**](https://github.com/truongkma/ctf-tools/blob/master/John/run/ikescan2john.py)) —Ç–∞ **hashcat** –¥–ª—è **–≤–∑–ª–æ–º—É** —Ö–µ—à—É:
```bash
psk-crack -d <Wordlist_path> psk.txt
```
## **XAuth**

**–ê–≥—Ä–µ—Å–∏–≤–Ω–∏–π —Ä–µ–∂–∏–º IKE**, –ø–æ—î–¥–Ω–∞–Ω–∏–π –∑ **Pre-Shared Key (PSK)**, –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è **–≥—Ä—É–ø–æ–≤–æ—ó –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó**. –¶–µ–π –º–µ—Ç–æ–¥ –¥–æ–ø–æ–≤–Ω—é—î—Ç—å—Å—è **XAuth (Extended Authentication)**, —è–∫–∏–π —Å–ª—É–∂–∏—Ç—å –¥–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ–≥–æ —Ä—ñ–≤–Ω—è **–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**. –¢–∞–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø–æ—Å–ª—É–≥–∏, —Ç–∞–∫—ñ —è–∫ **Microsoft Active Directory**, **RADIUS** –∞–±–æ –ø–æ–¥—ñ–±–Ω—ñ —Å–∏—Å—Ç–µ–º–∏.

–ü–µ—Ä–µ—Ö—ñ–¥ –¥–æ **IKEv2** –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –ø–æ–º—ñ—Ç–Ω–æ–≥–æ –∑—Å—É–≤—É, –¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **EAP (Extensible Authentication Protocol)** –∑–∞–º—ñ—Å—Ç—å **XAuth** –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤. –¶—è –∑–º—ñ–Ω–∞ –ø—ñ–¥–∫—Ä–µ—Å–ª—é—î –µ–≤–æ–ª—é—Ü—ñ—é –ø—Ä–∞–∫—Ç–∏–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –≤ –±–µ–∑–ø–µ—á–Ω–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–∞—Ö –∑–≤'—è–∑–∫—É.


### –õ–æ–∫–∞–ª—å–Ω–∞ –∞—Ç–∞–∫–∞ Man-in-the-Middle –¥–ª—è –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö

–¢–∞–∫–∏–º —á–∏–Ω–æ–º, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞—Ö–æ–ø–∏—Ç–∏ –¥–∞–Ω—ñ –≤—Ö–æ–¥—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ _fiked_ —ñ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏, —á–∏ —î —è–∫—ñ-–Ω–µ–±—É–¥—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ —ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (–í–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç–∏ —Ç—Ä–∞—Ñ—ñ–∫ IKE –Ω–∞ `fiked` –¥–ª—è –ø—ñ–¥—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è, —â–æ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é ARP-–ø—ñ–¥—Ä–æ–±–ª–µ–Ω–Ω—è, [–¥–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è](https://opensourceforu.com/2012/01/ipsec-vpn-penetration-testing-backtrack-tools/)). Fiked –±—É–¥–µ –¥—ñ—è—Ç–∏ —è–∫ –∫—ñ–Ω—Ü–µ–≤–∞ —Ç–æ—á–∫–∞ VPN —ñ –∑–∞—Ö–æ–ø–ª—é–≤–∞—Ç–∏–º–µ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ XAuth:
```bash
fiked -g <IP> -k testgroup:secretkey -l output.txt -d
```
–¢–∞–∫–æ–∂, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ IPSec, —Å–ø—Ä–æ–±—É–π—Ç–µ –∑–¥—ñ–π—Å–Ω–∏—Ç–∏ –∞—Ç–∞–∫—É —Ç–∏–ø—É "–ª—é–¥–∏–Ω–∞ –ø–æ—Å–µ—Ä–µ–¥–∏–Ω—ñ" —ñ –∑–∞–±–ª–æ–∫—É–π—Ç–µ –≤–µ—Å—å —Ç—Ä–∞—Ñ—ñ–∫ –Ω–∞ –ø–æ—Ä—Ç 500, —è–∫—â–æ —Ç—É–Ω–µ–ª—å IPSec –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π, –º–æ–∂–ª–∏–≤–æ, —Ç—Ä–∞—Ñ—ñ–∫ –±—É–¥–µ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≤—ñ–¥–∫—Ä–∏—Ç–æ.

### Brute-forcing XAUTH username ad password with ikeforce

–î–ª—è –ø–µ—Ä–µ–±–æ—Ä—É **XAUTH** (–∫–æ–ª–∏ –≤–∏ –∑–Ω–∞—î—Ç–µ –¥—ñ–π—Å–Ω–µ —ñ–º'—è –≥—Ä—É–ø–∏ **id** —Ç–∞ **psk**), –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∞–±–æ —Å–ø–∏—Å–æ–∫ —ñ–º–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ —Å–ø–∏—Å–æ–∫ –ø–∞—Ä–æ–ª—ñ–≤:
```bash
./ikeforce.py <IP> -b -i <group_id> -u <username> -k <PSK> -w <passwords.txt> [-s 1]
```
–¶–∏–º —á–∏–Ω–æ–º, ikeforce —Å–ø—Ä–æ–±—É—î –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∫–æ–∂–Ω—É –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—é —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞: –ø–∞—Ä–æ–ª—è.

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π—à–ª–∏ –æ–¥–∏–Ω –∞–±–æ –∫—ñ–ª—å–∫–∞ –¥—ñ–π—Å–Ω–∏—Ö —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ–π, –ø—Ä–æ—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —ó—Ö, —è–∫ —É –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –∫—Ä–æ–∫–∞—Ö.

## –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∑ IPSEC VPN

–£ Kali –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç—É–Ω–µ–ª—ñ–≤ IPsec –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **VPNC**. **–ü—Ä–æ—Ñ—ñ–ª—ñ** –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω—ñ –≤ –∫–∞—Ç–∞–ª–æ–∑—ñ `/etc/vpnc/`. –í–∏ –º–æ–∂–µ—Ç–µ —ñ–Ω—ñ—Ü—ñ—é–≤–∞—Ç–∏ —Ü—ñ –ø—Ä–æ—Ñ—ñ–ª—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–º–∞–Ω–¥–∏ _**vpnc**_.

–ù–∞—Å—Ç—É–ø–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ —Ç–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —ñ–ª—é—Å—Ç—Ä—É—é—Ç—å –ø—Ä–æ—Ü–µ—Å –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ VPN –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é VPNC:
```bash
root@system:~# cat > /etc/vpnc/samplevpn.conf << STOP
IPSec gateway [VPN_GATEWAY_IP]
IPSec ID [VPN_CONNECTION_ID]
IPSec secret [VPN_GROUP_SECRET]
IKE Authmode psk
Xauth username [VPN_USERNAME]
Xauth password [VPN_PASSWORD]
STOP
root@system:~# vpnc samplevpn
VPNC started in background (pid: [PID])...
root@system:~# ifconfig tun0
```
–£ —Ü—å–æ–º—É –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—ñ:

- –ó–∞–º—ñ–Ω—ñ—Ç—å `[VPN_GATEWAY_IP]` –Ω–∞ —Ñ–∞–∫—Ç–∏—á–Ω—É IP-–∞–¥—Ä–µ—Å—É —à–ª—é–∑—É VPN.
- –ó–∞–º—ñ–Ω—ñ—Ç—å `[VPN_CONNECTION_ID]` –Ω–∞ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ VPN.
- –ó–∞–º—ñ–Ω—ñ—Ç—å `[VPN_GROUP_SECRET]` –Ω–∞ —Å–µ–∫—Ä–µ—Ç–Ω—É –≥—Ä—É–ø—É VPN.
- –ó–∞–º—ñ–Ω—ñ—Ç—å `[VPN_USERNAME]` —Ç–∞ `[VPN_PASSWORD]` –Ω–∞ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó VPN.
- `[PID]` —Å–∏–º–≤–æ–ª—ñ–∑—É—î —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—É, —è–∫–∏–π –±—É–¥–µ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–æ –ø—Ä–∏ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó `vpnc`.

–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è VPN –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —Ñ–∞–∫—Ç–∏—á–Ω—ñ, –±–µ–∑–ø–µ—á–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –∑–∞–º—ñ–Ω–∏ –∑–∞–ø–æ–≤–Ω—é–≤–∞—á—ñ–≤.

## –î–∂–µ—Ä–µ–ª–∞ –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤

* [–î–æ–∫—É–º–µ–Ω—Ç –∑—ñ –∑–ª–∞–º—É PSK](http://www.ernw.de/download/pskattack.pdf)
* [SecurityFocus Infocus](http://www.securityfocus.com/infocus/1821)
* [–°–∫–∞–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó VPN](http://www.radarhack.com/dir/papers/Scanning\_ike\_with\_ikescan.pdf)
* –û—Ü—ñ–Ω–∫–∞ –±–µ–∑–ø–µ–∫–∏ –º–µ—Ä–µ–∂—ñ, 3-—Ç—î –≤–∏–¥–∞–Ω–Ω—è

## Shodan

* `port:500 IKE`

**Try Hard Security Group**

<figure><img src="/.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ **—Ä–µ–∫–ª–∞–º—É –≤–∞—à–æ—ó –∫–æ–º–ø–∞–Ω—ñ—ó –≤ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>
