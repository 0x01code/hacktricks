O m√≥dulo envia uma consulta √† porta **264/TCP** em firewalls **CheckPoint Firewall-1** para obter o nome do firewall e o nome da esta√ß√£o de gerenciamento (como SmartCenter) por meio de uma solicita√ß√£o de pr√©-autentica√ß√£o.
```text
use auxiliary/gather/checkpoint_hostname
set RHOST 10.10.xx.xx
```
# Pentesting Check Point Firewall-1

## Introdu√ß√£o

O Check Point Firewall-1 √© um firewall de rede que fornece seguran√ßa para redes corporativas. Ele √© usado para proteger a rede de amea√ßas externas e internas. O Firewall-1 √© um dos firewalls mais populares do mercado e √© usado por muitas empresas em todo o mundo.

## Verificando a vers√£o do Firewall-1

Para verificar a vers√£o do Firewall-1, voc√™ pode usar o comando `fw ver`. Este comando exibe a vers√£o do Firewall-1 e outras informa√ß√µes importantes, como a data de compila√ß√£o e o n√∫mero de compila√ß√£o.

```
$ fw ver
This is Check Point Firewall-1 version 4.1b build 183
```

## Verificando as regras do Firewall-1

Para verificar as regras do Firewall-1, voc√™ pode usar o comando `fw ls`. Este comando exibe todas as regras do Firewall-1 e outras informa√ß√µes importantes, como a pol√≠tica padr√£o e as regras NAT.

```
$ fw ls
Policy: Accept
NAT: Hide behind gateway

1.  src: any, dst: any, svc: any, action: accept
2.  src: any, dst: any, svc: any, action: drop
```

## Verificando as conex√µes do Firewall-1

Para verificar as conex√µes do Firewall-1, voc√™ pode usar o comando `fw tab -t connections -s`. Este comando exibe todas as conex√µes ativas do Firewall-1 e outras informa√ß√µes importantes, como o tempo de inatividade e o tempo de vida.

```
$ fw tab -t connections -s
HOSTS/NETS       PORTS     PROT     TIMEOUT
10.0.0.1         80        tcp      23:59:59
10.0.0.2         443       tcp      23:59:59
```

## Verificando os logs do Firewall-1

Para verificar os logs do Firewall-1, voc√™ pode usar o comando `fw log`. Este comando exibe todos os logs do Firewall-1 e outras informa√ß√µes importantes, como o tempo e a origem do log.

```
$ fw log
date=2019-01-01 time=12:00:00 devname=firewall1 devid=123456789 type=traffic subtype=allowed pri=notice vd=root src=10.0.0.1 src_port=1234 dst=10.0.0.2 dst_port=80 src_int=eth0 dst_int=eth1 SN=1234 proto=tcp service=http policy=allow
```
```text
[*] Attempting to contact Checkpoint FW1 SecuRemote Topology service...
[+] Appears to be a CheckPoint Firewall...
[+] Firewall Host: FIREFIGHTER-SEC
[+] SmartCenter Host: FIREFIGHTER-MGMT.example.com
[*] Auxiliary module execution completed
```
Outra maneira de obter o nome do host e o nome do ICA do firewall pode ser
```bash
printf '\x51\x00\x00\x00\x00\x00\x00\x21\x00\x00\x00\x0bsecuremote\x00' | nc -q 1 x.x.x.x 264 | grep -a CN | cut -c 2-
```
# Pentesting Check Point Firewall-1

## Introdu√ß√£o

O Check Point Firewall-1 √© um firewall de rede que fornece seguran√ßa para redes corporativas. Ele √© usado para proteger a rede de amea√ßas externas e internas. O Firewall-1 √© um dos firewalls mais populares do mercado e √© usado por muitas empresas em todo o mundo.

## Verificando a vers√£o do Firewall-1

Para verificar a vers√£o do Firewall-1, voc√™ pode usar o comando `fw ver`. Este comando exibe a vers√£o do Firewall-1 e outras informa√ß√µes importantes, como a data de compila√ß√£o e o n√∫mero de compila√ß√£o.

```
$ fw ver
This is Check Point Firewall-1 version 4.1b build 183
```

## Verificando as regras do Firewall-1

Para verificar as regras do Firewall-1, voc√™ pode usar o comando `fw ctl zdebug drop`. Este comando exibe as regras que est√£o sendo aplicadas pelo Firewall-1 e quaisquer pacotes que foram descartados.

```
$ fw ctl zdebug drop
```

## Verificando as conex√µes do Firewall-1

Para verificar as conex√µes do Firewall-1, voc√™ pode usar o comando `fw tab -t connections -s`. Este comando exibe as conex√µes ativas no Firewall-1.

```
$ fw tab -t connections -s
```

## Verificando as interfaces do Firewall-1

Para verificar as interfaces do Firewall-1, voc√™ pode usar o comando `ifconfig`. Este comando exibe as interfaces de rede do Firewall-1 e suas configura√ß√µes.

```
$ ifconfig
```

## Conclus√£o

O Check Point Firewall-1 √© um firewall de rede poderoso que √© usado por muitas empresas em todo o mundo. √â importante verificar a vers√£o, as regras, as conex√µes e as interfaces do Firewall-1 para garantir que ele esteja configurado corretamente e protegendo a rede de amea√ßas externas e internas.
```text
CN=Panama,O=MGMTT.srv.rxfrmi
```
De: [https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit\_doGoviewsolutiondetails=&solutionid=sk69360](https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360)



<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Voc√™ trabalha em uma **empresa de ciberseguran√ßa**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe seus truques de hacking enviando PRs para o [reposit√≥rio hacktricks](https://github.com/carlospolop/hacktricks) e [reposit√≥rio hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
