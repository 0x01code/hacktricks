```markdown
<details>

<summary><strong>AWSハッキングをゼロからヒーローまで学ぶには</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksに広告を掲載したい場合**や**HackTricksをPDFでダウンロードしたい場合**は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください。
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションをチェックする
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)や[**テレグラムグループ**](https://t.me/peass)に**参加する**か、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォローする**。
* [**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のgithubリポジトリにPRを提出して、あなたのハッキングのコツを共有してください。

</details>


# TNS Poison

リスナーの新しいバージョンに遭遇した場合、ブルートフォース以外にあまり余地はありません。ただし、バージョン12cまでのすべてのバージョンは「TNS Poison」と呼ばれる攻撃に対して脆弱です。ただし、後者のバージョンは特定の設定でのみ脆弱です。例えば、この脆弱性を修正する方法の一つは、リスナーの動的設定を無効にすることですが、Oracle DataGuard、PL/SQL GatewayをAPEXと連携して使用する場合や、SAPの一部のバージョンでは不可能です。一般的に、問題は、デフォルトではリスナーサービスがリモート設定をサポートしており、さらに匿名で行うことができることです。ここに脆弱性の核心があります。

[![図1. TNS Poison 脆弱性](https://hackmag.com/wp-content/uploads/2015/04/poison.png)](https://hackmag.com/wp-content/uploads/2015/04/poison.png)

図1. TNS Poison 脆弱性

これは攻撃アルゴリズムのサンプルです（図1を参照）:

* 次のTNSクエリを送信します: 'CONNECT\_DATA=\(COMMAND=SERVICE\_REGISTER\_NSGR\)\)'。
* 脆弱なサーバーは次のように応答します: '\(DESCRIPTION=\(TMP=\)\)'。パッチが適用されたサーバーからの応答は次のようになります: '\(ERROR\_STACK=\(ERROR=1194\)\)'。
* 新しいリスナーのSIDとIPを含む設定パッケージを生成します（将来のMITM用）。現在のSIDの名前の文字数は非常に重要です。これがWell Formedパッケージに依存しているため、知っておく必要があります。
* 次に、これらの情報をリスナーに送信します。
* すべてが正しければ、新しい接続はリスナーによって制御されたIPを介して転送されます。

クエリのプロキシを有効にすることを忘れないでください（LinuxのIP\_forwardingのように）、そうでなければ、新しいクライアントがデータベースに接続できなくなるため、整然としたMITM攻撃の代わりに粗雑なDoSが発生します。結果として、攻撃者は他のユーザーのセッション内に自分のコマンドを埋め込むことができます。**サーバーが脆弱であるかどうかは、次のMSFモジュールを使用して確認できます: 'auxiliary/scanner/oracle/tnspoison\_checker'。**

このページのすべてはここから抜粋されました: [https://hackmag.com/uncategorized/looking-into-methods-to-penetrate-oracle-db/](https://hackmag.com/uncategorized/looking-into-methods-to-penetrate-oracle-db/)

**他のテスト方法:**
```
```text
./odat.py tnspoison -s <IP> -p <PORT> -d <SID> --test-module
```
<details>

<summary><strong>AWSハッキングをゼロからヒーローまで学ぶには</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>をチェック！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告したい**、または**HackTricksをPDFでダウンロードしたい**場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください。
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう。
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)コレクションをチェックしてください。
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)や[**telegramグループ**](https://t.me/peass)に**参加する**か、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォロー**してください。
* [**HackTricks**](https://github.com/carlospolop/hacktricks)および[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のgithubリポジトリにPRを提出して、あなたのハッキングのコツを**共有**してください。

</details>
