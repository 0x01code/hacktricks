```markdown
<details>

<summary><strong>从零到英雄学习AWS黑客攻击</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS红队专家)</strong></a><strong>！</strong></summary>

支持HackTricks的其他方式：

* 如果您想在**HackTricks中看到您的公司广告**或**下载HackTricks的PDF**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方PEASS & HackTricks商品**](https://peass.creator-spring.com)
* 发现[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们独家的[**NFTs系列**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram群组**](https://t.me/peass) 或在**Twitter** 🐦 上**关注**我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。**

</details>


# TNS Poison

如果您遇到了更新版本的监听器，除了暴力破解之外，没有太多的余地。然而，所有版本直到12c版本都容易受到一种称为‘TNS Poison’的攻击。尽管后来的版本只在某些特殊配置下容易受到攻击。例如，修复此漏洞的方法之一是禁用监听器的动态配置，这在使用Oracle DataGuard、PL/SQL Gateway与APEX连接以及某些版本的SAP时是不可能的。总的来说，问题在于，默认情况下，监听服务支持远程配置，并且它允许匿名进行。这就是漏洞的核心所在。

[![图 1. TNS Poison 漏洞](https://hackmag.com/wp-content/uploads/2015/04/poison.png)](https://hackmag.com/wp-content/uploads/2015/04/poison.png)

图 1. TNS Poison 漏洞

以下是一个示例攻击算法 \(见图 1\):

* 发送以下TNS查询：‘CONNECT\_DATA=\(COMMAND=SERVICE\_REGISTER\_NSGR\)\)’。
* 易受攻击的服务器将回应：‘\(DESCRIPTION=\(TMP=\)\)’。这将是打过补丁的服务器的回答：‘\(ERROR\_STACK=\(ERROR=1194\)\)’。
* 生成一个配置包，包含新监听器的SID和IP（用于未来的MITM）。当前SID名称中的字符数量至关重要。您需要知道它，因为这是一个格式正确的包所依赖的。
* 接下来，将所有这些好东西发送给监听器。
* 如果一切正确，那么所有新的连接都将通过您控制的IP由监听器转发。

重要的是不要忘记启用查询代理（如Linux中的IP\_forwarding），否则，您将得到一个粗糙的DoS攻击，而不是一个整洁的MITM攻击，因为新客户端将无法连接到数据库。结果，攻击者可以在另一个用户的会话中嵌入他们自己的命令。**您可以使用以下MSF模块检查服务器是否容易受到攻击：‘auxiliary/scanner/oracle/tnspoison\_checker’。**

本页内容摘自此处：[https://hackmag.com/uncategorized/looking-into-methods-to-penetrate-oracle-db/](https://hackmag.com/uncategorized/looking-into-methods-to-penetrate-oracle-db/)

**另一种测试方式：**
```
```text
./odat.py tnspoison -s <IP> -p <PORT> -d <SID> --test-module
```
<details>

<summary><strong>从零到英雄学习AWS黑客攻击，通过</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>！</strong></summary>

支持HackTricks的其他方式：

* 如果您想在**HackTricks中看到您的公司广告**或**下载HackTricks的PDF**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方PEASS & HackTricks商品**](https://peass.creator-spring.com)
* 发现[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们独家的[**NFTs系列**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram群组**](https://t.me/peass) 或在 **Twitter** 🐦 上**关注**我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。

</details>
