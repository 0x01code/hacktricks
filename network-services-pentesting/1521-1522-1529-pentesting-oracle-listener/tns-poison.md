```markdown
<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>


# TNS Poison

Si vous rencontrez une version plus r√©cente de l'√©couteur, il ne reste pas beaucoup de marge sauf le brute-forcing. Cependant, toutes les versions jusqu'√† la version 12c sont vuln√©rables √† une attaque appel√©e 'TNS Poison'. Bien que la version ult√©rieure soit vuln√©rable uniquement dans certaines configurations sp√©ciales. Par exemple, l'une des fa√ßons de corriger cette vuln√©rabilit√© est de d√©sactiver la configuration dynamique de l'√©couteur, ce qui est impossible lors de l'utilisation d'Oracle DataGuard, PL/SQL Gateway en connexion avec APEX et dans certaines versions de SAP. En g√©n√©ral, le probl√®me est que, par d√©faut, le service d'√©coute prend en charge la configuration √† distance et, de plus, il permet de le faire de mani√®re anonyme. C'est l√† que r√©side le c≈ìur de la vuln√©rabilit√©.

[![Fig. 1. Vuln√©rabilit√© TNS Poison](https://hackmag.com/wp-content/uploads/2015/04/poison.png)](https://hackmag.com/wp-content/uploads/2015/04/poison.png)

Fig. 1. Vuln√©rabilit√© TNS Poison

Voici un algorithme d'attaque exemple \(voir Fig. 1\) :

* Envoyez la requ√™te TNS suivante : 'CONNECT\_DATA=\(COMMAND=SERVICE\_REGISTER\_NSGR\)\)'.
* Le serveur vuln√©rable r√©pondra : '\(DESCRIPTION=\(TMP=\)\)'. Voici ce que sera la r√©ponse d'un serveur patch√© : '\(ERROR\_STACK=\(ERROR=1194\)\)'.
* G√©n√©rez un package de configuration avec SID et IP du nouvel √©couteur \(pour un futur MITM\). Le nombre de caract√®res dans le nom du SID actuel est d'une importance fondamentale. Vous devez le conna√Ætre, car c'est ce dont d√©pend un package Bien Form√©.
* Ensuite, envoyez toutes ces bonnes choses √† l'√©couteur.
* Si tout est correct, alors toutes les nouvelles connexions seront redirig√©es par l'√©couteur via votre IP contr√¥l√©e.

Il est important de ne pas oublier d'activer le proxying des requ√™tes \(comme IP\_forwarding sous Linux\), sinon, au lieu d'une attaque MITM soign√©e, vous obtiendrez un DoS brutal, car les nouveaux clients ne pourront pas se connecter √† la base de donn√©es. En cons√©quence, un attaquant peut int√©grer ses propres commandes dans la session d'un autre utilisateur. **Vous pouvez v√©rifier si le serveur est vuln√©rable en utilisant le module MSF suivant : 'auxiliary/scanner/oracle/tnspoison\_checker'.**

Toute cette page a √©t√© extraite d'ici : [https://hackmag.com/uncategorized/looking-into-methods-to-penetrate-oracle-db/](https://hackmag.com/uncategorized/looking-into-methods-to-penetrate-oracle-db/)

**Autre mani√®re de tester :**
```
```text
./odat.py tnspoison -s <IP> -p <PORT> -d <SID> --test-module
```
<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez**-moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
