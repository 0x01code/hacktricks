<details>

<summary><strong>Aprende hacking en AWS de cero a h칠roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCI칍N**](https://github.com/sponsors/carlospolop)!
* Obt칠n el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci칩n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤gueme** en **Twitter** 游냕 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de GitHub de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>


# TNS Poison

Si te encuentras con una versi칩n m치s reciente del listener, no queda mucho margen excepto fuerza bruta. Sin embargo, todas las versiones hasta la 12c son vulnerables a un ataque llamado 'TNS Poison'. Aunque la 칰ltima versi칩n es vulnerable solo en algunas configuraciones especiales. Por ejemplo, una de las formas de solucionar esta vulnerabilidad es deshabilitando la configuraci칩n din치mica del listener, lo cual es imposible cuando se utiliza Oracle DataGuard, PL/SQL Gateway en conexi칩n con APEX y en algunas versiones de SAP. En general, el problema es que, por defecto, el servicio de listener admite configuraci칩n remota y, adem치s, permite hacerlo de forma an칩nima. Aqu칤 radica el coraz칩n de la vulnerabilidad.

[![Fig. 1. Vulnerabilidad TNS Poison](https://hackmag.com/wp-content/uploads/2015/04/poison.png)](https://hackmag.com/wp-content/uploads/2015/04/poison.png)

Fig. 1. Vulnerabilidad TNS Poison

Este es un algoritmo de ataque de muestra \(ver Fig. 1\):

* Enviar la siguiente consulta TNS: 'CONNECT\_DATA=(COMMAND=SERVICE\_REGISTER\_NSGR)'.
* El servidor vulnerable responder치: '(DESCRIPTION=(TMP=))'. Esta ser치 la respuesta de un servidor parcheado: '(ERROR\_STACK=(ERROR=1194))'.
* Generar un paquete de configuraci칩n con SID e IP del nuevo listener \(para futuros MITM\). El n칰mero de caracteres en el nombre del SID actual es de fundamental importancia. Necesitas saberlo, ya que de esto depende un paquete Bien Formado.
* A continuaci칩n, enviar todas estas golosinas al listener.
* Si todo es correcto, entonces todas las nuevas conexiones ser치n redirigidas por el listener a trav칠s de tu IP controlada.

Es importante no olvidar habilitar el proxy de consultas \(como IP\_forwarding en Linux\), de lo contrario, en lugar de un ataque MITM ordenado, obtendr치s un DoS brusco, porque los nuevos clientes no podr치n conectarse a la base de datos. Como resultado, un atacante puede incrustar sus propios comandos dentro de la sesi칩n de otro usuario. **Puedes comprobar si el servidor es vulnerable utilizando el siguiente m칩dulo de MSF: 'auxiliary/scanner/oracle/tnspoison\_checker'.**

Toda esta p치gina fue extra칤da de aqu칤: [https://hackmag.com/uncategorized/looking-into-methods-to-penetrate-oracle-db/](https://hackmag.com/uncategorized/looking-into-methods-to-penetrate-oracle-db/)

**Otra forma de probar:**
```text
./odat.py tnspoison -s <IP> -p <PORT> -d <SID> --test-module
```
<details>

<summary><strong>Aprende hacking en AWS de cero a h칠roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCI칍N**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci칩n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sigue** a **Twitter** 游냕 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
