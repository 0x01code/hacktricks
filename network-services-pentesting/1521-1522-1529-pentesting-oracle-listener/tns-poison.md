<details>

<summary><strong>从零开始学习AWS黑客技术，成为专家</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

支持HackTricks的其他方式：

* 如果您想看到您的**公司在HackTricks中做广告**或**下载PDF格式的HackTricks**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* 获取[**官方PEASS & HackTricks周边产品**](https://peass.creator-spring.com)
* 探索[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们独家的[**NFTs**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord群**](https://discord.gg/hRep4RUj7f) 或 [**电报群**](https://t.me/peass) 或 **关注**我的**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* 通过向[**HackTricks**](https://github.com/carlospolop/hacktricks)和[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。

</details>


一种名为'TNS Poison'的漏洞影响监听器的版本，最高到12c，后者只在特定配置下存在漏洞。例如，禁用监听器的动态配置是一种补救措施，在使用Oracle DataGuard、带有APEX的PL/SQL Gateway和某些SAP版本的设置中，这种补救措施是不可行的。该漏洞源自监听器服务默认支持远程配置的行为，包括匿名配置，这是漏洞的关键所在。

![https://hackmag.com/wp-content/uploads/2015/04/poison.png](https://hackmag.com/wp-content/uploads/2015/04/poison.png)

*图1展示了TNS Poison漏洞。*

攻击算法示例详见如下（参见图1）：

1. 发送TNS查询，‘CONNECT_DATA=(COMMAND=SERVICE_REGISTER_NSGR)’。
2. 响应‘(DESCRIPTION=(TMP=))’表示存在漏洞，而经过修补的服务器会响应‘(ERROR_STACK=(ERROR=1194))’。
3. 攻击者需要生成一个配置包，包括新监听器的SID和IP，旨在进行中间人攻击。当前SID名称的长度对于构建一个格式良好的包至关重要。
4. 然后将这些组件转发给监听器。
5. 成功执行后，新连接将通过监听器指向攻击者控制的IP。

激活查询代理（类似于Linux中的IP_forwarding）至关重要，以防止将潜在的中间人攻击转变为拒绝服务（DoS）攻击，这将阻止新客户端连接到数据库。此漏洞允许攻击者向另一个用户的会话中插入命令。可以使用Metasploit Framework（MSF）模块‘auxiliary/scanner/oracle/tnspoison_checker’来评估服务器的漏洞。

有关更多信息，请查看原始的[Hackmag关于Oracle数据库渗透方法的文章](https://hackmag.com/uncategorized/looking-into-methods-to-penetrate-oracle-db/)。

**替代测试方法：**
```text
./odat.py tnspoison -s <IP> -p <PORT> -d <SID> --test-module
```
<details>

<summary><strong>从零开始学习AWS黑客技术，成为专家</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

其他支持HackTricks的方式：

* 如果您想看到您的**公司在HackTricks中做广告**或**下载PDF格式的HackTricks**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* 获取[**官方PEASS & HackTricks周边产品**](https://peass.creator-spring.com)
* 探索[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFTs**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**电报群组**](https://t.me/peass) 或 **关注**我的**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* 通过向[**HackTricks**](https://github.com/carlospolop/hacktricks)和[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。

</details>
