<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- **サイバーセキュリティ企業**で働いていますか？ **HackTricksで会社を宣伝**したいですか？または、**最新バージョンのPEASSを入手したり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけてください。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。

- [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。

- [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**テレグラムグループ**](https://t.me/peass)に**参加**するか、**Twitter**で**フォロー**してください[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**。**

- **ハッキングのトリックを共有するには、[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)にPRを提出してください**。

</details>


# 外部周辺: リモートステルスパスブルートフォース

**バージョン11.1.0.6、11.1.0.7、11.2.0.1、11.2.0.2、および11.2.0.3はこのテクニックに対して脆弱です**。この脆弱性の背後にあるアイデアを理解するためには、データベースとの認証プロトコルがどのように機能するかを考慮する必要があります。バージョン11の場合、サーバーとのやり取りは次のように行われます。

1. クライアントがサーバーに接続し、ユーザー名を送信します。
2. サーバーはセッション識別子（'AUTH\_SESSKEY'）を生成し、AES-192を使用して暗号化します。システムは、ユーザーパスワードとソルト（'AUTH\_VFR\_DATA'）から生成されたSHA-1ハッシュをキーとして使用します。
3. サーバーは暗号化されたセッションIDとソルトをクライアントに送信します。
4. クライアントは、受信したソルトと自身のパスワードをハッシュ化してキーを生成します。クライアントはこのキーを使用して、サーバーから受け取ったセッションデータを復号化します。
5. 復号化されたサーバーセッションIDに基づいて、クライアントは将来の使用のために新しい公開鍵を生成します。

さて、最も興味深い部分です：サーバーからクライアントに送信されるセッションID 'AUTH\_SESSKEY'は、長さが48バイトです。そのうちの40バイトはランダムであり、最後の8バイトは '0x08' の重複です。初期化ベクトルは0x00（ヌル）です。\
公開識別子の最後の8バイトが常に '0x08' であることを知っているので、このパスワードをブルートフォース攻撃することができます。さらに、オフラインモードで行うことができます。これは非常に高速です、特にGPUを使用する場合です。攻撃を行うためには、SID、有効なログイン（たとえば、 'SYS'アカウントは非常に興味深いです）を知る必要があります。もちろん、データベースに接続する能力も必要です。この場合、Oracleの監査ログに作成される「無効なログイン試行」といったレコードはありません！

すべてをまとめると：

1. Wiresharkを使用して、**認証**中の**初期トラフィック**を**傍受**します。これには 'tns' フィルターが役立ちます。
2. **AUTH\_SESSKEY、AUTH\_VFR\_DATA** の **HEX値**を抽出します。
3. 辞書（ブルートフォース）攻撃を実行する[**PoCスクリプト**](https://www.exploit-db.com/exploits/22069)にそれらを挿入します。

## nmapとjohnを使用する
```
root@kali:~# nmap -p1521 --script oracle-brute-stealth --script-args oracle-brute-stealth.sid=DB11g -n 10.11.21.30

Starting Nmap 6.49BETA4 (https://nmap.org) at 2016-03-02 14:58 EST
Nmap scan report for 10.11.21.30
PORT     STATE SERVICE
1521/tcp open  oracle
| oracle-brute-stealth:
|   Accounts
|     SYS:$o5logon$1245C95384E15E7F0C893FCD1893D8E19078170867E892CE86DF90880E09FAD3B4832CBCFDAC1
|     A821D2EA8E3D2209DB6*4202433F49DE9AE72AE2 -
|     Hashed valid or invalid credentials
|   Statistics
|_    Performed 241 guesses in 12 seconds, average tps: 20

john hashes.txt
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- **サイバーセキュリティ会社**で働いていますか？ **HackTricksで会社を宣伝**したいですか？または、**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけてください。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。

- [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。

- [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter**で**フォロー**してください[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **ハッキングのトリックを共有するには、[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)**にPRを提出してください。

</details>
