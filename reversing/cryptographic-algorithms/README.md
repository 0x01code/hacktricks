# рдпрд╛рдЧреНрдпрд┐рдХ/рд╕рдВрдкреАрдбрди рдПрд▓реНрдЧреЛрд░рд┐рдердо

## рдпрд╛рдЧреНрдпрд┐рдХ/рд╕рдВрдкреАрдбрди рдПрд▓реНрдЧреЛрд░рд┐рдердо

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░реЗрдВ рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рд╣рдореЗрдВ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдПрд▓реНрдЧреЛрд░рд┐рдердореЛрдВ рдХреА рдкрд╣рдЪрд╛рди

рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдХреЛрдб рдореЗрдВ **рд╢рд┐рдлреНрдЯ рд░рд╛рдЗрдЯреНрд╕ рдФрд░ рд▓реЗрдлреНрдЯреНрд╕, рдЬрд╝реЛрд░реНрд╕ рдФрд░ рдХрдИ рдЕрдВрдХрдЧрдгрд┐рддреАрдп рдХрд╛рд░реНрдп** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдЙрдЪрд┐рдд рд╣реИ рдХрд┐ рдпрд╣ рдПрдХ **рдпрд╛рдЧреНрдпрд┐рдХ рдПрд▓реНрдЧреЛрд░рд┐рдердо** рдХрд╛ рдЕрдВрдХрд▓рди рд╣реИред рдпрд╣рд╛рдВ рдХреБрдЫ рддрд░реАрдХреЗ рджрд┐рдЦрд╛рдП рдЬрд╛рдПрдВрдЧреЗ **рдПрд▓реНрдЧреЛрд░рд┐рдердо рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬреЛ рдХрджрд╛рдЪрд┐рдд рдЙрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдмрд┐рдирд╛ рдкреНрд░рддреНрдпреЗрдХ рдХрджрдо рдХреЛ рдЙрд▓рдЯрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ**ред

### API рдлрд╝рдВрдХреНрд╢рди

**CryptDeriveKey**

рдпрджрд┐ рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдк **рджреВрд╕рд░реЗ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдорд╛рди рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреМрди рд╕рд╛ рдПрд▓реНрдЧреЛрд░рд┐рдердо рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ**:

![](<../../.gitbook/assets/image (375) (1) (1) (1) (1).png>)

рдпрд╣рд╛рдВ рд╕рдВрднрд╛рд╡рд┐рдд рдПрд▓реНрдЧреЛрд░рд┐рдердореЛрдВ рдФрд░ рдЙрдирдХреЗ рд╕реМрдкрд┐рддреНрд░рд┐рдд рдорд╛рдиреЛрдВ рдХреА рд╕реВрдЪреА рджреЗрдЦреЗрдВ: [https://docs.microsoft.com/en-us/windows/win32/seccrypto/alg-id](https://docs.microsoft.com/en-us/windows/win32/seccrypto/alg-id)

**RtlCompressBuffer/RtlDecompressBuffer**

рдбреЗрдЯрд╛ рдХреЗ рджрд┐рдП рдЧрдП рдмрдлрд░ рдХреЛ рд╕рдВрдкреАрдбрд┐рдд рдФрд░ рдЕрд╕рдВрдкреАрдбрд┐рдд рдХрд░рддрд╛ рд╣реИред

**CryptAcquireContext**

[рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕реЗ](https://learn.microsoft.com/en-us/windows/win32/api/wincrypt/nf-wincrypt-cryptacquirecontexta): **CryptAcquireContext** рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдпрд╛рдЧреНрдпрд┐рдХ рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ (CSP) рдХреЗ рднреАрддрд░ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдХреБрдВрдЬреА рдХрдВрдЯреЗрдирд░ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред **рдЗрд╕ рд╡рд╛рдкрд╕реА рд╣реИрдВрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреНрд░рд┐рдкреНрдЯреЛрдПрдкреАрдЖрдИ рдХреЗ рдХреЙрд▓ рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ** рдЬреЛ рдЪрдпрдирд┐рдд CSP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдлрд╝рдВрдХреНрд╢рдиред

**CryptCreateHash**

рдбреЗрдЯрд╛ рд╕реНрдЯреНрд░реАрдо рдХрд╛ рд╣реИрд╢рд┐рдВрдЧ рдкреНрд░рд╛рд░рдВрдн рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдк **рджреВрд╕рд░реЗ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдорд╛рди рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреМрди рд╕рд╛ рдПрд▓реНрдЧреЛрд░рд┐рдердо рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ**:

![](<../../.gitbook/assets/image (376).png>)

\
рдпрд╣рд╛рдВ рд╕рдВрднрд╛рд╡рд┐рдд рдПрд▓реНрдЧреЛрд░рд┐рдердореЛрдВ рдФрд░ рдЙрдирдХреЗ рд╕реМрдкрд┐рддреНрд░рд┐рдд рдорд╛рдиреЛрдВ рдХреА рд╕реВрдЪреА рджреЗрдЦреЗрдВ: [https://docs.microsoft.com/en-us/windows/win32/seccrypto/alg-id](https://docs.microsoft.com/en-us/windows/win32/seccrypto/alg-id)

### рдХреЛрдб рд╕реНрдерд┐рд░

рдХрднреА-рдХрднреА рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдФрд░ рдЕрджреНрд╡рд┐рддреАрдп рдорд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдиреЗ рдХреЗ рдХрд╛рд░рдг рдПрдХ рдПрд▓реНрдЧреЛрд░рд┐рдердо рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЖрд╕рд╛рди рд╣реЛрддрд╛ рд╣реИред

![](<../../.gitbook/assets/image (370).png>)

рдпрджрд┐ рдЖрдк рдкрд╣рд▓реЗ рд╕реНрдерд┐рд░ рдХреЛрдгреНрд╕реНрдЯреЗрдВрдЯ рдХреА рдЦреЛрдЬ рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдЖрдкрдХреЛ рдпрд╣ рдорд┐рд▓рддрд╛ рд╣реИ:

![](<../../.gitbook/assets/image (371).png>)

рдЗрд╕рд▓рд┐рдП, рдЖрдк рдорд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдбрд┐рдХреЙрдореНрдкрд╛рдЗрд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдлрд╝рдВрдХреНрд╢рди рдПрдХ **sha256 рдХреИрд▓рдХреБрд▓реЗрдЯрд░ рд╣реИ**ред\
рдЖрдк рдЕрдиреНрдп рд╕реНрдерд┐рд░реЛрдВ рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рднреА рдХреЛ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЖрдкрдХреЛ (рд╕рдВрднрд╛рд╡рд┐рдд рд╣реИ) рдПрдХ рд╣реА рдкрд░рд┐рдгрд╛рдо рдорд┐рд▓реЗрдЧрд╛ред

### рдбреЗрдЯрд╛ рд╕реВрдЪрдирд╛

рдпрджрд┐ рдХреЛрдб рдореЗрдВ рдХреЛрдИ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реНрдерд┐рд░ рдирд╣реАрдВ рд╣реИ рддреЛ рдпрд╣ **.рдбреЗрдЯрд╛ рдЦрдВрдб рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рд▓реЛрдб рдХрд░ рд░рд╣рд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ**ред\
рдЖрдк рдЙрд╕ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ, **рдкрд╣рд▓реЗ рдбрдмрд▓ рд╡рд░реНрдб рдХреЛ рд╕рдореВрд╣рд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕реЗ рдЧреВрдЧрд▓ рдореЗрдВ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ рдкрд╣рд▓реЗ рдЦрдВрдб рдореЗрдВ рдХрд┐рдпрд╛ рд╣реИ:

![](<../../.gitbook/assets/image (372).png>)

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрджрд┐ рдЖрдк **0xA56363C6** рдХреА рдЦреЛрдЬ рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдЖрдкрдХреЛ рдкрд╛рддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ **AES рдПрд▓реНрдЧреЛрд░рд┐рдердо рдХреЗ рддрд╛рд▓рд┐рдХрд╛рдУрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИ**ред

## RC4 **(рд╕рдордорд┐рддреНрд░ рдпрд╛рдЧреНрдпрд┐рдХ)**

### рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ

рдЗрд╕рдореЗрдВ 3 рдореБрдЦреНрдп рднрд╛рдЧ рд╣реЛрддреЗ рд╣реИрдВ:

* **рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЪрд░рдг/**: 0x00 рд╕реЗ 0xFF (рдХреБрд▓ 256 рдмрд╛рдЗрдЯ, 0x100) рддрдХ рдХреЗ рдорд╛рдиреЛрдВ рдХреА рдПрдХ **рддрд╛рд▓рд┐рдХрд╛ рдмрдирд╛рддрд╛ рд╣реИ**ред рдЗрд╕ рддрд╛рд▓рд┐рдХрд╛ рдХреЛ рд╕рд╛рдорд╛рдиреНрдпрдд: **рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рдмреЙрдХреНрд╕** (рдпрд╛ SBox) рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред
* **рдЙрд▓рдЭрдиреЗ рдХрд╛ рдЪрд░рдг**: рдкрд╣рд▓реЗ рдмрдирд╛рдИ рдЧрдИ рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реВрдк рдХрд░реЗрдЧрд╛ (рдлрд┐рд░ 0x100 рдмрд╛рд░ рдХрд╛ рд▓реВрдк, рдлрд┐рд░ рд╕реЗ) рд╣рд░ рдорд╛рди рдХреЛ **рдЖрдВрд╢рд┐рдХ-рд░реИрдВрдбрдо** рдмрд╛рдЗрдЯ рдХреЗ рд╕рд╛рде рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдЧрд╛ред рдЗрд╕ рдЖрдВрд╢рд┐рдХ-рд░реИрдВрдбрдо рдмрд╛рдЗрдЯреНрд╕ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, RC4 **рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред RC4 **рдХреБрдВрдЬрд┐рдпрд╛рдБ** **1 рд╕реЗ 256 рдмрд╛рдЗрдЯ рддрдХ рдХреА рд╣реЛ рд╕рдХрддреА рд╣реИрдВ**, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЖрдорддреМрд░ рдкрд░ рдпрд╣ рд╕реБрдЭрд╛рд╡ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ 5 рдмрд╛рдЗрдЯ рд╕реЗ рдКрдкрд░ рд╣реЛред рд╕рд╛рдорд╛рдиреНрдпрдд: RC4 рдХреБрдВрдЬрд┐рдпрд╛рдБ 16 рдмрд╛рдЗрдЯ рд▓рдВрдмреА рд╣реЛрддреА рд╣реИрдВред
* **XOR рдЪрд░рдг**: рдЕрдВрдд рдореЗрдВ, рд╕рд╛рджрд╛-рдкрд╛рда рдпрд╛ рд╕рд╛рдЗрдлрд░рдЯреЗрдХреНрд╕реНрдЯ рдХреЛ **рдкрд╣рд▓реЗ рдмрдирд╛рдП рдЧрдП рдорд╛рдиреЛрдВ рдХреЗ рд╕рд╛рде XOR** рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдбреЗрдЯрд╛ рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╣реА рдлрд╝рдВрдХреНрд╢рди рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рд▓рд┐рдП, рдмрдирд╛рдП рдЧрдП 256 рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рд▓реВрдк рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд┐рддрдиреА рдмрд╛рд░ рдЬрд░реВрд░реА рд╣реЛрдЧрд╛ рдЙрддрдиреА рдмрд╛рд░ рдЪрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдЗрд╕реЗ рдЖрдорддреМрд░ рдкрд░ рдПрдХ рдбрд┐рдХреЙрдореНрдкрд╛рдЗрд▓ рдХреЛрдб рдореЗрдВ **%256 (рдореЙрдб 256)** рдХреЗ рд╕рд╛рде рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред

{% hint style="info" %}
**рдПрдХ RC4 рдХреЛ рдПрдХ рдбрд┐рд╕рдПрд╕реЗрдВрдмрд▓реА/рдбрд┐рдХреЙрдореНрдкрд╛рдЗрд▓ рдХреЛрдб рдореЗрдВ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк 0x100 рдХреЗ рдЖрдХрд╛рд░ рдХреЗ 2 рд▓реВрдкреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ) рдФрд░ рдлрд┐рд░ 256 рдорд╛рдиреЛрдВ рдХреЗ рд╕рд╛рде рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рдХрд╛ XOR рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдкрд╣рд▓реЗ 2 рд▓реВрдкреЛрдВ рдореЗрдВ рдмрдирд╛рдП рдЧрдП рд╣реЛрдВрдЧреЗ, рд╢рд╛рдпрдж %256 (рдореЙрдб 256) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ**
{% endhint %}

### **рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЪрд░рдг/рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рдмреЙрдХреНрд╕:** (рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЧрд┐рдирддреА рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП 256 рдирдВрдмрд░ рдФрд░ рдХреИрд╕реЗ 256 рд╡рд░реНрдгреЛрдВ рдХреЗ рд╣рд░ рд╕реНрдерд╛рди рдкрд░ 0 рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ)

![](<../../.gitbook/assets/image (377).png>)

### **рдЙрд▓рдЭрдиреЗ рдХрд╛ рдЪрд░рдг:**

![](<../../.gitbook/assets/image (378).png>)

### **XOR рдЪрд░рдг:**

![](<../../.gitbook/assets/image (379).png>)

## **AES (рд╕рдордорд┐рддреНрд░ рдпрд╛рдЧреНрдпрд┐рдХ)**

### **рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ**

* **рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рдмреЙрдХреНрд╕ рдФрд░ рд▓реБрдХрдЕрдк рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ**
* рд╡рд┐рд╢рд┐рд╖реНрдЯ рд▓реБрдХрдЕрдк рддрд╛рд▓рд┐рдХрд╛ рдорд╛рдиреЛрдВ (рд╕реНрдерд┐рд░) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдХрд╛рд░рдг **AES рдХреЛ рдкрд╣рдЪрд╛рдирдирд╛ рд╕рдВрднрд╡ рд╣
