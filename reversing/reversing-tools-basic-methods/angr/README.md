<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЪрд╛рд╣рд┐рдП? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рдЬреБрдбрд╝реЗрдВ** рдпрд╛ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>


# рд╕реНрдерд╛рдкрдирд╛
```bash
sudo apt-get install python3-dev libffi-dev build-essential
python3 -m pip install --user virtualenv
python3 -m venv ang
source ang/bin/activate
pip install angr
```
# рдореВрд▓рднреВрдд рдХрд╛рд░реНрд░рд╡рд╛рдИ

## Introduction
## рдкрд░рд┐рдЪрдп

This section provides an overview of the basic actions that can be performed using angr.

рдЗрд╕ рдЦрдВрдб рдореЗрдВ рдПрдирдЧреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдП рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рдореВрд▓рднреВрдд рдХрд╛рд░реНрд░рд╡рд╛рдЗрдпреЛрдВ рдХрд╛ рдЕрд╡рд▓реЛрдХрди рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

## Loading a Binary
## рдПрдХ рдмрд╛рдЗрдирд░реА рд▓реЛрдб рдХрд░рдирд╛

To analyze a binary using angr, you first need to load the binary into an angr project.

angr рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдмрд╛рдЗрдирд░реА рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдкрд╣рд▓реЗ рдПрдХ рдПрдирдЧреНрд░ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореЗрдВ рдмрд╛рдЗрдирд░реА рд▓реЛрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

```python
import angr

project = angr.Project("/path/to/binary")
```

## Finding Entry Point
## рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ рдЦреЛрдЬрдирд╛

The entry point of a binary is the address where the execution of the program starts. You can find the entry point using the `entry` attribute of the angr project.

рдПрдХ рдмрд╛рдЗрдирд░реА рдХрд╛ рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреА рд╢реБрд░реБрдЖрдд рд╣реЛрддреА рд╣реИ рдЬрд╣рд╛рдВ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИред рдЖрдк рдПрдирдЧреНрд░ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЗ `entry` рдЧреБрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВред

```python
entry_point = project.entry
```

## Exploring the Control Flow Graph (CFG)
## рдирд┐рдпрдВрддреНрд░рдг рдлрд╝реНрд▓реЛ рдЧреНрд░рд╛рдлрд╝ (CFG) рдХрд╛ рдЕрдиреНрд╡реЗрд╖рдг рдХрд░рдирд╛

The Control Flow Graph (CFG) represents the flow of execution within a binary. You can explore the CFG using the `cfg` attribute of the angr project.

рдирд┐рдпрдВрддреНрд░рдг рдлрд╝реНрд▓реЛ рдЧреНрд░рд╛рдлрд╝ (CFG) рдПрдХ рдмрд╛рдЗрдирд░реА рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдлрд╝реНрд▓реЛ рдХреЛ рдкреНрд░рддрд┐рд╖реНрдард┐рдд рдХрд░рддрд╛ рд╣реИред рдЖрдк рдПрдирдЧреНрд░ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЗ `cfg` рдЧреБрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ CFG рдХрд╛ рдЕрдиреНрд╡реЗрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

```python
cfg = project.analyses.CFG()
```

## Finding Functions
## рдлрд╝рдВрдХреНрд╢рди рдЦреЛрдЬрдирд╛

To find the functions present in a binary, you can use the `functions` attribute of the angr project.

рдПрдХ рдмрд╛рдЗрдирд░реА рдореЗрдВ рдореМрдЬреВрдж рдлрд╝рдВрдХреНрд╢рдиреНрд╕ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдПрдирдЧреНрд░ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЗ `functions` рдЧреБрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

```python
functions = project.kb.functions
```

## Symbolic Execution
## рдкреНрд░рддреАрдХрд╛рддреНрдордХ рдирд┐рд╖реНрдкрд╛рджрди

Symbolic execution is a technique used to explore all possible paths of execution within a binary. You can perform symbolic execution using the `explorer` attribute of the angr project.

рдкреНрд░рддреАрдХрд╛рддреНрдордХ рдирд┐рд╖реНрдкрд╛рджрди рдПрдХ рддрдХрдиреАрдХ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдмрд╛рдЗрдирд░реА рдХреЗ рднреАрддрд░ рд╕рднреА рд╕рдВрднрд╛рд╡рд┐рдд рдкрдереЛрдВ рдХрд╛ рдЕрдиреНрд╡реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЖрдк рдПрдирдЧреНрд░ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЗ `explorer` рдЧреБрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рддреАрдХрд╛рддреНрдордХ рдирд┐рд╖реНрдкрд╛рджрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

```python
explorer = project.surveyors.Explorer(start=entry_point, find=[target_address])
explorer.run()
```

## Conclusion
## рдирд┐рд╖реНрдХрд░реНрд╖

These are some of the basic actions that can be performed using angr. By understanding and utilizing these actions, you can effectively analyze and explore binaries using angr.

рдпреЗ рдХреБрдЫ рдореВрд▓рднреВрдд рдХрд╛рд░реНрд░рд╡рд╛рдЗрдпрд╛рдБ рд╣реИрдВ рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдирдЧреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрди рдХрд╛рд░реНрд░рд╡рд╛рдЗрдпреЛрдВ рдХреЛ рд╕рдордЭрдХрд░ рдФрд░ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдк рдПрдирдЧреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрд╛рдЗрдирд░реА рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдФрд░ рдЕрдиреНрд╡реЗрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```python
import angr
import monkeyhex # this will format numerical results in hexadecimal
#Load binary
proj = angr.Project('/bin/true')

#BASIC BINARY DATA
proj.arch #Get arch "<Arch AMD64 (LE)>"
proj.arch.name #'AMD64'
proj.arch.memory_endness #'Iend_LE'
proj.entry #Get entrypoint "0x4023c0"
proj.filename #Get filename "/bin/true"

#There are specific options to load binaries
#Usually you won't need to use them but you could
angr.Project('examples/fauxware/fauxware', main_opts={'backend': 'blob', 'arch': 'i386'}, lib_opts={'libc.so.6': {'backend': 'elf'}})
```
# рд▓реЛрдб рдХреА рдЧрдИ рдбреЗрдЯрд╛

## Main object information

## рдореБрдЦреНрдп рдСрдмреНрдЬреЗрдХреНрдЯ рдХреА рдЬрд╛рдирдХрд╛рд░реА
```python
#LOADED DATA
proj.loader #<Loaded true, maps [0x400000:0x5004000]>
proj.loader.min_addr #0x400000
proj.loader.max_addr #0x5004000
proj.loader.all_objects #All loaded
proj.loader.shared_objects #Loaded binaries
"""
OrderedDict([('true', <ELF Object true, maps [0x400000:0x40a377]>),
('libc.so.6',
<ELF Object libc-2.31.so, maps [0x500000:0x6c4507]>),
('ld-linux-x86-64.so.2',
<ELF Object ld-2.31.so, maps [0x700000:0x72c177]>),
('extern-address space',
<ExternObject Object cle##externs, maps [0x800000:0x87ffff]>),
('cle##tls',
<ELFTLSObjectV2 Object cle##tls, maps [0x900000:0x91500f]>)])
"""
proj.loader.all_elf_objects #Get all ELF objects loaded (Linux)
proj.loader.all_pe_objects #Get all binaries loaded (Windows)
proj.loader.find_object_containing(0x400000)#Get object loaded in an address "<ELF Object fauxware, maps [0x400000:0x60105f]>"
```
## рдореБрдЦреНрдп рдЙрджреНрджреЗрд╢реНрдп

The main objective of this document is to provide an introduction to the angr framework and its basic usage. This document will cover the installation process, basic concepts, and common use cases of angr. By the end of this document, you should have a good understanding of how to use angr for binary analysis and reverse engineering tasks.
```python
#Main Object (main binary loaded)
obj = proj.loader.main_object #<ELF Object true, maps [0x400000:0x60721f]>
obj.execstack #"False" Check for executable stack
obj.pic #"True" Check PIC
obj.imports #Get imports
obj.segments #<Regions: [<ELFSegment flags=0x5, relro=0x0, vaddr=0x400000, memsize=0xa74, filesize=0xa74, offset=0x0>, <ELFSegment flags=0x4, relro=0x1, vaddr=0x600e28, memsize=0x1d8, filesize=0x1d8, offset=0xe28>, <ELFSegment flags=0x6, relro=0x0, vaddr=0x601000, memsize=0x60, filesize=0x50, offset=0x1000>]>
obj.find_segment_containing(obj.entry) #Get segment by address
obj.sections #<Regions: [<Unnamed | offset 0x0, vaddr 0x0, size 0x0>, <.interp | offset 0x238, vaddr 0x400238, size 0x1c>, <.note.ABI-tag | offset 0x254, vaddr 0x400254, size 0x20>, <.note.gnu.build-id ...
obj.find_section_containing(obj.entry) #Get section by address
obj.plt['strcmp'] #Get plt address of a funcion (0x400550)
obj.reverse_plt[0x400550] #Get function from plt address ('strcmp')
```
## рдкреНрд░рддреАрдХ рдФрд░ рдкреБрдирд░реНрд╕реНрдерд╛рдкрдирд╛

Symbols and relocations are important concepts in reverse engineering and binary analysis. They play a crucial role in understanding and manipulating the behavior of a binary executable.

рдкреНрд░рддреАрдХ рдФрд░ рдкреБрдирд░реНрд╕реНрдерд╛рдкрдирд╛, рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдФрд░ рдмрд╛рдЗрдирд░реА рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЕрд╡рдзрд╛рд░рдгрд╛рдПрдВ рд╣реИрдВред рдпреЗ рдПрдХ рдмрд╛рдЗрдирд░реА рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рд╕рдордЭрдиреЗ рдФрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рднреВрдорд┐рдХрд╛ рдирд┐рднрд╛рддреЗ рд╣реИрдВред

### Symbols

рдкреНрд░рддреАрдХ (symbols) рдмрд╛рдЗрдирд░реА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рд╡рд╕реНрддреБрдУрдВ рдХреЛ рдкреНрд░рддрд┐рд╖реНрдард┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ рдлрд╝рдВрдХреНрд╢рди, рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕, рдпрд╛ рдЕрдиреНрдп рд╕рдВрдЧрдардирд╛рддреНрдордХ рдпреВрдирд┐рдЯреНрд╕ред рдкреНрд░рддреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдмрд╛рдЗрдирд░реА рдХреЛрдб рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╣рд┐рд╕реНрд╕реЛрдВ рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдФрд░ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдкреНрд░рддреАрдХреЛрдВ рдХреЛ рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЛрдВ рд╕реЗ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рд▓реЗрдмрд▓, рд╕рдВрдХреЗрдд, рдпрд╛ рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЗ рдирд╛рдоред

### Relocations

рдкреБрдирд░реНрд╕реНрдерд╛рдкрдирд╛ (relocations) рдмрд╛рдЗрдирд░реА рдХреЛрдб рдореЗрдВ рд╕рдВрд╢реЛрдзрди рдХрд░рддреА рд╣реИрдВ рддрд╛рдХрд┐ рдЙрд╕реЗ рдЕрдиреНрдп рд╡рд┐рднрд┐рдиреНрди рдкрддреЛрдВ рдкрд░ рд╕рдВрджрд░реНрднрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЬрдм рдПрдХ рдмрд╛рдЗрдирд░реА рдХреЛрдб рдХреЛ рд▓рд┐рдВрдХ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрдирд╛ рдПрдВрдЯреНрд░реАрдЬрд╝ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИрдВ рдЬреЛ рдмрд╛рдЗрдирд░реА рдХреЛрдб рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╕реЗрдХреНрд╢рдиреНрд╕ рдХреЛ рдЕрдиреНрдп рд╕рдВрджрд░реНрднрд┐рдд рдкрддреЛрдВ рдкрд░ рд▓реЗ рдЬрд╛рддреА рд╣реИрдВред рдкреБрдирд░реНрд╕реНрдерд╛рдкрдирд╛ рдПрдВрдЯреНрд░реАрдЬрд╝ рдХреЗ рджреНрд╡рд╛рд░рд╛, рдмрд╛рдЗрдирд░реА рдХреЛрдб рдХреЛ рдЕрдиреНрдп рд╡рд╕реНрддреБрдУрдВ рдХреЗ рд╕рд╛рде рд╕рдВрдмрдВрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдлрд╝рдВрдХреНрд╢рдиреНрд╕ рдпрд╛ рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ред

рдкреБрдирд░реНрд╕реНрдерд╛рдкрдирд╛ рдПрдВрдЯреНрд░реАрдЬрд╝ рдХреЛ рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЛрдВ рд╕реЗ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдкреБрдирд░реНрд╕реНрдерд╛рдкрдирд╛ рдЯреЗрдмрд▓, рдкреБрдирд░реНрд╕реНрдерд╛рдкрдирд╛ рдмреНрд▓реЙрдХ, рдпрд╛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрдирд╛ рдПрдВрдЯреНрд░реАрдЬрд╝ рдХреЗ рдСрдлрд╝рд╕реЗрдЯред

рдпрд╣ рдЬрд╛рдирдирд╛ рдХрд┐ рдкреНрд░рддреАрдХ рдФрд░ рдкреБрдирд░реНрд╕реНрдерд╛рдкрдирд╛ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ рдмрд╛рдЗрдирд░реА рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ рдХреЛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдФрд░ рдЙрд╕реЗ рдорд╛рдирд╡-рдкрдардиреАрдп рд░реВрдк рдореЗрдВ рд╕рдордЭрдиреЗ рдореЗрдВ рдорджрдж рдХрд░реЗрдЧрд╛ред
```python
strcmp = proj.loader.find_symbol('strcmp') #<Symbol "strcmp" in libc.so.6 at 0x1089cd0>

strcmp.name #'strcmp'
strcmp.owne #<ELF Object libc-2.23.so, maps [0x1000000:0x13c999f]>
strcmp.rebased_addr #0x1089cd0
strcmp.linked_addr #0x89cd0
strcmp.relative_addr #0x89cd0
strcmp.is_export #True, as 'strcmp' is a function exported by libc

#Get strcmp from the main object
main_strcmp = proj.loader.main_object.get_symbol('strcmp')
main_strcmp.is_export #False
main_strcmp.is_import #True
main_strcmp.resolvedby #<Symbol "strcmp" in libc.so.6 at 0x1089cd0>
```
## рдЦрдВрдб

Blocks are the basic units of code in the angr framework. A block represents a sequence of instructions that are executed sequentially without any branching or jumping. Each block starts at a specific address and ends at the address of the next block or at a branch instruction.

рдЦрдВрдб рдЕрдВрдЧреНрд░ рдлреНрд░реЗрдорд╡рд░реНрдХ рдореЗрдВ рдХреЛрдб рдХреА рдореВрд▓ рдЗрдХрд╛рдЗрдпрд╛рдВ рд╣реИрдВред рдПрдХ рдЦрдВрдб рдПрдХ рдРрд╕реА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЛ рдкреНрд░рддрд┐рд╖реНрдард┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдХреЛрдИ рд╢рд╛рдЦрд╛ рдпрд╛ рдЬрдВрдкрд┐рдВрдЧ рдХреЗ рдмрд┐рдирд╛ рдХреНрд░рдорд╢рдГ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдирд┐рд░реНрджреЗрд╢ рд╣реЛрддреЗ рд╣реИрдВред рдкреНрд░рддреНрдпреЗрдХ рдЦрдВрдб рдПрдХ рд╡рд┐рд╢реЗрд╖ рдкрддреЗ рдкрд░ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЕрдЧрд▓реЗ рдЦрдВрдб рдХреЗ рдкрддреЗ рдпрд╛ рдПрдХ рд╢рд╛рдЦрд╛ рдирд┐рд░реНрджреЗрд╢ рдкрд░ рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред

## Basic Block

A basic block is a block that has no branches or jumps within it. It starts at a specific address and ends at the address of the next block or at a branch instruction.

рдПрдХ рдореВрд▓ рдЦрдВрдб рдПрдХ рдРрд╕рд╛ рдЦрдВрдб рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЗрд╕рдХреЗ рднреАрддрд░ рдХреЛрдИ рд╢рд╛рдЦрд╛ рдпрд╛ рдЬрдВрдк рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдкрддреЗ рдкрд░ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЕрдЧрд▓реЗ рдЦрдВрдб рдХреЗ рдкрддреЗ рдпрд╛ рдПрдХ рд╢рд╛рдЦрд╛ рдирд┐рд░реНрджреЗрд╢ рдкрд░ рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред

## Control Flow Graph (CFG)

A Control Flow Graph (CFG) is a graphical representation of a program's control flow. It consists of nodes that represent basic blocks and edges that represent the flow of control between these blocks. The CFG provides a high-level view of how a program executes and can be useful for understanding the program's behavior and identifying potential vulnerabilities.

рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рд╡рд╛рд╣ рдЧреНрд░рд╛рдл (CFG) рдПрдХ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рд╡рд╛рд╣ рдХрд╛ рдЧреНрд░рд╛рдлрд┐рдХрд▓ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рд╣реИред рдЗрд╕рдореЗрдВ рдореВрд▓ рдЦрдВрдбреЛрдВ рдХреЛ рдкреНрд░рддрд┐рд╖реНрдард┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдиреЛрдб рдФрд░ рдЗрди рдЦрдВрдбреЛрдВ рдХреЗ рдмреАрдЪ рдирд┐рдпрдВрддреНрд░рдг рдХреЗ рдкреНрд░рд╡рд╛рд╣ рдХреЛ рдкреНрд░рддрд┐рд╖реНрдард┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдПрдЬ рд╣реЛрддреЗ рд╣реИрдВред CFG рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХрд╛ рдПрдХ рдЙрдЪреНрдЪ рд╕реНрддрд░реАрдп рджреГрд╖реНрдЯрд┐рдХреЛрдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рд╕рдордЭрдиреЗ рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рдЦрддрд░реЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

## Symbolic Execution

Symbolic execution is a technique used in program analysis to explore all possible paths of execution by representing program inputs symbolically rather than concretely. It allows for the automatic generation of test cases and can be used to identify vulnerabilities such as buffer overflows and SQL injection.

рдкреНрд░рддреАрдХрд╛рддреНрдордХ рдирд┐рд╖реНрдкрд╛рджрди рдХрд╛рд░реНрдпрдХреНрд░рдо рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдореЗрдВ рдПрдХ рддрдХрдиреАрдХ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд╛рд░реНрдпрдХреНрд░рдо рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд╕рднреА рд╕рдВрднрд╛рд╡рд┐рдд рдорд╛рд░реНрдЧреЛрдВ рдХрд╛ рдЕрдиреНрд╡реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд╣рд╛рдВ рдХрд╛рд░реНрдпрдХреНрд░рдо рдЗрдирдкреБрдЯ рдХреЛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд░реВрдк рд╕реЗ рдирд╣реАрдВ рдмрд▓реНрдХрд┐ рдкреНрд░рддреАрдХрд╛рддреНрдордХ рд░реВрдк рд╕реЗ рдкреНрд░рддрд┐рд╖реНрдард┐рдд рдХрд░рдХреЗ рдкреНрд░рддрд┐рд╖реНрдард┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕рд╕реЗ рдкрд░реАрдХреНрд╖рдг рдХреЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрддреНрдкрд╛рджрди рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ рдФрд░ SQL рдЗрдВрдЬреЗрдХреНрд╢рди рдЬреИрд╕реА рд╕реБрд░рдХреНрд╖рд╛ рдХреА рдХрдорд┐рдпреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

## Constraint Solver

A constraint solver is a tool used in symbolic execution to solve constraints that arise from symbolic representations of program inputs. It takes these constraints as input and computes possible solutions that satisfy the constraints. Constraint solvers are used in various applications, including program analysis, software verification, and automated testing.

рдПрдХ рдирд┐рдмрдВрдзрдХ рд╕рдорд╛рдзрд╛рдирдХрд░реНрддрд╛ рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ рдЬрд┐рд╕рдХрд╛ рдкреНрд░рддреАрдХрд╛рддреНрдордХ рдирд┐рд╖реНрдкрд╛рджрди рдореЗрдВ рдЙрддреНрдкрдиреНрди рдирд┐рдмрдВрдзрдХ рдкреНрд░рддрд┐рд╖реНрдард╛рдиреЛрдВ рд╕реЗ рдЙрддреНрдкрдиреНрди рдирд┐рдмрдВрдзрдХреЛрдВ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдЗрди рдирд┐рдмрдВрдзрдХреЛрдВ рдХреЛ рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЗрддрд╛ рд╣реИ рдФрд░ рдЗрди рдирд┐рдмрдВрдзрдХреЛрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрднрд╛рд╡рд┐рдд рд╕рдорд╛рдзрд╛рдиреЛрдВ рдХреА рдЧрдгрдирд╛ рдХрд░рддрд╛ рд╣реИред рдирд┐рдмрдВрдзрдХ рд╕рдорд╛рдзрд╛рдирдХрд░реНрддрд╛ рдХрдИ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рд╣реЛрддреЗ рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рдХрд╛рд░реНрдпрдХреНрд░рдо рд╡рд┐рд╢реНрд▓реЗрд╖рдг, рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд╕рддреНрдпрд╛рдкрди рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдкрд░реАрдХреНрд╖рдг рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
```python
#Blocks
block = proj.factory.block(proj.entry) #Get the block of the entrypoint fo the binary
block.pp() #Print disassembly of the block
block.instructions #"0xb" Get number of instructions
block.instruction_addrs #Get instructions addresses "[0x401670, 0x401672, 0x401675, 0x401676, 0x401679, 0x40167d, 0x40167e, 0x40167f, 0x401686, 0x40168d, 0x401694]"
```
# рд╕рд┐рдореБрд▓реЗрд╢рди рдкреНрд░рдмрдВрдзрдХ, рд╕реНрдерд┐рддрд┐рдпрд╛рдБ

рдПрдирдЬреАрдЖрд░ рдХреЗ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдлреАрдЪрд░ рд╣реИ рд╕рд┐рдореБрд▓реЗрд╢рди рдкреНрд░рдмрдВрдзрдХред рдпрд╣ рдПрдХ рдЙрдЪреНрдЪ рд╕реНрддрд░реАрдп рдЯреВрд▓ рд╣реИ рдЬреЛ рдПрдирдЬреАрдЖрд░ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рд╕реБрд▓рдн рдмрдирд╛рддрд╛ рд╣реИред рд╕рд┐рдореБрд▓реЗрд╢рди рдкреНрд░рдмрдВрдзрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рдЖрдк рдПрдирдЬреАрдЖрд░ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЛ рдирд┐рд░реНрдорд╛рдг, рдкреНрд░рдмрдВрдзрд┐рдд рдФрд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдПрдирдЬреАрдЖрд░ рдореЗрдВ, рд╣рд░ рд╕реНрдерд┐рддрд┐ рдПрдХ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рдореЗрдВ рдкреНрд░рддрд┐рд╖реНрдард┐рдд рд╣реЛрддреА рд╣реИ рдФрд░ рдПрдХ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЖрдкрдХреЗ рдкрд╛рд╕ рд╡рд┐рднрд┐рдиреНрди рдбреЗрдЯрд╛, рд░рдЪрдирд╛рдПрдБ рдФрд░ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ рд╣реЛрддреА рд╣реИрдВред рдЖрдк рд╕рд┐рдореБрд▓реЗрд╢рди рдкреНрд░рдмрдВрдзрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╕реНрдерд┐рддрд┐ рдХреЛ рдирд┐рд░реНрдорд╛рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрд╕реЗ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рд╕рд┐рдореБрд▓реЗрд╢рди рдкреНрд░рдмрдВрдзрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рдЖрдк рдПрдирдЬреАрдЖрд░ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рдкреНрд░рд╡реЗрд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рдПрдХ рд╕реНрдерд┐рддрд┐ рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрд╕реЗ рд░реАрд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕реЗ рд╡рд╛рдкрд╕ рд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЖрдк рд╕рд┐рдореБрд▓реЗрд╢рди рдкреНрд░рдмрдВрдзрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡рд┐рднрд┐рдиреНрди рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рдбреЗрдЯрд╛ рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рд╕рд┐рдореБрд▓реЗрд╢рди рдкреНрд░рдмрдВрдзрдХ рдЖрдкрдХреЛ рдПрдирдЬреАрдЖрд░ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ рдЕрдзрд┐рдХ рд╕реБрд▓рдн рдмрдирд╛рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЖрдкрдХреЛ рдЕрдзрд┐рдХ рдЙрдЪреНрдЪ рд╕реНрддрд░реАрдп рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдпрд╣ рдЖрдкрдХреЛ рдЕрдкрдиреЗ рдПрдирдЬреАрдЖрд░ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЛ рдЕрдзрд┐рдХ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИред
```python
#Live States
#This is useful to modify content in a live analysis
state = proj.factory.entry_state()
state.regs.rip #Get the RIP
state.mem[proj.entry].int.resolved #Resolve as a C int (BV)
state.mem[proj.entry].int.concreteved #Resolve as python int
state.regs.rsi = state.solver.BVV(3, 64) #Modify RIP
state.mem[0x1000].long = 4 #Modify mem

#Other States
project.factory.entry_state()
project.factory.blank_state() #Most of its data left uninitialized
project.factory.full_init_statetate() #Execute through any initializers that need to be run before the main binary's entry point
project.factory.call_state() #Ready to execute a given function.

#Simulation manager
#The simulation manager stores all the states across the execution of the binary
simgr = proj.factory.simulation_manager(state) #Start
simgr.step() #Execute one step
simgr.active[0].regs.rip #Get RIP from the last state
```
## рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛

* рдЖрдк `args` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рддрд╛рд▓рд┐рдХрд╛ рдФрд░ `env` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░реЛрдВ рдХреА рдбрд┐рдХреНрд╢рдирд░реА рдХреЛ `entry_state` рдФрд░ `full_init_state` рдореЗрдВ рдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрди рд╕рдВрд░рдЪрдирд╛рдУрдВ рдореЗрдВ рдореВрд▓реНрдп рд╕реНрдЯреНрд░рд┐рдВрдЧ рдпрд╛ рдмрд┐рдЯрд╡реЗрдХреНрдЯрд░ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдЗрдиреНрд╣реЗрдВ рд╕реНрдЯреЗрдЯ рдореЗрдВ рдЖрд░реНрдЧреНрдпреВрдореЗрдВрдЯреНрд╕ рдФрд░ рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рд╕реАрдорд┐рдд рдирдХрд▓реА рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдбрд┐рдлрд╝реЙрд▓реНрдЯ `args` рдПрдХ рдЦрд╛рд▓реА рд╕реВрдЪреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдЖрдк рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░ рд░рд╣реЗ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЛ рдХрдо рд╕реЗ рдХрдо рдПрдХ `argv[0]` рдвреВрдВрдврд╝рдиреЗ рдХреА рдЙрдореНрдореАрдж рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рд╣рдореЗрд╢рд╛ рдЙрд╕реЗ рдкреНрд░рджрд╛рди рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП!
* рдпрджрд┐ рдЖрдк `argc` рдХреЛ рд╕рдВрдХреЗрддрд╛рддреНрдордХ рдмрд┐рдЯрд╡реЗрдХреНрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк `entry_state` рдФрд░ `full_init_state` рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдХреЗ рд▓рд┐рдП `argc` рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рд╕рдВрдХреЗрддрд╛рддреНрдордХ рдмрд┐рдЯрд╡реЗрдХреНрдЯрд░ рдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╕рддрд░реНрдХ рд░рд╣реЗрдВ: рдпрджрд┐ рдЖрдк рдРрд╕рд╛ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдЙрд╕ рд╕реНрдерд┐рддрд┐ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реАрдорд╛ рдЬреЛрдбрд╝рдиреА рдЪрд╛рд╣рд┐рдП рдХрд┐ рдЖрдкрдХреЗ рд▓рд┐рдП argc рдХрд╛ рдорд╛рди рдЖрдкрдХреЗ `args` рдореЗрдВ рдкрд╛рд╕ рдХрд┐рдП рдЧрдП рдЖрд░реНрдЧреНрдпреВрдореЗрдВрдЯреНрд╕ рд╕реЗ рдЕрдзрд┐рдХ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
* рдХреЙрд▓ рд╕реНрдЯреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдЗрд╕реЗ `.call_state(addr, arg1, arg2, ...)` рдХреЗ рд╕рд╛рде рдХреЙрд▓ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрд╣рд╛рдВ `addr` рд╡рд╣ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдЖрдк рдХреЙрд▓ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдФрд░ `argN` рдЙрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЗ Nth рдЖрд░реНрдЧреНрдпреВрдореЗрдВрдЯ рдХреЛ рдкрд╛рдпрдерди рдЗрдВрдЯреАрдЬрд░, рд╕реНрдЯреНрд░рд┐рдВрдЧ рдпрд╛ рдПрд░реЗ рдХреЗ рд░реВрдк рдореЗрдВ, рдпрд╛ рдмрд┐рдЯрд╡реЗрдХреНрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдЖрдкрдХреЛ рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдиреА рд╣реИ рдФрд░ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдПрдХ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рдкреЙрдЗрдВрдЯрд░ рдХреЛ рдкрд╛рд╕ рдХрд░рдирд╛ рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдЗрд╕реЗ PointerWrapper рдореЗрдВ рд▓рдкреЗрдЯрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЕрд░реНрдерд╛рддреН `angr.PointerWrapper("point to me!")`ред рдЗрд╕ API рдХреЗ рдкрд░рд┐рдгрд╛рдо рдереЛрдбрд╝рд╛ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдо рдЗрд╕ рдкрд░ рдХрд╛рдо рдХрд░ рд░рд╣реЗ рд╣реИрдВред

## рдмрд┐рдЯрд╡реЗрдХреНрдЯрд░реНрд╕
```python
#BitVectors
state = proj.factory.entry_state()
bv = state.solver.BVV(0x1234, 32) #Create BV of 32bits with the value "0x1234"
state.solver.eval(bv) #Convert BV to python int
bv.zero_extend(30) #Will add 30 zeros on the left of the bitvector
bv.sign_extend(30) #Will add 30 zeros or ones on the left of the BV extending the sign
```
## рд╕рдВрдХреЗрддрд╛рддреНрдордХ рдмрд┐рдЯрд╡реЗрдХреНрдЯрд░ рдФрд░ рдмрд╛рдзрд╛рдПрдВ

рдПрдирдЬреАрдЖрд░ (angr) рдПрдХ рдкрд╛рдпрдерди рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╣реИ рдЬреЛ рдмрд╛рдЗрдирд░реА рдПрдирд╛рд▓рд╛рдЗрд╕рд┐рд╕ рдФрд░ рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рд╣реЛрддреА рд╣реИред рдпрд╣ рдПрдХ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдЯреВрд▓ рд╣реИ рдЬреЛ рд╕рдВрдХреЗрддрд╛рддреНрдордХ рдмрд┐рдЯрд╡реЗрдХреНрдЯрд░ рдФрд░ рдмрд╛рдзрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрд╛рдЗрдирд░реА рдХреЛрдб рдХреЛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред

рдПрдирдЬреАрдЖрд░ рдореЗрдВ, рд╕рдВрдХреЗрддрд╛рддреНрдордХ рдмрд┐рдЯрд╡реЗрдХреНрдЯрд░ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдбреЗрдЯрд╛ рдкреНрд░рддрд┐рд╖реНрдард╛рди рд╣реИ рдЬреЛ рдмрд╛рдЗрдирд░реА рдХреЛрдб рдХреЗ рд╡рд┐рднрд┐рдиреНрди рднрд╛рдЧреЛрдВ рдХреЛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдмрд┐рдЯрд╡реЗрдХреНрдЯрд░ рдмрд╛рдЗрдирд░реА рдХреЛрдб рдХреЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдмрд┐рдЯреЛрдВ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рд╡рд┐рднрд┐рдиреНрди рд░реВрдкреЛрдВ рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдмрд╛рдЗрдирд░реА рдлрд╝рд╛рдЗрд▓, рд░рдЬрд┐рд╕реНрдЯрд░, рдореЗрдореЛрд░реА рдФрд░ рдЗрдирдкреБрдЯ рдкреИрд░рд╛рдореАрдЯрд░ред

рдПрдирдЬреАрдЖрд░ рдореЗрдВ рдмрд╛рдзрд╛рдПрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рднреВрдорд┐рдХрд╛ рдирд┐рднрд╛рддреА рд╣реИрдВред рдпреЗ рд╢рд░реНрддреЗрдВ рд╣реЛрддреА рд╣реИрдВ рдЬреЛ рдмрд┐рдЯрд╡реЗрдХреНрдЯрд░ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдорд╛рдиреЛрдВ рдФрд░ рд╕рдВрдмрдВрдзреЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░рддрд┐рдмрджреНрдз рдХрд░рддреА рд╣реИрдВред рдЗрди рдмрд╛рдзрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдПрдирдЬреАрдЖрд░ рдмрд┐рдЯрд╡реЗрдХреНрдЯрд░ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рдорд╛рдиреЛрдВ рдХреА рд╕реАрдорд╛ рддрдп рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╕реВрдЪрдирд╛ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдПрдирдЬреАрдЖрд░ рдХреЗ рд╕рдВрдХреЗрддрд╛рддреНрдордХ рдмрд┐рдЯрд╡реЗрдХреНрдЯрд░ рдФрд░ рдмрд╛рдзрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдк рдмрд╛рдЗрдирд░реА рдХреЛрдб рдХреЗ рд╡рд┐рднрд┐рдиреНрди рднрд╛рдЧреЛрдВ рдХреЛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ рдореЙрдбрд┐рдлрд╝рд╛рдИ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдирдИ рдмрд╛рдзрд╛рдПрдВ рддреИрдпрд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдЖрдкрдХреЛ рдмрд╛рдЗрдирд░реА рдХреЛрдб рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдкрд╣рд▓реБрдУрдВ рдХреЛ рд╕рдордЭрдиреЗ рдФрд░ рдорд╛рдиреЛрдВ рдХреА рд╕реАрдорд╛ рддрдп рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЖрдк рдЙрд╕реЗ рдЕрдзрд┐рдХ рд╕реБрд░рдХреНрд╖рд┐рдд рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдирдИ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред
```python
x = state.solver.BVS("x", 64) #Symbolic variable BV of length 64
y = state.solver.BVS("y", 64)

#Symbolic oprations
tree = (x + 1) / (y + 2)
tree #<BV64 (x_9_64 + 0x1) / (y_10_64 + 0x2)>
tree.op #'__floordiv__' Access last operation
tree.args #(<BV64 x_9_64 + 0x1>, <BV64 y_10_64 + 0x2>)
tree.args[0].op #'__add__' Access of dirst arg
tree.args[0].args #(<BV64 x_9_64>, <BV64 0x1>)
tree.args[0].args[1].op #'BVV'
tree.args[0].args[1].args #(1, 64)

#Symbolic constraints solver
state = proj.factory.entry_state() #Get a fresh state without constraints
input = state.solver.BVS('input', 64)
operation = (((input + 4) * 3) >> 1) + input
output = 200
state.solver.add(operation == output)
state.solver.eval(input) #0x3333333333333381
state.solver.add(input < 2**32)
state.satisfiable() #False

#Solver solutions
solver.eval(expression) #one possible solution
solver.eval_one(expression) #solution to the given expression, or throw an error if more than one solution is possible.
solver.eval_upto(expression, n) #n solutions to the given expression, returning fewer than n if fewer than n are possible.
solver.eval_atleast(expression, n) #n solutions to the given expression, throwing an error if fewer than n are possible.
solver.eval_exact(expression, n) #n solutions to the given expression, throwing an error if fewer or more than are possible.
solver.min(expression) #minimum possible solution to the given expression.
solver.max(expression) #maximum possible solution to the given expression.
```
## рд╣реБрдХрд┐рдВрдЧ

Hooking рдПрдХ рддрдХрдиреАрдХ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╣рдо рдХрд┐рд╕реА рдПрдХреНрд╢рди рдХреЛ рдЕрдкрдиреЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рд▓реЗрдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдб рдХреЛ рдмрджрд▓рддреЗ рд╣реИрдВред рд╣реБрдХрд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдо рдХрд┐рд╕реА рднреА рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕реЗ рдЕрдкрдиреА рдЗрдЪреНрдЫрд╛рдиреБрд╕рд╛рд░ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЗрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╣реБрдХрд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдо рдПрдХреНрд╢рди рдХреЛ рдирд┐рдЧрд░рд╛рдиреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдбреЗрдЯрд╛ рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдЕрдиреНрдп рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрд░рд╡рд╛рдИрдпреЛрдВ рдХреЛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдпрд╣рд╛рдВ рд╣рдо рджреЛ рдкреНрд░рдореБрдЦ рд╣реБрдХрд┐рдВрдЧ рддрдХрдиреАрдХреЛрдВ рдХреЛ рджреЗрдЦреЗрдВрдЧреЗ:

### 1. Inline Hooking

рдЗрдирд▓рд╛рдЗрди рд╣реБрдХрд┐рдВрдЧ рдореЗрдВ, рд╣рдо рдХрд┐рд╕реА рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд╕рдХреЗ рдХреЛрдб рдХреЛ рд╕реАрдзреЗ рдмрджрд▓рддреЗ рд╣реИрдВред рд╣рдо рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдкреНрд░рдердо рдХреБрдЫ рдмрд╛рдЗрдЯ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░рдХреЗ рдЗрд╕реЗ рд╣реБрдХ рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕ рддрд░реАрдХреЗ рдореЗрдВ, рд╣рдо рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд╕рдХреЗ рдирд┐рдпрдВрддреНрд░рдг рдЭрдВрдбреЗ рдХреЛ рдмрджрд▓рддреЗ рд╣реИрдВ рдФрд░ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЕрдкрдиреЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рд▓реЗрддреЗ рд╣реИрдВред

### 2. API Hooking

API рд╣реБрдХрд┐рдВрдЧ рдореЗрдВ, рд╣рдо рдХрд┐рд╕реА рдПрдкреАрдЖрдИ рдХреЛ рд╣реБрдХ рдХрд░рдХреЗ рдЙрд╕рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдмрджрд▓рддреЗ рд╣реИрдВред рд╣рдо рдПрдкреАрдЖрдИ рдХреЛ рд╣реБрдХ рдХрд░рдХреЗ рдЙрд╕реЗ рдЕрдкрдиреЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рд▓реЗрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕рдХреЗ рд╡рд╛рдкрд╕реА рдорд╛рди рдХреЛ рдмрджрд▓рддреЗ рд╣реИрдВред рдЗрд╕ рддрд░реАрдХреЗ рдореЗрдВ, рд╣рдо рдПрдкреАрдЖрдИ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдмрджрд▓рдХрд░ рдЙрд╕реЗ рдЕрдкрдиреА рдЗрдЪреНрдЫрд╛рдиреБрд╕рд╛рд░ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЗрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред

рдпреЗ рджреЛрдиреЛрдВ рддрдХрдиреАрдХреЗрдВ рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдЬрдм рд╣рдо рдХрд┐рд╕реА рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдмрджрд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдирд┐рдЧрд░рд╛рдиреА рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред
```python
>>> stub_func = angr.SIM_PROCEDURES['stubs']['ReturnUnconstrained'] # this is a CLASS
>>> proj.hook(0x10000, stub_func())  # hook with an instance of the class

>>> proj.is_hooked(0x10000)            # these functions should be pretty self-explanitory
True
>>> proj.hooked_by(0x10000)
<ReturnUnconstrained>
>>> proj.unhook(0x10000)

>>> @proj.hook(0x20000, length=5)
... def my_hook(state):
...     state.regs.rax = 1

>>> proj.is_hooked(0x20000)
True
```
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЖрдк `proj.hook_symbol(name, hook)` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдкрд╣рд▓реЗ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рдкреНрд░рддреАрдХ рдХрд╛ рдирд╛рдо рдкреНрд░рджрд╛рди рдХрд░рдХреЗ, рдкреНрд░рддреАрдХ рдХреЗ рдЬреАрд╡рдиреЗ рд╡рд╛рд▓реЗ рдкрддреЗ рдХреЛ рд╣реБрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

# рдЙрджрд╛рд╣рд░рдг

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>
