<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **Twitter** ЁЯРж рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>

# рд╕рд╛рдорд╛рдиреНрдп

## рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ

| Raw Sockets   | WinAPI Sockets |
| ------------- | -------------- |
| socket()      | WSAStratup()   |
| bind()        | bind()         |
| listen()      | listen()       |
| accept()      | accept()       |
| connect()     | connect()      |
| read()/recv() | recv()         |
| write()       | send()         |
| shutdown()    | WSACleanup()   |

## рдкрд░реНрд╕рд┐рд╕реНрдЯреЗрдВрд╕

| Registry         | File          | Service                      |
| ---------------- | ------------- | ---------------------------- |
| RegCreateKeyEx() | GetTempPath() | OpenSCManager                |
| RegOpenKeyEx()   | CopyFile()    | CreateService()              |
| RegSetValueEx()  | CreateFile()  | StartServiceCtrlDispatcher() |
| RegDeleteKeyEx() | WriteFile()   |                              |
| RegGetValue()    | ReadFile()    |                              |

## рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди

| Name                  |
| --------------------- |
| WinCrypt              |
| CryptAcquireContext() |
| CryptGenKey()         |
| CryptDeriveKey()      |
| CryptDecrypt()        |
| CryptReleaseContext() |

## рдПрдВрдЯреА-рдПрдирд╛рд▓рд┐рд╕рд┐рд╕/VM

| Function Name                                             | Assembly Instructions |
| --------------------------------------------------------- | --------------------- |
| IsDebuggerPresent()                                       | CPUID()               |
| GetSystemInfo()                                           | IN()                  |
| GlobalMemoryStatusEx()                                    |                       |
| GetVersion()                                              |                       |
| CreateToolhelp32Snapshot \[Check if a process is running] |                       |
| CreateFileW/A \[Check if a file exist]                    |                       |

## рд╕реНрдЯреЗрд▓реНрде

| Name                     |                                                                            |
| ------------------------ | -------------------------------------------------------------------------- |
| VirtualAlloc             | Alloc memory (packers)                                                     |
| VirtualProtect           | Change memory permission (packer giving execution permission to a section) |
| ReadProcessMemory        | Injection into external processes                                          |
| WriteProcessMemoryA/W    | Injection into external processes                                          |
| NtWriteVirtualMemory     |                                                                            |
| CreateRemoteThread       | DLL/Process injection...                                                   |
| NtUnmapViewOfSection     |                                                                            |
| QueueUserAPC             |                                                                            |
| CreateProcessInternalA/W |                                                                            |

## рдПрдХреНрдЬреАрдХреНрдпреВрд╢рди

| Function Name    |
| ---------------- |
| CreateProcessA/W |
| ShellExecute     |
| WinExec          |
| ResumeThread     |
| NtResumeThread   |

## рд╡рд┐рд╡рд┐рдз

* GetAsyncKeyState() -- рдХреА рд▓реЙрдЧрд┐рдВрдЧ
* SetWindowsHookEx -- рдХреА рд▓реЙрдЧрд┐рдВрдЧ
* GetForeGroundWindow -- рдЪрд▓ рд░рд╣реА рд╡рд┐рдВрдбреЛ рдХрд╛ рдирд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ (рдпрд╛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕реЗ рд╡реЗрдмрд╕рд╛рдЗрдЯ)
* LoadLibrary() -- рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЗрдореНрдкреЛрд░реНрдЯ рдХрд░реЗрдВ
* GetProcAddress() -- рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЗрдореНрдкреЛрд░реНрдЯ рдХрд░реЗрдВ
* CreateToolhelp32Snapshot() -- рдЪрд▓ рд░рд╣реА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛рдПрдВ
* GetDC() -- рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ
* BitBlt() -- рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ
* InternetOpen(), InternetOpenUrl(), InternetReadFile(), InternetWriteFile() -- рдЗрдВрдЯрд░рдиреЗрдЯ рддрдХ рдкрд╣реБрдВрдЪ
* FindResource(), LoadResource(), LockResource() -- рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ рдХреЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ

# рдореИрд▓рд╡реЗрдпрд░ рддрдХрдиреАрдХреЗрдВ

## DLL рдЗрдВрдЬреЗрдХреНрд╢рди

рдХрд┐рд╕реА рдЕрдиреНрдп рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрджрд░ рдПрдХ рдордирдорд╛рдиреА DLL рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ

1. рдореИрд▓рд┐рд╢рд╕ DLL рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ: CreateToolhelp32Snapshot, Process32First, Process32Next
2. рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЦреЛрд▓реЗрдВ: GetModuleHandle, GetProcAddress, OpenProcess
3. рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрджрд░ DLL рдХреЗ рдкрде рдХреЛ рд▓рд┐рдЦреЗрдВ: VirtualAllocEx, WriteProcessMemory
4. рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдПрдХ рдереНрд░реЗрдб рдмрдирд╛рдПрдВ рдЬреЛ рдореИрд▓рд┐рд╢рд╕ DLL рдХреЛ рд▓реЛрдб рдХрд░реЗрдЧрд╛: CreateRemoteThread, LoadLibrary

рдЕрдиреНрдп рдлрдВрдХреНрд╢рдиреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ: NTCreateThreadEx, RtlCreateUserThread

## рд░рд┐рдлреНрд▓реЗрдХреНрдЯрд┐рд╡ DLL рдЗрдВрдЬреЗрдХреНрд╢рди

рд╕рд╛рдорд╛рдиреНрдп Windows API рдХреЙрд▓реНрд╕ рдХреЛ рдмреБрд▓рд╛рдП рдмрд┐рдирд╛ рдПрдХ рдореИрд▓рд┐рд╢рд╕ DLL рд▓реЛрдб рдХрд░реЗрдВред\
DLL рдХреЛ рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрджрд░ рдореИрдк рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдпрд╣ рдЗрдореНрдкреЛрд░реНрдЯ рдкрддреЗ рдХреЛ рд╣рд▓ рдХрд░реЗрдЧрд╛, рд░рд┐рд▓реЛрдХреЗрд╢рдиреНрд╕ рдХреЛ рдареАрдХ рдХрд░реЗрдЧрд╛ рдФрд░ DllMain рдлрдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░реЗрдЧрд╛ред

## рдереНрд░реЗрдб рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ

рдХрд┐рд╕реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ рдПрдХ рдереНрд░реЗрдб рдвреВрдВрдвреЗрдВ рдФрд░ рдЙрд╕реЗ рдореИрд▓рд┐рд╢рд╕ DLL рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдПрдВ

1. рдПрдХ рд▓рдХреНрд╖реНрдп рдереНрд░реЗрдб рдвреВрдВрдвреЗрдВ: CreateToolhelp32Snapshot, Thread32First, Thread32Next
2. рдереНрд░реЗрдб рдЦреЛрд▓реЗрдВ: OpenThread
3. рдереНрд░реЗрдб рдХреЛ рд╕рд╕реНрдкреЗрдВрдб рдХрд░реЗрдВ: SuspendThread
4. рдкреАрдбрд╝рд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрджрд░ рдореИрд▓рд┐рд╢рд╕ DLL рдХреЗ рдкрде рдХреЛ рд▓рд┐рдЦреЗрдВ: VirtualAllocEx, WriteProcessMemory
5. рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд▓реЛрдб рдХрд░рддреЗ рд╣реБрдП рдереНрд░реЗрдб рдХреЛ рдлрд┐рд░ рд╕реЗ рд╢реБрд░реВ рдХрд░реЗрдВ: ResumeThread

## PE рдЗрдВрдЬреЗрдХреНрд╢рди

рдкреЛрд░реНрдЯреЗрдмрд▓ рдПрдХреНрдЬреАрдХреНрдпреВрд╢рди рдЗрдВрдЬреЗрдХреНрд╢рди: рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ рдХреЛ рдкреАрдбрд╝рд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдореЗрдореЛрд░реА рдореЗрдВ рд▓рд┐рдЦрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рд╡рд╣рд╛рдВ рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

## рдкреНрд░реЛрд╕реЗрд╕ рд╣реЛрд▓реЛрдЗрдВрдЧ

рдореИрд▓рд╡реЗрдпрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдореЗрдореЛрд░реА рд╕реЗ рд╡реИрдз рдХреЛрдб рдХреЛ рдЕрдирдореИрдк рдХрд░реЗрдЧрд╛ рдФрд░ рдПрдХ рдореИрд▓рд┐рд╢рд╕ рдмрд╛рдЗрдирд░реА рд▓реЛрдб рдХрд░реЗрдЧрд╛

1. рдПрдХ рдирдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрдирд╛рдПрдВ: CreateProcess
2. рдореЗрдореЛрд░реА рдХреЛ рдЕрдирдореИрдк рдХрд░реЗрдВ: ZwUnmapViewOfSection, NtUnmapViewOfSection
3. рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдореЛрд░реА рдореЗрдВ рдореИрд▓рд┐рд╢рд╕ рдмрд╛рдЗрдирд░реА рд▓рд┐рдЦреЗрдВ: VirtualAllocEc, WriteProcessMemory
4. рдПрдВрдЯреНрд░реАрдкреЙрдЗрдВрдЯ рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ: SetThreadContext, ResumeThread

# рд╣реБрдХрд┐рдВрдЧ

* **SSDT** (**System Service Descriptor Table**) рдХрд░реНрдиреЗрд▓ рдлрдВрдХреНрд╢рдиреНрд╕ (ntoskrnl.exe) рдпрд╛ GUI рдбреНрд░рд╛рдЗрд╡рд░ (win32k.sys) рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдпреВрдЬрд░ рдкреНрд░реЛрд╕реЗрд╕ рдЗрди рдлрдВрдХреНрд╢рдиреНрд╕ рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХреЗрдВред
* рдПрдХ рд░реВрдЯрдХрд┐рдЯ рдЗрди рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЛ рдЙрди рдкрддреЛрдВ рдХреА рдУрд░ рдореЛрдбрд╝ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рд╡рд╣ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИред
* **IRP** (**I/O Request Packets**) рдПрдХ рдХреЙрдореНрдкреЛрдиреЗрдВрдЯ рд╕реЗ рджреВрд╕рд░реЗ рдХреЙрдореНрдкреЛрдиреЗрдВрдЯ рддрдХ рдбреЗрдЯрд╛ рдХреЗ рдЯреБрдХрдбрд╝реЗ рдкреНрд░реЗрд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВред рдХрд░реНрдиреЗрд▓ рдореЗрдВ рд▓рдЧрднрдЧ рд╕рдм рдХреБрдЫ IRPs рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдбрд┐рд╡рд╛рдЗрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреА рдЕрдкрдиреА рдлрдВрдХреНрд╢рди рдЯреЗрдмрд▓ рд╣реЛрддреА рд╣реИ рдЬрд┐рд╕реЗ рд╣реБрдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: DKOM (Direct Kernel Object Manipulation)
* **IAT** (**Import Address Table**) рдирд┐рд░реНрднрд░рддрд╛рдУрдВ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИред рдЗрд╕ рдЯреЗрдмрд▓ рдХреЛ рд╣реБрдХ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ рддрд╛рдХрд┐ рдХреЛрдб рдХреЛ рд╣рд╛рдЗрдЬреИрдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдЬреЛ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред
* **EAT** (**Export Address Table**) рд╣реБрдХреНрд╕ред рдпрд╣ рд╣реБрдХреНрд╕ **userland** рд╕реЗ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рд▓рдХреНрд╖реНрдп DLLs рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрдпрд╛рдд рдХрд┐рдП рдЧрдП рдлрдВрдХреНрд╢рдиреНрд╕ рдХреЛ рд╣реБрдХ рдХрд░рдирд╛ рд╣реИред
* **Inline Hooks**: рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣реБрдХреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдХрдард┐рди рд╣реИред рдЗрд╕рдореЗрдВ рдлрдВрдХреНрд╢рдиреНрд╕ рдХреЗ рдХреЛрдб рдХреЛ рд╕реНрд╡рдпрдВ рдореЗрдВ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред рд╢рд╛рдпрдж рдЗрд╕рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдПрдХ рдЬрдВрдк рдбрд╛рд▓рдХрд░ред
