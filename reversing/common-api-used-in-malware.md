<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju oglašenu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Pogledajte [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

Pronađite najvažnije ranjivosti kako biste ih brže popravili. Intruder prati vašu površinu napada, pokreće proaktivno skeniranje pretnji, pronalazi probleme u celokupnom tehnološkom sklopu, od API-ja do veb aplikacija i cloud sistema. [**Isprobajte ga besplatno**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) danas.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***


# Opšte

## Mrežno povezivanje

| Sirovi Sockets | WinAPI Sockets |
| -------------- | -------------- |
| socket()       | WSAStratup()   |
| bind()         | bind()         |
| listen()       | listen()       |
| accept()       | accept()       |
| connect()      | connect()      |
| read()/recv()  | recv()         |
| write()        | send()         |
| shutdown()     | WSACleanup()   |

## Upornost

| Registar          | Fajl          | Servis                       |
| ----------------- | ------------- | ---------------------------- |
| RegCreateKeyEx()  | GetTempPath() | OpenSCManager                |
| RegOpenKeyEx()    | CopyFile()    | CreateService()              |
| RegSetValueEx()   | CreateFile()  | StartServiceCtrlDispatcher() |
| RegDeleteKeyEx()  | WriteFile()   |                              |
| RegGetValue()     | ReadFile()    |                              |

## Enkripcija

| Ime                   |
| --------------------- |
| WinCrypt              |
| CryptAcquireContext() |
| CryptGenKey()         |
| CryptDeriveKey()      |
| CryptDecrypt()        |
| CryptReleaseContext() |

## Anti-Analiza/VM

| Ime Funkcije                                              | Skup Instrukcija |
| --------------------------------------------------------- | ---------------- |
| IsDebuggerPresent()                                       | CPUID()          |
| GetSystemInfo()                                           | IN()             |
| GlobalMemoryStatusEx()                                    |                  |
| GetVersion()                                              |                  |
| CreateToolhelp32Snapshot \[Provera da li je proces pokrenut] |                  |
| CreateFileW/A \[Provera da li fajl postoji]                |                  |

## Skrivanje

| Ime                      |                                                                            |
| ------------------------ | -------------------------------------------------------------------------- |
| VirtualAlloc             | Alokacija memorije (pakovanje)                                             |
| VirtualProtect           | Promena dozvola memorije (pakovanje davanjem dozvole za izvršavanje sekciji) |
| ReadProcessMemory        | Ubacivanje u spoljne procese                                              |
| WriteProcessMemoryA/W    | Ubacivanje u spoljne procese                                              |
| NtWriteVirtualMemory     |                                                                            |
| CreateRemoteThread       | Ubacivanje DLL-a/Procesa...                                                |
| NtUnmapViewOfSection     |                                                                            |
| QueueUserAPC             |                                                                            |
| CreateProcessInternalA/W |                                                                            |

## Izvršavanje

| Ime Funkcije    |
| --------------- |
| CreateProcessA/W |
| ShellExecute     |
| WinExec          |
| ResumeThread     |
| NtResumeThread   |

## Razno

* GetAsyncKeyState() -- Snimanje tastature
* SetWindowsHookEx -- Snimanje tastature
* GetForeGroundWindow -- Dobijanje naziva pokrenutog prozora (ili veb sajta iz pretraživača)
* LoadLibrary() -- Uvoz biblioteke
* GetProcAddress() -- Uvoz biblioteke
* CreateToolhelp32Snapshot() -- Lista pokrenutih procesa
* GetDC() -- Snimak ekrana
* BitBlt() -- Snimak ekrana
* InternetOpen(), InternetOpenUrl(), InternetReadFile(), InternetWriteFile() -- Pristup internetu
* FindResource(), LoadResource(), LockResource() -- Pristup resursima izvršnog fajla

# Tehnike Malvera

## DLL Ubacivanje

Izvršavanje proizvoljne DLL datoteke unutar drugog procesa

1. Pronađite proces u koji ćete ubaciti zlonamernu DLL: CreateToolhelp32Snapshot, Process32First, Process32Next
2. Otvorite proces: GetModuleHandle, GetProcAddress, OpenProcess
3. Upisujte putanju do DLL datoteke unutar procesa: VirtualAllocEx, WriteProcessMemory
4. Kreirajte nit u procesu koja će učitati zlonamernu DLL: CreateRemoteThread, LoadLibrary

Ostale funkcije za korišćenje: NTCreateThreadEx, RtlCreateUserThread

## Reflektivno DLL Ubacivanje

Učitavanje zlonamerne DLL datoteke bez pozivanja normalnih Windows API poziva.\
DLL je mapiran unutar procesa, rešava adrese uvoza, popravlja relokacije i poziva funkciju DllMain.

## Preuzimanje Niti

Pronalaženje niti iz procesa i njenje učitavanje zlonamerne DLL datoteke

1. Pronađite ciljnu nit: CreateToolhelp32Snapshot, Thread32First, Thread32Next
2. Otvorite nit: OpenThread
3. Suspendujte nit: SuspendThread
4. Upisujte putanju do zlonamerne DLL datoteke unutar procesa žrtve: VirtualAllocEx, WriteProcessMemory
5. Nastavite nit koja učitava biblioteku: ResumeThread

## PE Ubacivanje

Ubacivanje izvršne datoteke u memoriju procesa žrtve i izvršavanje iz te lokacije.

## Isprazni Proces

Malver će izbrisati legitimni kod iz memorije procesa i učitati zlonamerni binarni fajl

1. Kreirajte novi proces: CreateProcess
2. Ispraznite memoriju: ZwUnmapViewOfSection, NtUnmapViewOfSection
3. Upisujte zlonamerni binarni fajl u memoriju procesa: VirtualAllocEc, WriteProcessMemory
4. Postavite tačku ulaska i izvršite: SetThreadContext, ResumeThread

# Hookovanje

* **SSDT** (**System Service Descriptor Table**) pokazuje na kernel funkcije (ntoskrnl.exe) ili GUI draj
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
