<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╡рдВрд╢рд╛рдиреБрдХреНрд░рдореЛрдВ рдХреЛ рдЦреЛрдЬреЗрдВ рддрд╛рдХрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ рддреЗрдЬреА рд╕реЗ рдареАрдХ рдХрд░ рд╕рдХреЗрдВред Intruder рдЖрдкрдХреА рд╣рдорд▓реЗ рдХреА рд╕рддрд╣ рдХрд╛ рдЯреНрд░реИрдХ рдХрд░рддрд╛ рд╣реИ, рдкреНрд░реЛрдПрдХреНрдЯрд┐рд╡ рдзрд╛рд░рдгрд╛ рд╕реНрдХреИрди рдЪрд▓рд╛рддрд╛ рд╣реИ, APIs рд╕реЗ рд╡реЗрдм рдРрдкреНрд╕ рдФрд░ рдХреНрд▓рд╛рдЙрдб рд╕рд┐рд╕реНрдЯрдо рддрдХ рдХреЗ рдЗрд╢реНрдпреВрдЬрд╝ рдЦреЛрдЬрддрд╛ рд╣реИред [**рдЖрдЬ рд╣реА рдореБрдлреНрдд рдореЗрдВ рдЗрд╕рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks)ред

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

# рд╕рд╛рдорд╛рдиреНрдп

## рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ

| рд░реЙ рд╕реЙрдХреЗрдЯреНрд╕   | рд╡рд┐рдиAPI рд╕реЙрдХреЗрдЯреНрд╕ |
| ------------- | -------------- |
| socket()      | WSAStratup()   |
| bind()        | bind()         |
| listen()      | listen()       |
| accept()      | accept()       |
| connect()     | connect()      |
| read()/recv() | recv()         |
| write()       | send()         |
| shutdown()    | WSACleanup()   |

## рд╕реНрдерд┐рд░рддрд╛

| рд░рдЬрд┐рд╕реНрдЯреНрд░реА         | рдлрд╝рд╛рдЗрд▓          | рд╕реЗрд╡рд╛                      |
| ---------------- | ------------- | ---------------------------- |
| RegCreateKeyEx() | GetTempPath() | OpenSCManager                |
| RegOpenKeyEx()   | CopyFile()    | CreateService()              |
| RegSetValueEx()  | CreateFile()  | StartServiceCtrlDispatcher() |
| RegDeleteKeyEx() | WriteFile()   |                              |
| RegGetValue()    | ReadFile()    |                              |

## рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди

| рдирд╛рдо                  |
| --------------------- |
| WinCrypt              |
| CryptAcquireContext() |
| CryptGenKey()         |
| CryptDeriveKey()      |
| CryptDecrypt()        |
| CryptReleaseContext() |

## рдПрдВрдЯреА-рд╡рд┐рд╢реНрд▓реЗрд╖рдг/рд╡реАрдПрдо

| рдлрд╝рдВрдХреНрд╢рди рдирд╛рдо                                             | рдЕрд╕реЗрдореНрдмрд▓реА рдЗрдВрд╕реНрдЯреНрд░рдХреНрд╢рдиреНрд╕ |
| --------------------------------------------------------- | --------------------- |
| IsDebuggerPresent()                                       | CPUID()               |
| GetSystemInfo()                                           | IN()                  |
| GlobalMemoryStatusEx()                                    |                       |
| GetVersion()                                              |                       |
| CreateToolhelp32Snapshot \[рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреЛрдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЪрд▓ рд░рд╣реА рд╣реИ] |                       |
| CreateFileW/A \[рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреЛрдИ рдлрд╝рд╛рдЗрд▓ рдореМрдЬреВрдж рд╣реИ]                    |                       |

## рдЫрд┐рдкрд╛рд╡

| рдирд╛рдо                     |                                                                            |
| ------------------------ | -------------------------------------------------------------------------- |
| VirtualAlloc             | рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрд┐рдд рдХрд░реЗрдВ (рдкреИрдХрд░реНрд╕)                                                     |
| VirtualProtect           | рдореЗрдореЛрд░реА рдЕрдиреБрдорддрд┐ рдмрджрд▓реЗрдВ (рдкреИрдХрд░ рдПрдХ рдЦрдВрдб рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдЕрдиреБрдорддрд┐ рджреЗрдирд╛) |
| ReadProcessMemory        | рдмрд╛рд╣рд░реА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ рдЗрдВрдЬреЗрдХреНрд╢рди                                          |
| WriteProcessMemoryA/W    | рдмрд╛рд╣рд░реА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ рдЗрдВрдЬреЗрдХреНрд╢рди                                          |
| NtWriteVirtualMemory     |                                                                            |
| CreateRemoteThread       | DLL/рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЗрдВрдЬреЗрдХреНрд╢рди...                                                   |
| NtUnmapViewOfSection     |                                                                            |
| QueueUserAPC             |                                                                            |
| CreateProcessInternalA/W |                                                                            |

## рдирд┐рд╖реНрдкрд╛рджрди

| рдлрд╝рдВрдХреНрд╢рди рдирд╛рдо    |
| ---------------- |
| CreateProcessA/W |
| ShellExecute     |
| WinExec          |
| ResumeThread     |
| NtResumeThread   |

## рд╡рд┐рд╡рд┐рдз

* GetAsyncKeyState() -- рдХреБрдВрдЬреА рд▓реЙрдЧрд┐рдВрдЧ
* SetWindowsHookEx -- рдХреБрдВрдЬреА рд▓реЙрдЧрд┐рдВрдЧ
* GetForeGroundWindow -- рдЪрд▓ рд░рд╣реА рд╡рд┐рдВрдбреЛ рдХрд╛ рдирд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ (рдпрд╛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕реЗ рд╡реЗрдмрд╕рд╛рдЗрдЯ)
* LoadLibrary() -- рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЖрдпрд╛рдд
* GetProcAddress() -- рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЖрдпрд╛рдд
* CreateToolhelp32Snapshot() -- рдЪрд▓ рд░рд╣реА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рд╕реВрдЪреАрдмрджреНрдз рдХрд░реЗрдВ
* GetDC() -- рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ
* BitBlt() -- рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ
* InternetOpen(), InternetOpenUrl(), InternetReadFile(), InternetWriteFile() -- рдЗрдВрдЯрд░рдиреЗрдЯ рддрдХ рдкрд╣реБрдВрдЪреЗрдВ
* FindResource(), LoadResource(), LockResource() -- рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рддрдХ рдкрд╣реБрдВрдЪреЗрдВ

# рдореИрд▓рд╡реЗрдпрд░ рддрдХрдиреАрдХ

## DLL рдЗрдВрдЬреЗрдХреНрд╢рди

рдПрдХ рдЕрд░реНрдмрд┐рдЯреНрд░реЗрд░реА DLL рдХреЛ рджреВрд╕рд░реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ

1. рджреБрд░реБрдкрдпреЛрдЧреА DLL рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ: CreateToolhelp32Snapshot, Process32First, Process32Next
2. рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЦреЛрд▓реЗрдВ: GetModuleHandle, GetProcAddress, OpenProcess
3. DLL рдХреЗ рдкрде рдХреЛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрджрд░ рд▓рд┐рдЦреЗрдВ: VirtualAllocEx, WriteProcessMemory
4. рдЙрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдПрдХ рдереНрд░реЗрдб рдмрдирд╛рдПрдВ рдЬреЛ рджреБрд░реБрдкрдпреЛрдЧреА DLL рд▓реЛрдб рдХрд░реЗрдЧрд╛: CreateRemoteThread, LoadLibrary

рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рдлрд╝рдВрдХреНрд╢рди: NTCreateThreadEx, RtlCreateUserThread

## рдкреНрд░рддрд┐рдмрд┐рдореНрдмреА DLL рдЗрдВрдЬреЗрдХреНрд╢рди

рд╕рд╛рдорд╛рдиреНрдп Windows API рдХреЙрд▓ рдХрд┐рдП рдмрд┐рдирд╛ рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА DLL рд▓реЛрдб рдХрд░реЗрдВред\
DLL рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрджрд░ рдореИрдк рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рдЖрдпрд╛рдд рдкрддреЗ рд╣рд▓ рдХрд░реЗрдЧрд╛, рд╕реНрдерд╛рдирд╛рдВрддрд░рдгреЛрдВ рдХреЛ рдареАрдХ рдХрд░реЗрдЧрд╛ рдФрд░ DllMain рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░реЗрдЧрд╛ред

## рдереНрд░реЗрдб рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ

рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ рдПрдХ рдереНрд░реЗрдб рдЦреЛрдЬреЗрдВ рдФрд░ рдЙрд╕реЗ рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА DLL рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдПрдВ

1. рд▓рдХреНрд╖реНрдп рдереНрд░реЗрдб рдЦреЛрдЬреЗрдВ: CreateToolhelp32Snapshot, Thread32First, Thread32Next
2. рдереНрд░реЗрдб рдЦреЛрд▓реЗрдВ: OpenThread
3. рдереНрд░реЗрдб рдХреЛ рд░реЛрдХреЗрдВ: SuspendThread
4. рдкреАрдбрд╝рд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рджреБрд░реБрдкрдпреЛрдЧреА DLL рдХрд╛ рдкрде рд▓рд┐рдЦреЗрдВ: VirtualAllocEx, WriteProcessMemory
5. рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд▓реЛрдб рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдереНрд░реЗрдб рдХреЛ рдлрд┐рд░ рд╕реЗ рдЪрд╛рд▓реВ рдХрд░реЗрдВ: ResumeThread

## рдкреАрдИ рдЗрдВрдЬреЗрдХреНрд╢рди

рдкреЛрд░реНрдЯреЗрдмрд▓ рдПрдХреНрдЬреАрдХреНрдпреВрд╢рди рдЗрдВрдЬреЗрдХреНрд╢рди: рдПрдХреНрдЬреАрдХреНрдпреВрд╢рди рд╡рд┐рдХреНрдЯрд┐рдо рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдореЗрдореЛрд░реА рдореЗрдВ рд▓рд┐рдЦрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рд╡рд╣рд╛рдВ рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

## рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣реЛрд▓реЛрдЗрдВрдЧ

рдореИрд▓рд╡реЗрдпрд░ рдЙрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдореЗрдореЛрд░реА рд╕реЗ рд╡реИрдз рдХреЛрдб рдХреЛ рдЕрдирдореИрдк рдХрд░реЗрдЧрд╛ рдФрд░ рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА рдмрд╛рдЗрдирд░реА рд▓реЛрдб рдХрд░реЗрдЧрд╛

1. рдПрдХ рдирдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрдирд╛рдПрдВ: CreateProcess
2. рдореЗрдореЛрд░реА рдХреЛ рдЕрдирдореИрдк рдХрд░реЗрдВ: ZwUnmapViewOfSection, NtUnmapViewOfSection
3. рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдореЛрд░реА рдореЗрдВ рджреБрд░реБрдкрдпреЛрдЧреА рдмрд╛рдЗрдирд░реА рд▓рд┐рдЦреЗрдВ: VirtualAllocEc, WriteProcessMemory
4. рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ: SetThreadContext, ResumeThread

# рд╣реБрдХрд┐рдВрдЧ

* **SSDT** (**рд╕рд┐рд╕реНрдЯрдо рд╕реЗрд╡рд╛ рд╡рд┐рд╡рд░рдг рддрд╛рд▓рд┐рдХрд╛**) рдХрд░реНрдиреЗрд▓ рдлрд╝рдВрдХреНрд╢рдиреЛрдВ (ntoskrnl.exe) рдпрд╛ GUI рдбреНрд░рд╛рдЗрд╡рд░ (win32k.sys) рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рдЗрди рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХреЗрдВред
* рдПрдХ рд░реВрдЯрдХрд┐рдЯ рдЗрди рдкреЙрдЗрдВрдЯрд░ рдХреЛ рдЙрд╕рдХреЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЗрди рдкреЙрдЗрдВрдЯрд░ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ
* **IRP** (**рдЖрдИ/рдУ рдЕрдиреБрд░реЛрдз рдкреИрдХреЗрдЯреНрд╕**) рдПрдХ рдХрдВрдкреЛрдиреЗрдВрдЯ рд╕реЗ рджреВрд╕рд░реЗ рдХрдВрдкреЛрдиреЗрдВрдЯ рддрдХ рдбреЗрдЯрд╛ рдЯреБрдХрдбрд╝реЗ рднреЗрдЬрддреЗ рд╣реИрдВред рдХрд░реНрдиреЗрд▓ рдореЗрдВ рд▓рдЧрднрдЧ рд╕рднреА рдЪреАрдЬреЗрдВ IRPs рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИрдВ рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдбрд┐рд╡рд╛рдЗрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рдкрд╛рд╕ рдЕрдкрдирд╛ рдЦреБрдж рдХрд╛ рдлрд╝рдВрдХреНрд╢рди рддрд╛рд▓рд┐рдХрд╛ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рд╣реБрдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: DKOM (рд╕реАрдзреЗ рдХрд░реНрдиреЗрд▓ рдСрдмреНрдЬ
