<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдХреЛ PRs рдЬрдорд╛ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>


# CBC

рдпрджрд┐ **рдХреБрдХреА** **рдХреЗрд╡рд▓** **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо** рд╣реИ (рдпрд╛ рдХреБрдХреА рдХрд╛ рдкрд╣рд▓рд╛ рд╣рд┐рд╕реНрд╕рд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рд╣реИ) рдФрд░ рдЖрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ "**рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ**" рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред рддреЛ, рдЖрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо **"рдмреАрдбрдорд┐рди"** рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдХреБрдХреА рдХреЗ **рдкрд╣рд▓реЗ рдмрд╛рдЗрдЯ** рдХрд╛ **рдмреНрд░реВрдЯрдлреЛрд░реНрд╕** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

# CBC-MAC

рд░рд╣рд╕реНрдпрдордпрддрд╛ рдореЗрдВ, рдПрдХ **рд╕рд╛рдЗрдлрд░ рдмреНрд▓реЙрдХ рдЪреЗрдирд┐рдВрдЧ рд╕рдВрджреЗрд╢ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛрдб** (**CBC-MAC**) рдПрдХ рддрдХрдиреАрдХ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рдмреНрд▓реЙрдХ рд╕рд╛рдЗрдлрд░ рд╕реЗ рд╕рдВрджреЗрд╢ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛрдб рдирд┐рд░реНрдорд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╕рдВрджреЗрд╢ рдХреЛ рдХреБрдЫ рдмреНрд▓реЙрдХ рд╕рд╛рдЗрдлрд░ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЗ рд╕рд╛рде рд╕реАрдмреАрд╕реА рдореЛрдб рдореЗрдВ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдмреНрд▓реЙрдХ рдкрд┐рдЫрд▓реЗ рдмреНрд▓реЙрдХ рдХреЗ рд╕рд╣реА рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдкрд░ рдирд┐рд░реНрднрд░ рд╣реЛред рдпрд╣ рдЖрдкрд╕реА рдЖрд╢реНрд░рд┐рддрддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХрд┐рд╕реА рднреА рдкреНрд▓реЗрдирдЯреЗрдХреНрд╕реНрдЯ **рдмрд┐рдЯреНрд╕** рдореЗрдВ рдХреЛрдИ **рдкрд░рд┐рд╡рд░реНрддрди** рд╣реЛрдиреЗ рдкрд░ **рдЕрдВрддрд┐рдо рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдмреНрд▓реЙрдХ** рдХреЛ рдПрдХ рдРрд╕реЗ рддрд░реАрдХреЗ рд╕реЗ **рдкрд░рд┐рд╡рд░реНрддрд┐рдд** рдХрд░реЗрдЧрд╛ рдЬрд┐рд╕реЗ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдпрд╛ рдмреНрд▓реЙрдХ рд╕рд╛рдЗрдлрд░ рдХреБрдВрдЬреА рдХреЛ рдирд╣реАрдВ рдЬрд╛рдирдХрд░ рдирд╣реАрдВ рд░реЛрдХрд╛ рдЬрд╛ рд╕рдХрддрд╛ред

рд╕рдВрджреЗрд╢ m рдХрд╛ CBC-MAC рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдХрд┐рд╕реА рднреА рд╢реВрдиреНрдп рдкреНрд░рд╛рд░рдВрднреАрдХ рд╡реЗрдХреНрдЯрд░ рдХреЗ рд╕рд╛рде m рдХреЛ рд╕реАрдмреАрд╕реА рдореЛрдб рдореЗрдВ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЕрдВрддрд┐рдо рдмреНрд▓реЙрдХ рдХреЛ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред рдирд┐рдореНрди рдЪрд┐рддреНрд░ рдореЗрдВ рдПрдХ рд╕рдВрджреЗрд╢ рдХрд╛ CBC-MAC рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреА рд░реВрдкрд░реЗрдЦрд╛ рджреА рдЧрдИ рд╣реИ![m\_{1}\\|m\_{2}\\|\cdots \\|m\_{x}](https://wikimedia.org/api/rest\_v1/media/math/render/svg/bbafe7330a5e40a04f01cc776c9d94fe914b17f5) рдПрдХ рдЧреБрдкреНрдд рдХреБрдВрдЬреА k рдФрд░ рдПрдХ рдмреНрд▓реЙрдХ рд╕рд╛рдЗрдлрд░ E рдХреЗ рд╕рд╛рде:

![CBC-MAC structure (en).svg](https://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/CBC-MAC\_structure\_\(en\).svg/570px-CBC-MAC\_structure\_\(en\).svg.png)

# рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖

CBC-MAC рдХреЗ рд╕рд╛рде рдЖрдо рддреМрд░ рдкрд░ **рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ IV 0 рд╣реЛрддрд╛ рд╣реИ**ред\
рдпрд╣ рдПрдХ рд╕рдорд╕реНрдпрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ 2 рдЬреНрдЮрд╛рдд рд╕рдВрджреЗрд╢ (`m1` рдФрд░ `m2`) рд╕реНрд╡рддрдВрддреНрд░ рд░реВрдк рд╕реЗ 2 рд╣рд╕реНрддрд╛рдХреНрд╖рд░ (`s1` рдФрд░ `s2`) рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВрдЧреЗред рдЗрд╕рд▓рд┐рдП:

* `E(m1 XOR 0) = s1`
* `E(m2 XOR 0) = s2`

рдлрд┐рд░ m1 рдФрд░ m2 рдХреЛ рдЬреЛрдбрд╝рдХрд░ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╕рдВрджреЗрд╢ (m3) 2 рд╣рд╕реНрддрд╛рдХреНрд╖рд░ (s31 рдФрд░ s32) рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧрд╛:

* `E(m1 XOR 0) = s31 = s1`
* `E(m2 XOR s1) = s32`

**рдЬрд┐рд╕реЗ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХреА рдХреБрдВрдЬреА рдХреЛ рдирд╣реАрдВ рдЬрд╛рдирддреЗ рд╣реБрдП рдЧрдгрдирд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред**

рд╕реЛрдЪрд┐рдП рдЖрдк **8 рдмрд╛рдЗрдЯ** рдмреНрд▓реЙрдХ рдореЗрдВ рдирд╛рдо **рдкреНрд░рд╢рд╛рд╕рдХ** рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд░рд╣реЗ рд╣реИрдВ:

* `Administ`
* `rator\00\00\00`

рдЖрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо **Administ** (m1) рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ (s1) рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдлрд┐рд░, рдЖрдк `rator\00\00\00 XOR s1` рдХреЗ рдкрд░рд┐рдгрд╛рдо рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ `E(m2 XOR s1 XOR 0)` рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧрд╛ рдЬреЛ s32 рд╣реИред\
рдЕрдм, рдЖрдк s32 рдХрд╛ рдЙрдкрдпреЛрдЧ **рдкреНрд░рд╢рд╛рд╕рдХ** рдХреЗ рдкреВрд░реЗ рдирд╛рдо рдХреЗ рд▓рд┐рдП рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рд╕рд╛рд░рд╛рдВрд╢

1. рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо **Administ** (m1) рдХрд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдЬреЛ s1 рд╣реИ
2. рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо **rator\x00\x00\x00 XOR s1 XOR 0** рдХрд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдЬреЛ s32 рд╣реИ**.**
3. рдХреБрдХреА рдХреЛ s32 рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ рдпрд╣ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдкреНрд░рд╢рд╛рд╕рдХ** рдХреЗ рд▓рд┐рдП рдПрдХ рдорд╛рдиреНрдп рдХреБрдХреА рд╣реЛрдЧреАред

# рд╣рдорд▓рд╛ рдирд┐рдпрдВрддреНрд░рдг IV

рдпрджрд┐ рдЖрдк рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП IV рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рд╣рдорд▓рд╛ рдмрд╣реБрдд рдЖрд╕рд╛рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред\
рдпрджрд┐ рдХреБрдХреА рдХреЗрд╡рд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ "**рдкреНрд░рд╢рд╛рд╕рдХ**" рдХрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЖрдк рдЗрд╕рдХреА рдХреБрдХреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВрдЧреЗред\
рдЕрдм, рдпрджрд┐ рдЖрдк IV рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк IV рдХрд╛ рдкрд╣рд▓рд╛ рдмрд╛рдЗрдЯ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ **IV\[0] XOR "A" == IV'\[0] XOR "a"** рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдкреНрд░рд╢рд╛рд╕рдХ** рдХреЗ рд▓рд┐рдП рдХреБрдХреА рдкреБрдирдГ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдХреБрдХреА **рдкреНрд░рд╢рд╛рд╕рдХ** рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдиреНрдп рд╣реЛрдЧреАред

# рд╕рдВрджрд░реНрдн

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [https://en.wikipedia.org/wiki/CBC-MAC](https://en.wikipedia.org/wiki/CBC-MAC)


<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдХреЛ PRs рдЬрдорд╛ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
