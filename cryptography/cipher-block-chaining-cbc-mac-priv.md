<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert de l'√©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** r√©f√©rentiels [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>


# CBC

Si le **cookie** est **seulement** le **nom d'utilisateur** (ou la premi√®re partie du cookie est le nom d'utilisateur) et que vous souhaitez vous faire passer pour l'utilisateur "**admin**". Ensuite, vous pouvez cr√©er le nom d'utilisateur **"bdmin"** et **bruteforcer** le **premier octet** du cookie.

# CBC-MAC

En cryptographie, un **code d'authentification de message par chiffrement en mode de cha√Ænage de blocs** (**CBC-MAC**) est une technique pour construire un code d'authentification de message √† partir d'un chiffrement par blocs. Le message est chiffr√© avec un algorithme de chiffrement par blocs en mode CBC pour cr√©er une **cha√Æne de blocs de telle sorte que chaque bloc d√©pende du chiffrement correct du bloc pr√©c√©dent**. Cette interd√©pendance garantit qu'un **changement** de **n'importe quel** bit du texte en clair provoquera un **changement** du **dernier bloc chiffr√©** d'une mani√®re qui ne peut √™tre pr√©dite ou contr√©e sans conna√Ætre la cl√© du chiffrement par blocs.

Pour calculer le CBC-MAC du message m, on chiffre m en mode CBC avec un vecteur d'initialisation nul et on garde le dernier bloc. La figure suivante esquisse le calcul du CBC-MAC d'un message comprenant des blocs ![m\_{1}\\|m\_{2}\\|\cdots \\|m\_{x}](https://wikimedia.org/api/rest\_v1/media/math/render/svg/bbafe7330a5e40a04f01cc776c9d94fe914b17f5) en utilisant une cl√© secr√®te k et un chiffrement par blocs E :

![CBC-MAC structure (en).svg](https://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/CBC-MAC\_structure\_\(en\).svg/570px-CBC-MAC\_structure\_\(en\).svg.png)

# Vuln√©rabilit√©

Avec le CBC-MAC, l'**IV utilis√© est g√©n√©ralement 0**.\
C'est un probl√®me car 2 messages connus (`m1` et `m2`) g√©n√©reront ind√©pendamment 2 signatures (`s1` et `s2`). Ainsi :

* `E(m1 XOR 0) = s1`
* `E(m2 XOR 0) = s2`

Ensuite, un message compos√© de m1 et m2 concat√©n√©s (m3) g√©n√©rera 2 signatures (s31 et s32) :

* `E(m1 XOR 0) = s31 = s1`
* `E(m2 XOR s1) = s32`

**Ce qui est possible √† calculer sans conna√Ætre la cl√© du chiffrement.**

Imaginez que vous chiffrez le nom **Administrateur** en blocs de **8 octets** :

* `Administ`
* `rator\00\00\00`

Vous pouvez cr√©er un nom d'utilisateur appel√© **Administ** (m1) et r√©cup√©rer la signature (s1).\
Ensuite, vous pouvez cr√©er un nom d'utilisateur appel√© le r√©sultat de `rator\00\00\00 XOR s1`. Cela g√©n√©rera `E(m2 XOR s1 XOR 0)` qui est s32.\
maintenant, vous pouvez utiliser s32 comme signature du nom complet **Administrateur**.

### R√©sum√©

1. Obtenez la signature du nom d'utilisateur **Administ** (m1) qui est s1
2. Obtenez la signature du nom d'utilisateur **rator\x00\x00\x00 XOR s1 XOR 0** qui est s32**.**
3. D√©finissez le cookie sur s32 et il sera un cookie valide pour l'utilisateur **Administrateur**.

# Contr√¥le de l'attaque IV

Si vous pouvez contr√¥ler l'IV utilis√©, l'attaque pourrait √™tre tr√®s facile.\
Si les cookies ne sont que le nom d'utilisateur chiffr√©, pour vous faire passer pour l'utilisateur "**administrateur**", vous pouvez cr√©er l'utilisateur "**Administrateur**" et obtenir son cookie.\
Maintenant, si vous pouvez contr√¥ler l'IV, vous pouvez changer le premier octet de l'IV de sorte que **IV\[0] XOR "A" == IV'\[0] XOR "a"** et r√©g√©n√©rer le cookie pour l'utilisateur **Administrateur**. Ce cookie sera valide pour **usurper** l'utilisateur **administrateur** avec l'IV initial.

# R√©f√©rences

Plus d'informations sur [https://en.wikipedia.org/wiki/CBC-MAC](https://en.wikipedia.org/wiki/CBC-MAC)


<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert de l'√©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** r√©f√©rentiels [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
